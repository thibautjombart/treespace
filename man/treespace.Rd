% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/treespace.R
\encoding{UTF-8}
\name{treespace}
\alias{treespace}
\title{Phylogenetic tree exploration}
\usage{
treespace(
  x,
  method = "treeVec",
  nf = NULL,
  lambda = 0,
  return.tree.vectors = FALSE,
  processors = 1,
  ...
)
}
\arguments{
\item{x}{an object of the class multiPhylo}

\item{method}{the method for summarising the tree as a vector.
Choose from:
\itemize{
\item \code{treeVec} (default) the Kendall Colijn metric vector (for rooted trees)
\item \code{BHV} the Billera, Holmes Vogtmann metric using \code{dist.multiPhylo} from package \code{distory} (for rooted trees)
\item \code{KF} the Kuhner Felsenstein metric (branch score distance) using \code{KF.dist} from package \code{phangorn} (considers the trees unrooted)
\item \code{RF} the Robinson Foulds metric using \code{RF.dist} from package \code{phangorn} (considers the trees unrooted)
\item \code{wRF} the weighted Robinson Foulds metric using \code{wRF.dist} from package \code{phangorn} (considers the trees unrooted)
\item \code{nNodes} the Steel & Penny tip-tip path difference metric, (topological, ignoring branch lengths), using \code{path.dist} from package \code{phangorn} (considers the trees unrooted)
\item \code{patristic} the Steel & Penny tip-tip path difference metric, using branch lengths, calling \code{path.dist} from package \code{phangorn} (considers the trees unrooted)
\item \code{CID} the clustering information difference metric, calling \code{ClusteringInformationDistance()} from package \pkg{TreeDist} (considers the trees unrooted)
\item \code{PID} the phylogenetic information difference metric, calling \code{PhylogeneticInformationDistance()} from package \pkg{TreeDist} (considers the trees unrooted)
\item \code{MS} the matching splits distance, calling \code{MatchingSplitsDistance()} from package \pkg{TreeDist} (considers the trees unrooted)
\item \code{MSID} the matching splits information difference metric, calling \code{ClusteringInformationDistance()} from package \pkg{TreeDist} (considers the trees unrooted)
\item \code{Abouheif}: performs Abouheif's test, inherited from \code{distTips} in \code{adephylo}. See Pavoine et al. (2008) and \code{adephylo}.
\item \code{sumDD}: sum of direct descendants of all nodes on the path, related to Abouheif's test, inherited from \code{distTips} in \code{adephylo}.
}}

\item{nf}{the number of principal components to retain}

\item{lambda}{a number in [0,1] which specifies the extent to which topology (default, with lambda=0)  or branch lengths (lambda=1) are emphasised in the Kendall Colijn metric.}

\item{return.tree.vectors}{if using the Kendall Colijn metric, this option will return the tree vectors as part of the output. Note that this can use a lot of memory so defaults to \code{FALSE}.}

\item{processors}{value (default 1) to be passed to mcmapply specifying the number of cores to use. Must be 1 on Windows (see \code{mcmapply} for more details).}

\item{...}{further arguments to be passed to \code{method}.}
}
\description{
Compares phylogenetic trees using a choice of metrics / measures, and maps their pairwise distances into a small number of dimensions for easy visualisation and identification of clusters.
}
\examples{

## generate list of trees
x <- rmtree(10, 20)
names(x) <- paste("tree", 1:10, sep = "")

## use treespace
res <- treespace(x, nf=3)
table.paint(as.matrix(res$D))
scatter(res$pco)

## Consider trees rooted:
rootedtrees <- structure(lapply(x, function (tr){
  tr$edge.length <- NULL
  TreeTools::AddTip(tr, where=0)
}), class='multiPhylo')
rootedres <- treespace(rootedtrees,nf=3)
table.paint(as.matrix(rootedres$D))
scatter(rootedres$pco)

data(woodmiceTrees)
woodmiceDists <- treespace(woodmiceTrees,nf=3)
plot(woodmiceDists$pco$li[,1],woodmiceDists$pco$li[,2])
woodmicedf <- woodmiceDists$pco$li
if(require(ggplot2)){
woodmiceplot <- ggplot(woodmicedf, aes(x=A1, y=A2)) # create plot
woodmiceplot + geom_density2d(colour="gray80") + # contour lines
geom_point(size=6, shape=1, colour="gray50") + # grey edges
geom_point(size=6, alpha=0.2, colour="navy") + # transparent blue points
xlab("") + ylab("") + theme_bw(base_family="") # remove axis labels and grey background
}

\dontrun{
if(require(rgl)){
plot3d(woodmicedf[,1], woodmicedf[,2], woodmicedf[,3], type="s", size=1.5,
col="navy", alpha=0.5, xlab="", ylab="", zlab="")
}
}

}
\references{
Bogdanowicz D, Giaro K (2012). “Matching split distance for unrooted binary
phylogenetic trees.” IEEE/ACM Transactions on Computational Biology and 
Bioinformatics, 9(1), 150–160. doi: 10.1109/TCBB.2011.48.

Kendall M, Colijn C (2016). “Mapping phylogenetic trees to reveal distinct
patterns of evolution.” Molecular Biology and Evolution, 33(10), 2735--2743.
doi: 10.1093/molbev/msw124 

Robinson DF, Foulds LR (1981). “Comparison of phylogenetic trees.” 
Mathematical Biosciences, 53(1-2), 131–147. 
doi: 10.1016/0025-5564(81)90043-2.

Smith MR (2020). “Information theoretic Generalized Robinson-Foulds metrics 
for comparing phylogenetic trees.” Bioinformatics, in production. 
doi: 10.1093/bioinformatics/btaa614.

Steel, M. A., & Penny, D. (1993). Distributions of tree comparison 
metrics—some new results. Systematic Biology, 42 (2), 126–141.
doi: 10.1093/sysbio/42.2.126
}
\author{
Thibaut Jombart \email{thibautjombart@gmail.com}

Michelle Kendall \email{michelle.louise.kendall@gmail.com}
}
