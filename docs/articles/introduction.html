<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploration of landscapes of phylogenetic trees â€¢ treespace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploration of landscapes of phylogenetic trees">
<meta property="og:description" content="treespace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treespace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DengueVignette.html">treespace worked example: Dengue trees</a>
    </li>
    <li>
      <a href="../articles/TransmissionTreesVignette.html">treespace worked example: Transmission trees</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Exploration of landscapes of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/tipCategories.html">Comparing trees by tip label categories</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thibautjombart/treespace/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/accessible-code-block-0.0.1/empty-anchor.js"></script><script src="introduction_files/htmlwidgets-1.5.2/htmlwidgets.js"></script><script src="introduction_files/d3v5-5.9.2/d3.v5.min.js"></script><script src="introduction_files/d3v5-5.9.2/d3-legend.min.js"></script><script src="introduction_files/d3v5-5.9.2/d3-labeler.js"></script><link href="introduction_files/d3.lasso-plugin-1.0.0/lasso.css" rel="stylesheet">
<script src="introduction_files/d3.lasso-plugin-1.0.0/lasso.js"></script><link href="introduction_files/scatterD3-0.8.2/scatterD3.css" rel="stylesheet">
<script src="introduction_files/scatterD3-0.8.2/scatterD3-utils.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-scales.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-dims.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-menu.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-axes.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-dots.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-arrows.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-labels.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-lines.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-ellipses.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-zoom.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-legend.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-lasso.js"></script><script src="introduction_files/scatterD3-0.8.2/scatterD3-exports.js"></script><script src="introduction_files/scatterD3-binding-0.9.1/scatterD3.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exploration of landscapes of phylogenetic trees</h1>
                        <h4 class="author">Thibaut Jombart, Michelle Kendall</h4>
            
            <h4 class="date">2020-10-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thibautjombart/treespace/blob/master/vignettes/introduction.Rmd"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p><em>treespace</em> implements new methods for the exploration and analysis of distributions of phylogenetic trees for a given set of taxa.</p>
<div id="installing-treespace" class="section level2">
<h2 class="hasAnchor">
<a href="#installing-treespace" class="anchor"></a>Installing <em>treespace</em>
</h2>
<p>To install the development version from github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/">devtools</a></span><span class="op">)</span>
<span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span><span class="op">(</span><span class="st">"thibautjombart/treespace"</span><span class="op">)</span></pre></div>
<p>The stable version can be installed from CRAN using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"treespace"</span><span class="op">)</span></pre></div>
<p>Then, to load the package, use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=treespace">"treespace"</a></span><span class="op">)</span></pre></div>
<pre><code>## Loading required package: ape</code></pre>
<pre><code>## Loading required package: ade4</code></pre>
<pre><code>## Creating a generic function for 'toJSON' from package 'jsonlite' in package 'googleVis'</code></pre>
<pre><code>## Registered S3 method overwritten by 'spdep':
##   method   from
##   plot.mst ape</code></pre>
<pre><code>## Registered S3 methods overwritten by 'adegraphics':
##   method         from
##   biplot.dudi    ade4
##   kplot.foucart  ade4
##   kplot.mcoa     ade4
##   kplot.mfa      ade4
##   kplot.pta      ade4
##   kplot.sepan    ade4
##   kplot.statis   ade4
##   scatter.coa    ade4
##   scatter.dudi   ade4
##   scatter.nipals ade4
##   scatter.pco    ade4
##   score.acm      ade4
##   score.mix      ade4
##   score.pca      ade4
##   screeplot.dudi ade4</code></pre>
</div>
<div id="content-overview" class="section level2">
<h2 class="hasAnchor">
<a href="#content-overview" class="anchor"></a>Content overview</h2>
<p>The main functions implemented in <em>treespace</em> are:</p>
<ul>
<li><p><strong><code>treespace</code></strong>: explore landscapes of phylogenetic trees</p></li>
<li><p><strong><code>treespaceServer</code></strong>: open up an application in a web browser for an interactive exploration of the diversity in a set of trees</p></li>
<li><p><strong><code>findGroves</code></strong>: identify clusters of similar trees</p></li>
<li><p><strong><code>plotGroves</code></strong>: scatterplot of groups of trees, and <strong><code>plotGrovesD3</code></strong> which enables interactive plotting based on d3.js</p></li>
<li><p><strong><code>medTree</code></strong>: find geometric median tree(s) to summarise a group of trees</p></li>
</ul>
<p>Other functions are central to the computations of distances between trees:</p>
<ul>
<li><p><strong><code>treeVec</code></strong>: characterise a tree by a vector</p></li>
<li><p><strong><code>treeDist</code></strong>: find the distance between two tree vectors</p></li>
<li><p><strong><code>multiDist</code></strong>: find the pairwise distances of a list of trees</p></li>
<li><p><strong><code>refTreeDist</code></strong>: find the distances of a list of trees from a reference tree</p></li>
<li><p><strong><code>tipDiff</code></strong>: for a pair of trees, list the tips with differing ancestry</p></li>
<li><p><strong><code>plotTreeDiff</code></strong>: plot a pair of trees, highlighting the tips with differing ancestry</p></li>
</ul>
<p>Distributed datasets include:</p>
<ul>
<li><p><strong><code>woodmiceTrees</code></strong>: illustrative set of 201 trees built using the neighbour-joining and bootstrapping example from the woodmice dataset in the ape documentation.</p></li>
<li><p><strong><code>DengueTrees</code></strong>: 500 trees sampled from a BEAST posterior set of trees from (Drummond and Rambaut, 2007)</p></li>
<li><p><strong><code>DengueSeqs</code></strong>: 17 dengue virus serotype 4 sequences from (Lanciotti <em>et al</em>., 1997), from which the <code>DengueTrees</code> were inferred.</p></li>
<li><p><strong><code>DengueBEASTMCC</code></strong>: the maximum clade credibility (MCC) tree from the <code>DengueTrees</code>.</p></li>
</ul>
</div>
<div id="exploring-trees-with-treespace" class="section level2">
<h2 class="hasAnchor">
<a href="#exploring-trees-with-treespace" class="anchor"></a>Exploring trees with <em>treespace</em>
</h2>
<p>We first load <em>treespace</em>, and the packages required for graphics:</p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=treespace">"treespace"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/thibautjombart/adegenet">"adegenet"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4">"adegraphics"</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st"><a href="https://r-forge.r-project.org/projects/rgl/">"rgl"</a></span><span class="op">)</span></pre></div>
<p>The function <code>treespace</code> defines typologies of phylogenetic trees using a two-step approach:</p>
<ol style="list-style-type: decimal">
<li><p>perform pairwise comparisons of trees using various (Euclidean) metrics; by default, the comparison uses the Kendall and Colijn metric (Kendall and Colijn, 2016) which is described in more detail below; other metrics rely on tip distances implemented in <em>adephylo</em> (Jombart <em>et al.</em>, 2010) and <em>phangorn</em> (Schliep 2011).</p></li>
<li><p>use Metric Multidimensional Scaling (MDS, aka Principal Coordinates Analysis, PCoA) to summarise pairwise distances between the trees as well as possible into a few dimensions; the output of the MDS is typically visualised using scatterplots of the first few Principal Components (PCs); this step relies on the PCoA implemented in <em>ade4</em> (Dray and Dufour, 2007).</p></li>
</ol>
<p>The function <code>treespace</code> performs both tasks, returning both the matrix of pairwise tree comparisons (<code>$D</code>), and the PCoA (<code>$pco</code>). This can be illustrated using randomly generated trees:</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="co"># generate list of trees</span>
<span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>
<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu">rmtree</span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"tree"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>

<span class="co"># use treespace</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">x</span>, nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></pre></div>
<pre><code>## [1] "D"   "pco"</code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="va">res</span></pre></div>
<pre><code>## $D
##        tree1 tree2 tree3 tree4 tree5 tree6 tree7 tree8 tree9
## tree2  26.00                                                
## tree3  31.06 26.74                                          
## tree4  42.85 42.12 44.44                                    
## tree5  30.66 27.71 27.37 44.79                              
## tree6  36.50 31.18 30.18 41.81 31.59                        
## tree7  34.64 28.71 29.48 40.35 31.11 32.37                  
## tree8  28.97 26.29 24.45 43.74 23.47 30.41 29.00            
## tree9  29.63 27.42 27.48 45.61 26.31 30.89 29.77 24.60      
## tree10 34.87 30.00 29.44 44.97 34.06 31.05 34.41 31.54 32.59
## 
## $pco
## Duality diagramm
## class: pco dudi
## $call: dudi.pco(d = D, scannf = is.null(nf), nf = nf)
## 
## $nf: 3 axis-components saved
## $rank: 9
## eigen values: 142.1 76.52 62.69 49.88 41.07 ...
##   vector length mode    content       
## 1 $cw    9      numeric column weights
## 2 $lw    10     numeric row weights   
## 3 $eig   9      numeric eigen values  
## 
##   data.frame nrow ncol content             
## 1 $tab       10   9    modified array      
## 2 $li        10   3    row coordinates     
## 3 $l1        10   3    row normed scores   
## 4 $co        9    3    column coordinates  
## 5 $c1        9    3    column normed scores
## other elements: NULL</code></pre>
<p>Pairwise tree distances can be visualised using <em>adegraphics</em>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="co"># table.image</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.image.html">table.image</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">D</span>, nclass<span class="op">=</span><span class="fl">30</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/distances-1.png" width="672"></p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="co"># table.value with some customization</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.value.html">table.value</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">D</span>, nclass<span class="op">=</span><span class="fl">5</span>, method<span class="op">=</span><span class="st">"color"</span>, 
            symbol<span class="op">=</span><span class="st">"circle"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/auxil.html">redpal</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/distances-2.png" width="672"></p>
<p>The best representation of these distances in a 2-dimensional space is given by the first 2 PCs of the MDS. These can be visualised using any scatter plotting tool; here we use the <em>treespace</em> function <code>plotGroves</code>, based on the <em>adegraphics</em> function <code>scatter</code>:</p>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="../reference/plotGroves.html">plotGroves</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pco</span>, lab.show<span class="op">=</span><span class="cn">TRUE</span>, lab.cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/plotgroves-1.png" width="672"></p>
<p>Alternatively, <code>plotGrovesD3</code> creates interactive plots based on d3.js:</p>
<div class="sourceCode" id="cb17"><pre class="downlit">
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pco</span>, treeNames<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></pre></div>
<p></p>
<div id="htmlwidget-9c0ebce7b393905d8ee5" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-9c0ebce7b393905d8ee5">{"x":{"data":{"x":[2.13035259412571,3.31143165077361,6.68261423648124,-34.2627208913964,7.25843567957564,-1.08828681782319,-2.41764971191633,6.88799030499781,8.36065794480431,3.13717501037757],"y":[-15.1746612118386,-4.3359528090973,2.8576050061263,-2.52929101464511,-5.13714617827929,14.9963546470384,0.889403081968251,-3.36078022712547,-3.2861444217133,15.0806131275662],"lab":[1,2,3,4,5,6,7,8,9,10],"key_var":[1,2,3,4,5,6,7,8,9,10]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":true,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-WKQKITSX","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script> Tree labels can be dragged into new positions to avoid problems such as overlapping.
<p>The functionality of <code>treespace</code> can be further illustrated using <em>ape</em>â€™s dataset <em>woodmouse</em>, from which we built the 201 trees supplied in <code>woodmiceTrees</code> using the neighbour-joining and bootstrapping example from the <em>ape</em> documentation.</p>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">woodmiceTrees</span><span class="op">)</span>
<span class="va">wm.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co"># PCs are stored in:</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">wm.res</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">)</span></pre></div>
<pre><code>##         A1     A2      A3
## 1  -0.9949 -1.363 -0.7918
## 2  -0.6137 -1.014 -0.6798
## 3   2.6667  4.219 -2.9293
## 4 -13.6081  1.854  1.0947
## 5   2.1980  4.176 -3.1960
## 6   3.6013  4.865  2.9853</code></pre>
<div class="sourceCode" id="cb20"><pre class="downlit">
<span class="co"># plot results</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.res</span><span class="op">$</span><span class="va">pco</span><span class="op">)</span></pre></div>
<div id="htmlwidget-45d3ade64b62e7c78a9d" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-45d3ade64b62e7c78a9d">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-PBTXSPOJ","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>Packages such as <em>adegraphics</em> and <em>ggplot2</em> can be used to make alternative plots, for example visualising the density of points within the space.</p>
<p>The <em>treespace</em> function <code>multiDist</code> simply performs the pairwise comparison of trees and outputs a distance matrix. This function may be preferable for large datasets, and when principal co-ordinate analysis is not required. It includes an option to save memory at the expense of computation time.</p>
</div>
<div id="identifying-clusters-of-trees" class="section level2">
<h2 class="hasAnchor">
<a href="#identifying-clusters-of-trees" class="anchor"></a>Identifying clusters of trees</h2>
<p>Once a typology of trees has been derived using the approach described above, one may want to formally identify clusters of similar trees. One simple approach is:</p>
<ol style="list-style-type: decimal">
<li><p>select a few first PCs of the MDS (retaining signal but getting rid of random noise)</p></li>
<li><p>derive pairwise Euclidean distances between trees based on these PCs</p></li>
<li><p>use hierarchical clustering to obtain a dendrogram of these trees</p></li>
<li><p>cut the dendrogram to obtain clusters</p></li>
</ol>
<p>In <em>treespace</em>, the function <code>findGroves</code> implements this approach, offering various clustering options (see <code><a href="../reference/findGroves.html">?findGroves</a></code>). Here we supply the function with our <code>treespace</code> output <code>wm.res</code> since we have already calculated it, but it is also possible to skip the steps above and directly supply <code>findGroves</code> with a multiPhylo list of trees.</p>
<div class="sourceCode" id="cb21"><pre class="downlit">
<span class="va">wm.groves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGroves.html">findGroves</a></span><span class="op">(</span><span class="va">wm.res</span>, nclust<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">)</span></pre></div>
<pre><code>## [1] "groups"    "treespace"</code></pre>
<p>Note that when the number of clusters (<code>nclust</code>) is not provided, the function will display a dendrogram and ask for a cut-off height.</p>
<p>The results can be plotted directly using <code>plotGrovesD3</code> (see <code><a href="../reference/plotGrovesD3.html">?plotGrovesD3</a></code> for options):</p>
<div class="sourceCode" id="cb23"><pre class="downlit">
<span class="co"># basic plot</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">)</span></pre></div>
<div id="htmlwidget-ec4d5cf56b90cc7adfb3" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-ec4d5cf56b90cc7adfb3">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-OXHVRXHK","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb24"><pre class="downlit">
<span class="co"># alternative with improved legend and tooltip text, giving the tree numbers:</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span>, tooltip_text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Tree "</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">201</span><span class="op">)</span>, legend_width<span class="op">=</span><span class="fl">50</span>, col_lab<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span></pre></div>
<div id="htmlwidget-20a6cc3ddd7a54fec278" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-20a6cc3ddd7a54fec278">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"Cluster","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"],"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":true,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":50,"left_margin":30,"html_id":"scatterD3-XUOQYHJY","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb25"><pre class="downlit">
<span class="co"># plot axes 2 and 3. This helps to show why, for example, clusters 2 and 4 have been identified as separate, despite them appearing to overlap when viewing axes 1 and 2.</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span>, xax<span class="op">=</span><span class="fl">2</span>, yax<span class="op">=</span><span class="fl">3</span>, tooltip_text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"Tree "</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">201</span><span class="op">)</span>, legend_width<span class="op">=</span><span class="fl">50</span>, col_lab<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span></pre></div>
<div id="htmlwidget-41624cc46ea73e4bee23" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-41624cc46ea73e4bee23">{"x":{"data":{"x":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"y":[-0.791807120249666,-0.679832427223742,-2.92925942555435,1.09465428278252,-3.19598990128449,2.98532664792082,-0.00778405606618283,-0.7772226997152,-0.79180712024967,-0.777222699715199,-0.760072357367479,3.3038947003599,-3.40748488325369,-0.69781326696592,2.40355762496095,0.865577600628614,0.136458887783133,-2.09231261460812,0.819616564951839,-0.215862843943144,2.95932040786593,1.6471221906073,2.05426452985354,-0.108448694706785,-0.763403010869589,-0.761464865832367,-4.61368594406494,-0.763403010869588,-1.2995156179144,1.0775039404348,1.35907283698071,-2.96099418843654,-2.1620882075821,3.90255872054314,0.378657883293157,0.103872863482392,2.13706456182689,-0.686396318956685,-0.59182050470279,2.21815542994855,-0.834963702652257,-2.65512617193849,-2.94640976790208,-3.01147184043474,0.418953289588122,-1.8602554675923,2.07502372864851,2.23197511879416,3.77070934301328,0.0873387907485269,-6.0251767697577,-2.92925942555436,-1.37480474565574,-0.760072357367478,0.866351115881724,0.775331213349539,-0.528730916906763,-0.791807120249666,-2.85434601246157,2.55208435392359,1.22146763124848,-1.08744389302262,-0.750767849712733,2.28298044216336,-0.140546000705087,1.97487375669685,1.5228832413366,-2.24587395467828,-2.08184827743835,-1.06401908089937,-3.27378130355721,-1.23247839126816,-0.791807120249667,1.00141041356008,0.0270318659982166,3.53603222375692,0.312934867134759,-0.346942499687587,-2.73536610208223,-4.70660604131172,-0.00738509993655636,0.83284635685646,-2.62594687235201,-0.956153798970743,3.18874338840916,-0.791807120249667,-0.761464865832364,-1.39346524940518,0.84999669920418,0.121023205830115,-0.69781326696592,-3.25528843806406,-0.763403010869588,1.57169358842431,0.308931600594576,5.88590039862656,0.682773293239123,-2.8807542582928,0.751477363813679,0.560154064569638,2.28713762544423,-2.30106966976248,11.1825410524607,0.650480470413352,0.560003228024782,3.08271692041227,3.84588992955306,1.4259409755107,-0.48593910375161,-0.988445353723404,-2.96099418843654,-6.07368193701926,-0.776049286366833,1.97402459970979,7.47301570685624,-2.75251644442995,0.244791925035197,-0.791807120249667,-0.834963702652258,-1.87740580994002,0.476155006559635,-0.283852911891559,-0.852114044999977,3.66100108055515,0.027031865998216,-2.97814453078426,-0.760072357367479,0.424741034702748,-3.23653680258836,3.24297707849804,-0.749456829559982,-6.0365985892781,0.0595083268667454,-0.72871753245364,0.00709886060477673,2.31471520504555,-0.791807120249667,-1.00753384110834,-0.808957462597387,2.22350401480751,-0.760072357367479,8.06587365367529,0.84999669920418,1.88710542540638,-0.280344395842815,-0.72298900962632,-1.50356411729547,0.308931600594576,-5.00217330963617,-0.27230511920102,0.84999669920418,-0.223004170947065,2.75819031622352,-0.485939103751611,-1.48641377494775,-0.0360577217978117,-1.04999577603402,3.02240999566196,-0.808957462597387,-1.02135352995395,-1.00420318760624,-2.20524478998469,2.20357100941408,-0.814541392460031,-1.44197041666674,-3.07583163197834,-0.109860954387011,2.17816196207245,0.0873387907485262,3.322195522521,2.20357100941408,-0.0100514817429415,0.560003228024789,-0.233013186290863,-3.35508908945222,-1.64568331644142,-2.96099418843654,-0.29148551842895,-0.761464865832366,1.97487375669685,-2.96099418843654,-0.728717532453639,-1.45912075901446,0.375780316256859,12.8748186262961,1.4259409755107,0.925830858475525,0.199932192387692,-0.926186263321842,-0.679832427223731,-0.765214663442814,-1.00720396287887,-2.97814453078426,-0.760072357367479,-1.01084386327632,3.67815142290287,2.32280843850173,2.28713762544423,12.9064005040783,-2.73536610208224,-2.63985283305162],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 2","ylab":"Axis 3","has_labels":false,"col_lab":"Cluster","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"],"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":true,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":50,"left_margin":30,"html_id":"scatterD3-KOUMWSDQ","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>We can also plot in 3D:</p>
<div class="sourceCode" id="cb26"><pre class="downlit">
<span class="co"># prepare a colour palette:</span>
<span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/auxil.html">fac2col</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">$</span><span class="va">groups</span>, col.pal<span class="op">=</span><span class="va">funky</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/rgl/man/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,
       <span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,
       <span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,
       col<span class="op">=</span><span class="va">colours</span>, type<span class="op">=</span><span class="st">"s"</span>, size<span class="op">=</span><span class="fl">1.5</span>,
       xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, zlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></pre></div>
<script>/*
* Copyright (C) 2009 Apple Inc. All Rights Reserved.
*
* Redistribution and use in source and binary forms, with or without
* modification, are permitted provided that the following conditions
* are met:
* 1. Redistributions of source code must retain the above copyright
*    notice, this list of conditions and the following disclaimer.
* 2. Redistributions in binary form must reproduce the above copyright
*    notice, this list of conditions and the following disclaimer in the
*    documentation and/or other materials provided with the distribution.
*
* THIS SOFTWARE IS PROVIDED BY APPLE INC. ``AS IS'' AND ANY
* EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
* IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
* PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL APPLE INC. OR
* CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
* EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
* PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
* PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
* OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
* (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
* OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
* Copyright (2016) Duncan Murdoch - fixed CanvasMatrix4.ortho,
* cleaned up.
*/
/*
CanvasMatrix4 class
This class implements a 4x4 matrix. It has functions which
duplicate the functionality of the OpenGL matrix stack and
glut functions.
IDL:
[
Constructor(in CanvasMatrix4 matrix),           // copy passed matrix into new CanvasMatrix4
Constructor(in sequence<float> array)           // create new CanvasMatrix4 with 16 floats (row major)
Constructor()                                   // create new CanvasMatrix4 with identity matrix
]
interface CanvasMatrix4 {
attribute float m11;
attribute float m12;
attribute float m13;
attribute float m14;
attribute float m21;
attribute float m22;
attribute float m23;
attribute float m24;
attribute float m31;
attribute float m32;
attribute float m33;
attribute float m34;
attribute float m41;
attribute float m42;
attribute float m43;
attribute float m44;
void load(in CanvasMatrix4 matrix);                 // copy the values from the passed matrix
void load(in sequence<float> array);                // copy 16 floats into the matrix
sequence<float> getAsArray();                       // return the matrix as an array of 16 floats
WebGLFloatArray getAsCanvasFloatArray();           // return the matrix as a WebGLFloatArray with 16 values
void makeIdentity();                                // replace the matrix with identity
void transpose();                                   // replace the matrix with its transpose
void invert();                                      // replace the matrix with its inverse
void translate(in float x, in float y, in float z); // multiply the matrix by passed translation values on the right
void scale(in float x, in float y, in float z);     // multiply the matrix by passed scale values on the right
void rotate(in float angle,                         // multiply the matrix by passed rotation values on the right
in float x, in float y, in float z);    // (angle is in degrees)
void multRight(in CanvasMatrix matrix);             // multiply the matrix by the passed matrix on the right
void multLeft(in CanvasMatrix matrix);              // multiply the matrix by the passed matrix on the left
void ortho(in float left, in float right,           // multiply the matrix by the passed ortho values on the right
in float bottom, in float top,
in float near, in float far);
void frustum(in float left, in float right,         // multiply the matrix by the passed frustum values on the right
in float bottom, in float top,
in float near, in float far);
void perspective(in float fovy, in float aspect,    // multiply the matrix by the passed perspective values on the right
in float zNear, in float zFar);
void lookat(in float eyex, in float eyey, in float eyez,    // multiply the matrix by the passed lookat
in float ctrx, in float ctry, in float ctrz,    // values on the right
in float upx, in float upy, in float upz);
}
*/
CanvasMatrix4 = function(m)
{
if (typeof m == 'object') {
if ("length" in m && m.length >= 16) {
this.load(m[0], m[1], m[2], m[3], m[4], m[5], m[6], m[7], m[8], m[9], m[10], m[11], m[12], m[13], m[14], m[15]);
return;
}
else if (m instanceof CanvasMatrix4) {
this.load(m);
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.load = function()
{
if (arguments.length == 1 && typeof arguments[0] == 'object') {
var matrix = arguments[0];
if ("length" in matrix && matrix.length == 16) {
this.m11 = matrix[0];
this.m12 = matrix[1];
this.m13 = matrix[2];
this.m14 = matrix[3];
this.m21 = matrix[4];
this.m22 = matrix[5];
this.m23 = matrix[6];
this.m24 = matrix[7];
this.m31 = matrix[8];
this.m32 = matrix[9];
this.m33 = matrix[10];
this.m34 = matrix[11];
this.m41 = matrix[12];
this.m42 = matrix[13];
this.m43 = matrix[14];
this.m44 = matrix[15];
return;
}
if (arguments[0] instanceof CanvasMatrix4) {
this.m11 = matrix.m11;
this.m12 = matrix.m12;
this.m13 = matrix.m13;
this.m14 = matrix.m14;
this.m21 = matrix.m21;
this.m22 = matrix.m22;
this.m23 = matrix.m23;
this.m24 = matrix.m24;
this.m31 = matrix.m31;
this.m32 = matrix.m32;
this.m33 = matrix.m33;
this.m34 = matrix.m34;
this.m41 = matrix.m41;
this.m42 = matrix.m42;
this.m43 = matrix.m43;
this.m44 = matrix.m44;
return;
}
}
this.makeIdentity();
};
CanvasMatrix4.prototype.getAsArray = function()
{
return [
this.m11, this.m12, this.m13, this.m14,
this.m21, this.m22, this.m23, this.m24,
this.m31, this.m32, this.m33, this.m34,
this.m41, this.m42, this.m43, this.m44
];
};
CanvasMatrix4.prototype.getAsWebGLFloatArray = function()
{
return new WebGLFloatArray(this.getAsArray());
};
CanvasMatrix4.prototype.makeIdentity = function()
{
this.m11 = 1;
this.m12 = 0;
this.m13 = 0;
this.m14 = 0;
this.m21 = 0;
this.m22 = 1;
this.m23 = 0;
this.m24 = 0;
this.m31 = 0;
this.m32 = 0;
this.m33 = 1;
this.m34 = 0;
this.m41 = 0;
this.m42 = 0;
this.m43 = 0;
this.m44 = 1;
};
CanvasMatrix4.prototype.transpose = function()
{
var tmp = this.m12;
this.m12 = this.m21;
this.m21 = tmp;
tmp = this.m13;
this.m13 = this.m31;
this.m31 = tmp;
tmp = this.m14;
this.m14 = this.m41;
this.m41 = tmp;
tmp = this.m23;
this.m23 = this.m32;
this.m32 = tmp;
tmp = this.m24;
this.m24 = this.m42;
this.m42 = tmp;
tmp = this.m34;
this.m34 = this.m43;
this.m43 = tmp;
};
CanvasMatrix4.prototype.invert = function()
{
// Calculate the 4x4 determinant
// If the determinant is zero,
// then the inverse matrix is not unique.
var det = this._determinant4x4();
if (Math.abs(det) < 1e-8)
return null;
this._makeAdjoint();
// Scale the adjoint matrix to get the inverse
this.m11 /= det;
this.m12 /= det;
this.m13 /= det;
this.m14 /= det;
this.m21 /= det;
this.m22 /= det;
this.m23 /= det;
this.m24 /= det;
this.m31 /= det;
this.m32 /= det;
this.m33 /= det;
this.m34 /= det;
this.m41 /= det;
this.m42 /= det;
this.m43 /= det;
this.m44 /= det;
};
CanvasMatrix4.prototype.translate = function(x,y,z)
{
if (x === undefined)
x = 0;
if (y === undefined)
y = 0;
if (z === undefined)
z = 0;
var matrix = new CanvasMatrix4();
matrix.m41 = x;
matrix.m42 = y;
matrix.m43 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.scale = function(x,y,z)
{
if (x === undefined)
x = 1;
if (z === undefined) {
if (y === undefined) {
y = x;
z = x;
}
else
z = 1;
}
else if (y === undefined)
y = x;
var matrix = new CanvasMatrix4();
matrix.m11 = x;
matrix.m22 = y;
matrix.m33 = z;
this.multRight(matrix);
};
CanvasMatrix4.prototype.rotate = function(angle,x,y,z)
{
// angles are in degrees. Switch to radians
angle = angle / 180 * Math.PI;
angle /= 2;
var sinA = Math.sin(angle);
var cosA = Math.cos(angle);
var sinA2 = sinA * sinA;
// normalize
var length = Math.sqrt(x * x + y * y + z * z);
if (length === 0) {
// bad vector, just use something reasonable
x = 0;
y = 0;
z = 1;
} else if (length != 1) {
x /= length;
y /= length;
z /= length;
}
var mat = new CanvasMatrix4();
// optimize case where axis is along major axis
if (x == 1 && y === 0 && z === 0) {
mat.m11 = 1;
mat.m12 = 0;
mat.m13 = 0;
mat.m21 = 0;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 2 * sinA * cosA;
mat.m31 = 0;
mat.m32 = -2 * sinA * cosA;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y == 1 && z === 0) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 0;
mat.m13 = -2 * sinA * cosA;
mat.m21 = 0;
mat.m22 = 1;
mat.m23 = 0;
mat.m31 = 2 * sinA * cosA;
mat.m32 = 0;
mat.m33 = 1 - 2 * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else if (x === 0 && y === 0 && z == 1) {
mat.m11 = 1 - 2 * sinA2;
mat.m12 = 2 * sinA * cosA;
mat.m13 = 0;
mat.m21 = -2 * sinA * cosA;
mat.m22 = 1 - 2 * sinA2;
mat.m23 = 0;
mat.m31 = 0;
mat.m32 = 0;
mat.m33 = 1;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
} else {
var x2 = x*x;
var y2 = y*y;
var z2 = z*z;
mat.m11 = 1 - 2 * (y2 + z2) * sinA2;
mat.m12 = 2 * (x * y * sinA2 + z * sinA * cosA);
mat.m13 = 2 * (x * z * sinA2 - y * sinA * cosA);
mat.m21 = 2 * (y * x * sinA2 - z * sinA * cosA);
mat.m22 = 1 - 2 * (z2 + x2) * sinA2;
mat.m23 = 2 * (y * z * sinA2 + x * sinA * cosA);
mat.m31 = 2 * (z * x * sinA2 + y * sinA * cosA);
mat.m32 = 2 * (z * y * sinA2 - x * sinA * cosA);
mat.m33 = 1 - 2 * (x2 + y2) * sinA2;
mat.m14 = mat.m24 = mat.m34 = 0;
mat.m41 = mat.m42 = mat.m43 = 0;
mat.m44 = 1;
}
this.multRight(mat);
};
CanvasMatrix4.prototype.multRight = function(mat)
{
var m11 = (this.m11 * mat.m11 + this.m12 * mat.m21 +
this.m13 * mat.m31 + this.m14 * mat.m41);
var m12 = (this.m11 * mat.m12 + this.m12 * mat.m22 +
this.m13 * mat.m32 + this.m14 * mat.m42);
var m13 = (this.m11 * mat.m13 + this.m12 * mat.m23 +
this.m13 * mat.m33 + this.m14 * mat.m43);
var m14 = (this.m11 * mat.m14 + this.m12 * mat.m24 +
this.m13 * mat.m34 + this.m14 * mat.m44);
var m21 = (this.m21 * mat.m11 + this.m22 * mat.m21 +
this.m23 * mat.m31 + this.m24 * mat.m41);
var m22 = (this.m21 * mat.m12 + this.m22 * mat.m22 +
this.m23 * mat.m32 + this.m24 * mat.m42);
var m23 = (this.m21 * mat.m13 + this.m22 * mat.m23 +
this.m23 * mat.m33 + this.m24 * mat.m43);
var m24 = (this.m21 * mat.m14 + this.m22 * mat.m24 +
this.m23 * mat.m34 + this.m24 * mat.m44);
var m31 = (this.m31 * mat.m11 + this.m32 * mat.m21 +
this.m33 * mat.m31 + this.m34 * mat.m41);
var m32 = (this.m31 * mat.m12 + this.m32 * mat.m22 +
this.m33 * mat.m32 + this.m34 * mat.m42);
var m33 = (this.m31 * mat.m13 + this.m32 * mat.m23 +
this.m33 * mat.m33 + this.m34 * mat.m43);
var m34 = (this.m31 * mat.m14 + this.m32 * mat.m24 +
this.m33 * mat.m34 + this.m34 * mat.m44);
var m41 = (this.m41 * mat.m11 + this.m42 * mat.m21 +
this.m43 * mat.m31 + this.m44 * mat.m41);
var m42 = (this.m41 * mat.m12 + this.m42 * mat.m22 +
this.m43 * mat.m32 + this.m44 * mat.m42);
var m43 = (this.m41 * mat.m13 + this.m42 * mat.m23 +
this.m43 * mat.m33 + this.m44 * mat.m43);
var m44 = (this.m41 * mat.m14 + this.m42 * mat.m24 +
this.m43 * mat.m34 + this.m44 * mat.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.multLeft = function(mat)
{
var m11 = (mat.m11 * this.m11 + mat.m12 * this.m21 +
mat.m13 * this.m31 + mat.m14 * this.m41);
var m12 = (mat.m11 * this.m12 + mat.m12 * this.m22 +
mat.m13 * this.m32 + mat.m14 * this.m42);
var m13 = (mat.m11 * this.m13 + mat.m12 * this.m23 +
mat.m13 * this.m33 + mat.m14 * this.m43);
var m14 = (mat.m11 * this.m14 + mat.m12 * this.m24 +
mat.m13 * this.m34 + mat.m14 * this.m44);
var m21 = (mat.m21 * this.m11 + mat.m22 * this.m21 +
mat.m23 * this.m31 + mat.m24 * this.m41);
var m22 = (mat.m21 * this.m12 + mat.m22 * this.m22 +
mat.m23 * this.m32 + mat.m24 * this.m42);
var m23 = (mat.m21 * this.m13 + mat.m22 * this.m23 +
mat.m23 * this.m33 + mat.m24 * this.m43);
var m24 = (mat.m21 * this.m14 + mat.m22 * this.m24 +
mat.m23 * this.m34 + mat.m24 * this.m44);
var m31 = (mat.m31 * this.m11 + mat.m32 * this.m21 +
mat.m33 * this.m31 + mat.m34 * this.m41);
var m32 = (mat.m31 * this.m12 + mat.m32 * this.m22 +
mat.m33 * this.m32 + mat.m34 * this.m42);
var m33 = (mat.m31 * this.m13 + mat.m32 * this.m23 +
mat.m33 * this.m33 + mat.m34 * this.m43);
var m34 = (mat.m31 * this.m14 + mat.m32 * this.m24 +
mat.m33 * this.m34 + mat.m34 * this.m44);
var m41 = (mat.m41 * this.m11 + mat.m42 * this.m21 +
mat.m43 * this.m31 + mat.m44 * this.m41);
var m42 = (mat.m41 * this.m12 + mat.m42 * this.m22 +
mat.m43 * this.m32 + mat.m44 * this.m42);
var m43 = (mat.m41 * this.m13 + mat.m42 * this.m23 +
mat.m43 * this.m33 + mat.m44 * this.m43);
var m44 = (mat.m41 * this.m14 + mat.m42 * this.m24 +
mat.m43 * this.m34 + mat.m44 * this.m44);
this.m11 = m11;
this.m12 = m12;
this.m13 = m13;
this.m14 = m14;
this.m21 = m21;
this.m22 = m22;
this.m23 = m23;
this.m24 = m24;
this.m31 = m31;
this.m32 = m32;
this.m33 = m33;
this.m34 = m34;
this.m41 = m41;
this.m42 = m42;
this.m43 = m43;
this.m44 = m44;
};
CanvasMatrix4.prototype.ortho = function(left, right, bottom, top, near, far)
{
var tx = (left + right) / (left - right);
var ty = (top + bottom) / (bottom - top);
var tz = (far + near) / (near - far);
var matrix = new CanvasMatrix4();
matrix.m11 = 2 / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = 0;
matrix.m32 = 0;
matrix.m33 = -2 / (far - near);
matrix.m34 = 0;
matrix.m41 = tx;
matrix.m42 = ty;
matrix.m43 = tz;
matrix.m44 = 1;
this.multRight(matrix);
};
CanvasMatrix4.prototype.frustum = function(left, right, bottom, top, near, far)
{
var matrix = new CanvasMatrix4();
var A = (right + left) / (right - left);
var B = (top + bottom) / (top - bottom);
var C = -(far + near) / (far - near);
var D = -(2 * far * near) / (far - near);
matrix.m11 = (2 * near) / (right - left);
matrix.m12 = 0;
matrix.m13 = 0;
matrix.m14 = 0;
matrix.m21 = 0;
matrix.m22 = 2 * near / (top - bottom);
matrix.m23 = 0;
matrix.m24 = 0;
matrix.m31 = A;
matrix.m32 = B;
matrix.m33 = C;
matrix.m34 = -1;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = D;
matrix.m44 = 0;
this.multRight(matrix);
};
CanvasMatrix4.prototype.perspective = function(fovy, aspect, zNear, zFar)
{
var top = Math.tan(fovy * Math.PI / 360) * zNear;
var bottom = -top;
var left = aspect * bottom;
var right = aspect * top;
this.frustum(left, right, bottom, top, zNear, zFar);
};
CanvasMatrix4.prototype.lookat = function(eyex, eyey, eyez, centerx, centery, centerz, upx, upy, upz)
{
var matrix = new CanvasMatrix4();
// Make rotation matrix
// Z vector
var zx = eyex - centerx;
var zy = eyey - centery;
var zz = eyez - centerz;
var mag = Math.sqrt(zx * zx + zy * zy + zz * zz);
if (mag) {
zx /= mag;
zy /= mag;
zz /= mag;
}
// Y vector
var yx = upx;
var yy = upy;
var yz = upz;
// X vector = Y cross Z
xx =  yy * zz - yz * zy;
xy = -yx * zz + yz * zx;
xz =  yx * zy - yy * zx;
// Recompute Y = Z cross X
yx = zy * xz - zz * xy;
yy = -zx * xz + zz * xx;
yx = zx * xy - zy * xx;
// cross product gives area of parallelogram, which is < 1.0 for
// non-perpendicular unit-length vectors; so normalize x, y here
mag = Math.sqrt(xx * xx + xy * xy + xz * xz);
if (mag) {
xx /= mag;
xy /= mag;
xz /= mag;
}
mag = Math.sqrt(yx * yx + yy * yy + yz * yz);
if (mag) {
yx /= mag;
yy /= mag;
yz /= mag;
}
matrix.m11 = xx;
matrix.m12 = xy;
matrix.m13 = xz;
matrix.m14 = 0;
matrix.m21 = yx;
matrix.m22 = yy;
matrix.m23 = yz;
matrix.m24 = 0;
matrix.m31 = zx;
matrix.m32 = zy;
matrix.m33 = zz;
matrix.m34 = 0;
matrix.m41 = 0;
matrix.m42 = 0;
matrix.m43 = 0;
matrix.m44 = 1;
matrix.translate(-eyex, -eyey, -eyez);
this.multRight(matrix);
};
// Support functions
CanvasMatrix4.prototype._determinant2x2 = function(a, b, c, d)
{
return a * d - b * c;
};
CanvasMatrix4.prototype._determinant3x3 = function(a1, a2, a3, b1, b2, b3, c1, c2, c3)
{
return a1 * this._determinant2x2(b2, b3, c2, c3) -
b1 * this._determinant2x2(a2, a3, c2, c3) +
c1 * this._determinant2x2(a2, a3, b2, b3);
};
CanvasMatrix4.prototype._determinant4x4 = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
return a1 * this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4) -
b1 * this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4) +
c1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4) -
d1 * this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
};
CanvasMatrix4.prototype._makeAdjoint = function()
{
var a1 = this.m11;
var b1 = this.m12;
var c1 = this.m13;
var d1 = this.m14;
var a2 = this.m21;
var b2 = this.m22;
var c2 = this.m23;
var d2 = this.m24;
var a3 = this.m31;
var b3 = this.m32;
var c3 = this.m33;
var d3 = this.m34;
var a4 = this.m41;
var b4 = this.m42;
var c4 = this.m43;
var d4 = this.m44;
// Row column labeling reversed since we transpose rows & columns
this.m11  =   this._determinant3x3(b2, b3, b4, c2, c3, c4, d2, d3, d4);
this.m21  = - this._determinant3x3(a2, a3, a4, c2, c3, c4, d2, d3, d4);
this.m31  =   this._determinant3x3(a2, a3, a4, b2, b3, b4, d2, d3, d4);
this.m41  = - this._determinant3x3(a2, a3, a4, b2, b3, b4, c2, c3, c4);
this.m12  = - this._determinant3x3(b1, b3, b4, c1, c3, c4, d1, d3, d4);
this.m22  =   this._determinant3x3(a1, a3, a4, c1, c3, c4, d1, d3, d4);
this.m32  = - this._determinant3x3(a1, a3, a4, b1, b3, b4, d1, d3, d4);
this.m42  =   this._determinant3x3(a1, a3, a4, b1, b3, b4, c1, c3, c4);
this.m13  =   this._determinant3x3(b1, b2, b4, c1, c2, c4, d1, d2, d4);
this.m23  = - this._determinant3x3(a1, a2, a4, c1, c2, c4, d1, d2, d4);
this.m33  =   this._determinant3x3(a1, a2, a4, b1, b2, b4, d1, d2, d4);
this.m43  = - this._determinant3x3(a1, a2, a4, b1, b2, b4, c1, c2, c4);
this.m14  = - this._determinant3x3(b1, b2, b3, c1, c2, c3, d1, d2, d3);
this.m24  =   this._determinant3x3(a1, a2, a3, c1, c2, c3, d1, d2, d3);
this.m34  = - this._determinant3x3(a1, a2, a3, b1, b2, b3, d1, d2, d3);
this.m44  =   this._determinant3x3(a1, a2, a3, b1, b2, b3, c1, c2, c3);
};</script><script>// To generate the help pages for this library, use
// jsdoc --destination ../../../doc/rglwidgetClass --template ~/node_modules/jsdoc-baseline rglClass.src.js
// To validate, use
// setwd(".../inst/htmlwidgets/lib/rglClass")
// hints <- js::jshint(readLines("rglClass.src.js"))
// hints[, c("line", "reason")]
/**
* The class of an rgl widget
* @class
*/
rglwidgetClass = function() {
this.canvas = null;
this.userMatrix = new CanvasMatrix4();
this.types = [];
this.prMatrix = new CanvasMatrix4();
this.mvMatrix = new CanvasMatrix4();
this.vp = null;
this.prmvMatrix = null;
this.origs = null;
this.gl = null;
this.scene = null;
this.select = {state: "inactive", subscene: null, region: {p1: {x:0, y:0}, p2: {x:0, y:0}}};
this.drawing = false;
};
/**
* Multiply matrix by vector
* @returns {number[]}
* @param M {number[][]} Left operand
* @param v {number[]} Right operand
*/
rglwidgetClass.prototype.multMV = function(M, v) {
return [ M.m11 * v[0] + M.m12 * v[1] + M.m13 * v[2] + M.m14 * v[3],
M.m21 * v[0] + M.m22 * v[1] + M.m23 * v[2] + M.m24 * v[3],
M.m31 * v[0] + M.m32 * v[1] + M.m33 * v[2] + M.m34 * v[3],
M.m41 * v[0] + M.m42 * v[1] + M.m43 * v[2] + M.m44 * v[3]
];
};
/**
* Multiply row vector by Matrix
* @returns {number[]}
* @param v {number[]} left operand
* @param M {number[][]} right operand
*/
rglwidgetClass.prototype.multVM = function(v, M) {
return [ M.m11 * v[0] + M.m21 * v[1] + M.m31 * v[2] + M.m41 * v[3],
M.m12 * v[0] + M.m22 * v[1] + M.m32 * v[2] + M.m42 * v[3],
M.m13 * v[0] + M.m23 * v[1] + M.m33 * v[2] + M.m43 * v[3],
M.m14 * v[0] + M.m24 * v[1] + M.m34 * v[2] + M.m44 * v[3]
];
};
/**
* Euclidean length of a vector
* @returns {number}
* @param v {number[]}
*/
rglwidgetClass.prototype.vlen = function(v) {
return Math.sqrt(this.dotprod(v, v));
};
/**
* Dot product of two vectors
* @instance rglwidgetClass
* @returns {number}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.dotprod = function(a, b) {
return a[0]*b[0] + a[1]*b[1] + a[2]*b[2];
};
/**
* Cross product of two vectors
* @returns {number[]}
* @param a {number[]}
* @param b {number[]}
*/
rglwidgetClass.prototype.xprod = function(a, b) {
return [a[1]*b[2] - a[2]*b[1],
a[2]*b[0] - a[0]*b[2],
a[0]*b[1] - a[1]*b[0]];
};
/**
* Bind vectors or matrices by columns
* @returns {number[][]}
* @param a {number[]|number[][]}
* @param b {number[]|number[][]}
*/
rglwidgetClass.prototype.cbind = function(a, b) {
if (b.length < a.length)
b = this.repeatToLen(b, a.length);
else if (a.length < b.length)
a = this.repeatToLen(a, b.length);
return a.map(function(currentValue, index, array) {
return currentValue.concat(b[index]);
});
};
/**
* Swap elements
* @returns {any[]}
* @param a {any[]}
* @param i {number} Element to swap
* @param j {number} Other element to swap
*/
rglwidgetClass.prototype.swap = function(a, i, j) {
var temp = a[i];
a[i] = a[j];
a[j] = temp;
};
/**
* Flatten a matrix into a vector
* @returns {any[]}
* @param a {any[][]}
*/
rglwidgetClass.prototype.flatten = function(arr, result) {
var value;
if (typeof result === "undefined") result = [];
for (var i = 0, length = arr.length; i < length; i++) {
value = arr[i];
if (Array.isArray(value)) {
this.flatten(value, result);
} else {
result.push(value);
}
}
return result;
};
/**
* set element of 1d or 2d array as if it was flattened.
* Column major, zero based!
* @returns {any[]|any[][]}
* @param {any[]|any[][]} a - array
* @param {number} i - element
* @param {any} value
*/
rglwidgetClass.prototype.setElement = function(a, i, value) {
if (Array.isArray(a[0])) {
var dim = a.length,
col = Math.floor(i/dim),
row = i % dim;
a[row][col] = value;
} else {
a[i] = value;
}
};
/**
* Transpose an array
* @returns {any[][]}
* @param {any[][]} a
*/
rglwidgetClass.prototype.transpose = function(a) {
var newArray = [],
n = a.length,
m = a[0].length,
i;
for(i = 0; i < m; i++){
newArray.push([]);
}
for(i = 0; i < n; i++){
for(var j = 0; j < m; j++){
newArray[j].push(a[i][j]);
}
}
return newArray;
};
/**
* Calculate sum of squares of a numeric vector
* @returns {number}
* @param {number[]} x
*/
rglwidgetClass.prototype.sumsq = function(x) {
var result = 0, i;
for (i=0; i < x.length; i++)
result += x[i]*x[i];
return result;
};
/**
* Convert a matrix to a CanvasMatrix4
* @returns {CanvasMatrix4}
* @param {number[][]|number[]} mat
*/
rglwidgetClass.prototype.toCanvasMatrix4 = function(mat) {
if (mat instanceof CanvasMatrix4)
return mat;
var result = new CanvasMatrix4();
mat = this.flatten(this.transpose(mat));
result.load(mat);
return result;
};
/**
* Convert an R-style numeric colour string to an rgb vector
* @returns {number[]}
* @param {string} s
*/
rglwidgetClass.prototype.stringToRgb = function(s) {
s = s.replace("#", "");
var bigint = parseInt(s, 16);
return [((bigint >> 16) & 255)/255,
((bigint >> 8) & 255)/255,
(bigint & 255)/255];
};
/**
* Take a component-by-component product of two 3 vectors
* @returns {number[]}
* @param {number[]} x
* @param {number[]} y
*/
rglwidgetClass.prototype.componentProduct = function(x, y) {
if (typeof y === "undefined") {
this.alertOnce("Bad arg to componentProduct");
}
var result = new Float32Array(3), i;
for (i = 0; i<3; i++)
result[i] = x[i]*y[i];
return result;
};
/**
* Get next higher power of two
* @returns { number }
* @param { number } value - input value
*/
rglwidgetClass.prototype.getPowerOfTwo = function(value) {
var pow = 1;
while(pow<value) {
pow *= 2;
}
return pow;
};
/**
* Unique entries
* @returns { any[] }
* @param { any[] } arr - An array
*/
rglwidgetClass.prototype.unique = function(arr) {
arr = [].concat(arr);
return arr.filter(function(value, index, self) {
return self.indexOf(value) === index;
});
};
/**
* Shallow compare of arrays
* @returns { boolean }
* @param { any[] } a - An array
* @param { any[] } b - Another array
*/
rglwidgetClass.prototype.equalArrays = function(a, b) {
return a === b || (a && b &&
a.length === b.length &&
a.every(function(v, i) {return v === b[i];}));
};
/**
* Repeat an array to a desired length
* @returns {any[]}
* @param {any | any[]} arr The input array
* @param {number} len The desired output length
*/
rglwidgetClass.prototype.repeatToLen = function(arr, len) {
arr = [].concat(arr);
while (arr.length < len/2)
arr = arr.concat(arr);
return arr.concat(arr.slice(0, len - arr.length));
};
/**
* Give a single alert message, not to be repeated.
* @param {string} msg  The message to give.
*/
rglwidgetClass.prototype.alertOnce = function(msg) {
if (typeof this.alerted !== "undefined")
return;
this.alerted = true;
alert(msg);
};
rglwidgetClass.prototype.f_is_lit = 1;
rglwidgetClass.prototype.f_is_smooth = 2;
rglwidgetClass.prototype.f_has_texture = 4;
rglwidgetClass.prototype.f_depth_sort = 8;
rglwidgetClass.prototype.f_fixed_quads = 16;
rglwidgetClass.prototype.f_is_transparent = 32;
rglwidgetClass.prototype.f_is_lines = 64;
rglwidgetClass.prototype.f_sprites_3d = 128;
rglwidgetClass.prototype.f_sprite_3d = 256;
rglwidgetClass.prototype.f_is_subscene = 512;
rglwidgetClass.prototype.f_is_clipplanes = 1024;
rglwidgetClass.prototype.f_fixed_size = 2048;
rglwidgetClass.prototype.f_is_points = 4096;
rglwidgetClass.prototype.f_is_twosided = 8192;
rglwidgetClass.prototype.f_fat_lines = 16384;
rglwidgetClass.prototype.f_is_brush = 32768;
/**
* Which list does a particular id come from?
* @returns { string }
* @param {number} id The id to look up.
*/
rglwidgetClass.prototype.whichList = function(id) {
var obj = this.getObj(id),
flags = obj.flags;
if (obj.type === "light")
return "lights";
if (flags & this.f_is_subscene)
return "subscenes";
if (flags & this.f_is_clipplanes)
return "clipplanes";
if (flags & this.f_is_transparent)
return "transparent";
return "opaque";
};
/**
* Get an object by id number.
* @returns { Object }
* @param {number} id
*/
rglwidgetClass.prototype.getObj = function(id) {
if (typeof id !== "number") {
this.alertOnce("getObj id is "+typeof id);
}
return this.scene.objects[id];
};
/**
* Get ids of a particular type from a subscene or the whole scene
* @returns { number[] }
* @param {string} type What type of object?
* @param {number} subscene  Which subscene?  If not given, find in the whole scene
*/
rglwidgetClass.prototype.getIdsByType = function(type, subscene) {
var
result = [], i, self = this;
if (typeof subscene === "undefined") {
Object.keys(this.scene.objects).forEach(
function(key) {
key = parseInt(key, 10);
if (self.getObj(key).type === type)
result.push(key);
});
} else {
ids = this.getObj(subscene).objects;
for (i=0; i < ids.length; i++) {
if (this.getObj(ids[i]).type === type) {
result.push(ids[i]);
}
}
}
return result;
};
/**
* Get a particular material property for an id
* @returns { any }
* @param {number} id  Which object?
* @param {string} property Which material property?
*/
rglwidgetClass.prototype.getMaterial = function(id, property) {
var obj = this.getObj(id), mat;
if (typeof obj.material === "undefined")
console.error("material undefined");
mat = obj.material[property];
if (typeof mat === "undefined")
mat = this.scene.material[property];
return mat;
};
/**
* Is a particular id in a subscene?
* @returns { boolean }
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.inSubscene = function(id, subscene) {
return this.getObj(subscene).objects.indexOf(id) > -1;
};
/**
* Add an id to a subscene.
* @param {number} id Which id?
* @param {number} subscene Which subscene id?
*/
rglwidgetClass.prototype.addToSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
ids = [id],
obj = this.getObj(id), i;
if (typeof obj != "undefined" && typeof (obj.newIds) !== "undefined") {
ids = ids.concat(obj.newIds);
}
thesub.objects = [].concat(thesub.objects);
for (i = 0; i < ids.length; i++) {
id = ids[i];
if (thesub.objects.indexOf(id) == -1) {
thelist = this.whichList(id);
thesub.objects.push(id);
thesub[thelist].push(id);
}
}
};
/**
* Delete an id from a subscene
* @param { number } id - the id to add
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.delFromSubscene = function(id, subscene) {
var thelist,
thesub = this.getObj(subscene),
obj = this.getObj(id),
ids = [id], i;
if (typeof obj !== "undefined" && typeof (obj.newIds) !== "undefined")
ids = ids.concat(obj.newIds);
thesub.objects = [].concat(thesub.objects); // It might be a scalar
for (j=0; j<ids.length;j++) {
id = ids[j];
i = thesub.objects.indexOf(id);
if (i > -1) {
thesub.objects.splice(i, 1);
thelist = this.whichList(id);
i = thesub[thelist].indexOf(id);
thesub[thelist].splice(i, 1);
}
}
};
/**
* Set the ids in a subscene
* @param { number[] } ids - the ids to set
* @param { number } subsceneid - the id of the subscene
*/
rglwidgetClass.prototype.setSubsceneEntries = function(ids, subsceneid) {
var sub = this.getObj(subsceneid);
sub.objects = ids;
this.initSubscene(subsceneid);
};
/**
* Get the ids in a subscene
* @returns {number[]}
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getSubsceneEntries = function(subscene) {
return this.getObj(subscene).objects;
};
/**
* Get the ids of the subscenes within a subscene
* @returns { number[] }
* @param { number } subscene - the id of the subscene
*/
rglwidgetClass.prototype.getChildSubscenes = function(subscene) {
return this.getObj(subscene).subscenes;
};
/**
* Start drawing
* @returns { boolean } Previous state
*/
rglwidgetClass.prototype.startDrawing = function() {
var value = this.drawing;
this.drawing = true;
return value;
};
/**
* Stop drawing and check for context loss
* @param { boolean } saved - Previous state
*/
rglwidgetClass.prototype.stopDrawing = function(saved) {
this.drawing = saved;
if (!saved && this.gl && this.gl.isContextLost())
this.restartCanvas();
};
/**
* Generate the vertex shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getVertexShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userVertexShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
nclipplanes = this.countClipplanes(),
fixed_size = flags & this.f_fixed_size,
is_points = flags & this.f_is_points,
is_twosided = flags & this.f_is_twosided,
fat_lines = flags & this.f_fat_lines,
is_brush = flags & this.f_is_brush,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
result = "  /* ****** "+type+" object "+id+" vertex shader ****** */\n"+
"  attribute vec3 aPos;\n"+
"  attribute vec4 aCol;\n"+
" uniform mat4 mvMatrix;\n"+
" uniform mat4 prMatrix;\n"+
" varying vec4 vCol;\n"+
" varying vec4 vPosition;\n";
if ((is_lit && !fixed_quads && !is_brush) || sprite_3d)
result = result + "  attribute vec3 aNorm;\n"+
" uniform mat4 normMatrix;\n"+
" varying vec3 vNormal;\n";
if (has_texture || type === "text")
result = result + " attribute vec2 aTexcoord;\n"+
" varying vec2 vTexcoord;\n";
if (fixed_size)
result = result + "  uniform vec2 textScale;\n";
if (fixed_quads)
result = result + "  attribute vec2 aOfs;\n";
else if (sprite_3d)
result = result + "  uniform vec3 uOrig;\n"+
"  uniform float uSize;\n"+
"  uniform mat4 usermat;\n";
if (is_twosided)
result = result + "  attribute vec3 aPos1;\n"+
"  attribute vec3 aPos2;\n"+
"  varying float normz;\n";
if (fat_lines) {
result = result +   "  attribute vec3 aNext;\n"+
"  attribute vec2 aPoint;\n"+
"  varying vec2 vPoint;\n"+
"  varying float vLength;\n"+
"  uniform float uAspect;\n"+
"  uniform float uLwd;\n";
}
result = result + "  void main(void) {\n";
if ((nclipplanes || (!fixed_quads && !sprite_3d)) && !is_brush)
result = result + "    vPosition = mvMatrix * vec4(aPos, 1.);\n";
if (!fixed_quads && !sprite_3d && !is_brush)
result = result + "    gl_Position = prMatrix * vPosition;\n";
if (is_points) {
var size = this.getMaterial(id, "size");
result = result + "    gl_PointSize = "+size.toFixed(1)+";\n";
}
result = result + "    vCol = aCol;\n";
if (is_lit && !fixed_quads && !sprite_3d && !is_brush)
result = result + "    vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n";
if (has_texture || type == "text")
result = result + "    vTexcoord = aTexcoord;\n";
if (fixed_size)
result = result + "    vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w;\n"+
"   gl_Position = pos + vec4(aOfs*textScale, 0.,0.);\n";
if (type == "sprites" && !fixed_size)
result = result + "    vec4 pos = mvMatrix * vec4(aPos, 1.);\n"+
"   pos = pos/pos.w + vec4(aOfs, 0., 0.);\n"+
"   gl_Position = prMatrix*pos;\n";
if (sprite_3d)
result = result + "   vNormal = normalize((normMatrix * vec4(aNorm, 1.)).xyz);\n"+
"   vec4 pos = mvMatrix * vec4(uOrig, 1.);\n"+
"   vPosition = pos/pos.w + vec4(uSize*(vec4(aPos, 1.)*usermat).xyz,0.);\n"+
"   gl_Position = prMatrix * vPosition;\n";
if (is_twosided)
result = result + "   vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n"+
"   pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n"+
"   vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n"+
"   pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n"+
"   normz = pos1.x*pos2.y - pos1.y*pos2.x;\n";
if (fat_lines) 
/* This code was inspired by Matt Deslauriers' code in https://mattdesl.svbtle.com/drawing-lines-is-hard */
result = result + "   vec2 aspectVec = vec2(uAspect, 1.0);\n"+
"   mat4 projViewModel = prMatrix * mvMatrix;\n"+
"   vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n"+
"   currentProjected = currentProjected/currentProjected.w;\n"+
"   vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n"+
"   vec2 currentScreen = currentProjected.xy * aspectVec;\n"+
"   vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n"+
"   float len = uLwd;\n"+
"   vec2 dir = vec2(1.0, 0.0);\n"+
"   vPoint = aPoint;\n"+
"   vLength = length(nextScreen - currentScreen)/2.0;\n"+
"   vLength = vLength/(vLength + len);\n"+
"   if (vLength > 0.0) {\n"+
"     dir = normalize(nextScreen - currentScreen);\n"+
"   }\n"+
"   vec2 normal = vec2(-dir.y, dir.x);\n"+
"   dir.x /= uAspect;\n"+
"   normal.x /= uAspect;\n"+
"   vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n"+
"   gl_Position = currentProjected + offset;\n";
if (is_brush)
result = result + "   gl_Position = vec4(aPos, 1.);\n";
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Generate the fragment shader for an object
* @returns {string}
* @param { number } id - Id of object
*/
rglwidgetClass.prototype.getFragmentShader = function(id) {
var obj = this.getObj(id),
userShader = obj.userFragmentShader,
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
sprites_3d = flags & this.f_sprites_3d,
is_twosided = (flags & this.f_is_twosided) > 0,
fat_lines = flags & this.f_fat_lines,
is_transparent = flags & this.f_is_transparent,
nclipplanes = this.countClipplanes(), i,
texture_format, nlights,
result;
if (type === "clipplanes" || sprites_3d) return;
if (typeof userShader !== "undefined") return userShader;
if (has_texture)
texture_format = this.getMaterial(id, "textype");
result = "/* ****** "+type+" object "+id+" fragment shader ****** */\n"+
"#ifdef GL_ES\n"+
"#ifdef GL_FRAGMENT_PRECISION_HIGH\n"+
"  precision highp float;\n"+
"#else\n"+
"  precision mediump float;\n"+
"#endif\n"+
"#endif\n"+
"  varying vec4 vCol; // carries alpha\n"+
"  varying vec4 vPosition;\n";
if (has_texture || type === "text")
result = result + "  varying vec2 vTexcoord;\n"+
" uniform sampler2D uSampler;\n";
if (is_lit && !fixed_quads)
result = result + "  varying vec3 vNormal;\n";
for (i = 0; i < nclipplanes; i++)
result = result + "  uniform vec4 vClipplane"+i+";\n";
if (is_lit) {
nlights = this.countLights();
if (nlights)
result = result + "  uniform mat4 mvMatrix;\n";
else
is_lit = false;
}
if (is_lit) {
result = result + "   uniform vec3 emission;\n"+
"   uniform float shininess;\n";
for (i=0; i < nlights; i++) {
result = result + "   uniform vec3 ambient" + i + ";\n"+
"   uniform vec3 specular" + i +"; // light*material\n"+
"   uniform vec3 diffuse" + i + ";\n"+
"   uniform vec3 lightDir" + i + ";\n"+
"   uniform bool viewpoint" + i + ";\n"+
"   uniform bool finite" + i + ";\n";
}
}
if (is_twosided)
result = result + "   uniform bool front;\n"+
"   varying float normz;\n";
if (fat_lines)
result = result + "   varying vec2 vPoint;\n"+
"   varying float vLength;\n";
result = result + "  void main(void) {\n";
if (fat_lines) {
result = result + "    vec2 point = vPoint;\n"+
"    bool neg = point.y < 0.0;\n"+
"    point.y = neg ? "+
"      (point.y + vLength)/(1.0 - vLength) :\n"+
"     -(point.y - vLength)/(1.0 - vLength);\n";
if (is_transparent && type == "linestrip")
result = result+"    if (neg && length(point) <= 1.0) discard;\n";
result = result + "    point.y = min(point.y, 0.0);\n"+
"    if (length(point) > 1.0) discard;\n";
}
for (i=0; i < nclipplanes;i++)
result = result + "    if (dot(vPosition, vClipplane"+i+") < 0.0) discard;\n";
if (fixed_quads) {
result = result +   "    vec3 n = vec3(0., 0., 1.);\n";
} else if (is_lit) {
result = result +   "    vec3 n = normalize(vNormal);\n";
}
if (is_twosided) {
result = result +   "    if ((normz <= 0.) != front) discard;\n";
}
if (is_lit) {
result = result + "    vec3 eye = normalize(-vPosition.xyz);\n"+
"   vec3 lightdir;\n"+
"   vec4 colDiff;\n"+
"   vec3 halfVec;\n"+
"   vec4 lighteffect = vec4(emission, 0.);\n"+
"   vec3 col;\n"+
"   float nDotL;\n";
if (!fixed_quads) {
result = result +   "   n = -faceforward(n, n, eye);\n";
}
for (i=0; i < nlights; i++) {
result = result + "   colDiff = vec4(vCol.rgb * diffuse" + i + ", vCol.a);\n"+
"   lightdir = lightDir" + i + ";\n"+
"   if (!viewpoint" + i +")\n"+
"     lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n"+
"   if (!finite" + i + ") {\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   } else {\n"+
"     lightdir = normalize(lightdir - vPosition.xyz);\n"+
"     halfVec = normalize(lightdir + eye);\n"+
"   }\n"+
"    col = ambient" + i + ";\n"+
"   nDotL = dot(n, lightdir);\n"+
"   col = col + max(nDotL, 0.) * colDiff.rgb;\n"+
"   col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular" + i + ";\n"+
"   lighteffect = lighteffect + vec4(col, colDiff.a);\n";
}
} else {
result = result +   "   vec4 colDiff = vCol;\n"+
"    vec4 lighteffect = colDiff;\n";
}
if (type === "text")
result = result +   "    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n";
if (has_texture) {
result = result + {
rgb:            "   vec4 textureColor = lighteffect*vec4(texture2D(uSampler, vTexcoord).rgb, 1.);\n",
rgba:           "   vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n",
alpha:          "   vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.), textureColor.rgb)/3.;\n"+
"   textureColor =  vec4(lighteffect.rgb, lighteffect.a*luminance);\n",
luminance:      "   vec4 textureColor = vec4(lighteffect.rgb*dot(texture2D(uSampler, vTexcoord).rgb, vec3(1.,1.,1.))/3., lighteffect.a);\n",
"luminance.alpha":"    vec4 textureColor = texture2D(uSampler, vTexcoord);\n"+
"   float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n"+
"   textureColor = vec4(lighteffect.rgb*luminance, lighteffect.a*textureColor.a);\n"
}[texture_format]+
"   gl_FragColor = textureColor;\n";
} else if (type === "text") {
result = result +   "    if (textureColor.a < 0.1)\n"+
"     discard;\n"+
"   else\n"+
"     gl_FragColor = textureColor;\n";
} else
result = result +   "   gl_FragColor = lighteffect;\n";
//if (fat_lines)
//  result = result +   "   gl_FragColor = vec4(0.0, abs(point.x), abs(point.y), 1.0);"
result = result + "  }\n";
// console.log(result);
return result;
};
/**
* Call gl functions to create and compile shader
* @returns {Object}
* @param { number } shaderType - gl code for shader type
* @param { string } code - code for the shader
*/
rglwidgetClass.prototype.getShader = function(shaderType, code) {
var gl = this.gl, shader;
shader = gl.createShader(shaderType);
gl.shaderSource(shader, code);
gl.compileShader(shader);
if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS) && !gl.isContextLost())
alert(gl.getShaderInfoLog(shader));
return shader;
};
/**
* Handle a texture after its image has been loaded
* @param { Object } texture - the gl texture object
* @param { Object } textureCanvas - the canvas holding the image
*/
rglwidgetClass.prototype.handleLoadedTexture = function(texture, textureCanvas) {
var gl = this.gl || this.initGL();
gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, true);
gl.bindTexture(gl.TEXTURE_2D, texture);
gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);
gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_NEAREST);
gl.generateMipmap(gl.TEXTURE_2D);
gl.bindTexture(gl.TEXTURE_2D, null);
};
/**
* Get maximum dimension of texture in current browser.
* @returns {number}
*/
rglwidgetClass.prototype.getMaxTexSize = function() {
var gl = this.gl || this.initGL();  
return Math.min(4096, gl.getParameter(gl.MAX_TEXTURE_SIZE));
};
/**
* Load an image to a texture
* @param { string } uri - The image location
* @param { Object } texture - the gl texture object
*/
rglwidgetClass.prototype.loadImageToTexture = function(uri, texture) {
var canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
image = new Image(),
self = this;
image.onload = function() {
var w = image.width,
h = image.height,
canvasX = self.getPowerOfTwo(w),
canvasY = self.getPowerOfTwo(h),
gl = self.gl || self.initGL(),
maxTexSize = self.getMaxTexSize();
while (canvasX > 1 && canvasY > 1 && (canvasX > maxTexSize || canvasY > maxTexSize)) {
canvasX /= 2;
canvasY /= 2;
}
canvas.width = canvasX;
canvas.height = canvasY;
ctx.imageSmoothingEnabled = true;
ctx.drawImage(image, 0, 0, canvasX, canvasY);
self.handleLoadedTexture(texture, canvas);
self.drawScene();
};
image.src = uri;
};
/**
* Draw text to the texture canvas
* @returns { Object } object with text measurements
* @param { string } text - the text
* @param { number } cex - expansion
* @param { string } family - font family
* @param { number } font - font number
*/
rglwidgetClass.prototype.drawTextToCanvas = function(text, cex, family, font) {
var canvasX, canvasY,
textY,
scaling = 20,
textColour = "white",
backgroundColour = "rgba(0,0,0,0)",
canvas = this.textureCanvas,
ctx = canvas.getContext("2d"),
i, textHeight = 0, textHeights = [], width, widths = [], 
offsetx, offsety = 0, line, lines = [], offsetsx = [],
offsetsy = [], lineoffsetsy = [], fontStrings = [],
maxTexSize = this.getMaxTexSize(),
getFontString = function(i) {
textHeights[i] = scaling*cex[i];
var fontString = textHeights[i] + "px",
family0 = family[i],
font0 = font[i];
if (family0 === "sans")
family0 = "sans-serif";
else if (family0 === "mono")
family0 = "monospace";
fontString = fontString + " " + family0;
if (font0 === 2 || font0 === 4)
fontString = "bold " + fontString;
if (font0 === 3 || font0 === 4)
fontString = "italic " + fontString;
return fontString;
};
cex = this.repeatToLen(cex, text.length);
family = this.repeatToLen(family, text.length);
font = this.repeatToLen(font, text.length);
canvasX = 1;
line = -1;
offsetx = maxTexSize;
for (i = 0; i < text.length; i++)  {
ctx.font = fontStrings[i] = getFontString(i);
width = widths[i] = ctx.measureText(text[i]).width;
if (offsetx + width > maxTexSize) {
line += 1;
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
if (offsety > maxTexSize)
console.error("Too many strings for texture.");
textHeight = 0;
offsetx = 0;
}
textHeight = Math.max(textHeight, textHeights[i]);
offsetsx[i] = offsetx;
offsetx += width;
canvasX = Math.max(canvasX, offsetx);
lines[i] = line;
}
offsety = lineoffsetsy[line] = offsety + 2*textHeight;
for (i = 0; i < text.length; i++) {
offsetsy[i] = lineoffsetsy[lines[i]];
}
canvasX = this.getPowerOfTwo(canvasX);
canvasY = this.getPowerOfTwo(offsety);
canvas.width = canvasX;
canvas.height = canvasY;
ctx.fillStyle = backgroundColour;
ctx.fillRect(0, 0, ctx.canvas.width, ctx.canvas.height);
ctx.textBaseline = "alphabetic";
for(i = 0; i < text.length; i++) {
ctx.font = fontStrings[i];
ctx.fillStyle = textColour;
ctx.textAlign = "left";
ctx.fillText(text[i], offsetsx[i],  offsetsy[i]);
}
return {canvasX:canvasX, canvasY:canvasY,
widths:widths, textHeights:textHeights,
offsetsx:offsetsx, offsetsy:offsetsy};
};
/**
* Set the gl viewport and scissor test
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setViewport = function(id) {
var gl = this.gl || this.initGL(),
vp = this.getObj(id).par3d.viewport,
x = vp.x*this.canvas.width,
y = vp.y*this.canvas.height,
width = vp.width*this.canvas.width,
height = vp.height*this.canvas.height;
this.vp = {x:x, y:y, width:width, height:height};
gl.viewport(x, y, width, height);
gl.scissor(x, y, width, height);
gl.enable(gl.SCISSOR_TEST);
};
/**
* Set the projection matrix for a subscene
* @param { number } id - id of subscene
*/
rglwidgetClass.prototype.setprMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.projection;
if (embedding === "replace")
this.prMatrix.makeIdentity();
else
this.setprMatrix(subscene.parent);
if (embedding === "inherit")
return;
// This is based on the Frustum::enclose code from geom.cpp
var bbox = subscene.par3d.bbox,
scale = subscene.par3d.scale,
ranges = [(bbox[1]-bbox[0])*scale[0]/2,
(bbox[3]-bbox[2])*scale[1]/2,
(bbox[5]-bbox[4])*scale[2]/2],
radius = Math.sqrt(this.sumsq(ranges))*1.1; // A bit bigger to handle labels
if (radius <= 0) radius = 1;
var observer = subscene.par3d.observer,
distance = observer[2],
FOV = subscene.par3d.FOV, ortho = FOV === 0,
t = ortho ? 1 : Math.tan(FOV*Math.PI/360),
near = distance - radius,
far = distance + radius,
hlen,
aspect = this.vp.width/this.vp.height,
z = subscene.par3d.zoom,
userProjection = subscene.par3d.userProjection;
if (far < 0.0)
far = 1.0;
if (near < far/100.0)
near = far/100.0;
hlen = t*near;
if (ortho) {
if (aspect > 1)
this.prMatrix.ortho(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.ortho(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
} else {
if (aspect > 1)
this.prMatrix.frustum(-hlen*aspect*z, hlen*aspect*z,
-hlen*z, hlen*z, near, far);
else
this.prMatrix.frustum(-hlen*z, hlen*z,
-hlen*z/aspect, hlen*z/aspect,
near, far);
}
this.prMatrix.multRight(userProjection);
};
/**
* Set the model-view matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmvMatrix = function(id) {
var observer = this.getObj(id).par3d.observer;
this.mvMatrix.makeIdentity();
this.setmodelMatrix(id);
this.mvMatrix.translate(-observer[0], -observer[1], -observer[2]);
};
/**
* Set the model matrix for a subscene
* @param { number } id - id of the subscene
*/
rglwidgetClass.prototype.setmodelMatrix = function(id) {
var subscene = this.getObj(id),
embedding = subscene.embeddings.model;
if (embedding !== "inherit") {
var scale = subscene.par3d.scale,
bbox = subscene.par3d.bbox,
center = [(bbox[0]+bbox[1])/2,
(bbox[2]+bbox[3])/2,
(bbox[4]+bbox[5])/2];
this.mvMatrix.translate(-center[0], -center[1], -center[2]);
this.mvMatrix.scale(scale[0], scale[1], scale[2]);
this.mvMatrix.multRight( subscene.par3d.userMatrix );
}
if (embedding !== "replace")
this.setmodelMatrix(subscene.parent);
};
/**
* Set the normals matrix for a subscene
* @param { number } subsceneid - id of the subscene
*/
rglwidgetClass.prototype.setnormMatrix = function(subsceneid) {
var self = this,
recurse = function(id) {
var sub = self.getObj(id),
embedding = sub.embeddings.model;
if (embedding !== "inherit") {
var scale = sub.par3d.scale;
self.normMatrix.scale(1/scale[0], 1/scale[1], 1/scale[2]);
self.normMatrix.multRight(sub.par3d.userMatrix);
}
if (embedding !== "replace")
recurse(sub.parent);
};
self.normMatrix.makeIdentity();
recurse(subsceneid);
};
/**
* Set the combined projection-model-view matrix
*/
rglwidgetClass.prototype.setprmvMatrix = function() {
this.prmvMatrix = new CanvasMatrix4( this.mvMatrix );
this.prmvMatrix.multRight( this.prMatrix );
};
/**
* Count clipping planes in a scene
* @returns {number}
*/
rglwidgetClass.prototype.countClipplanes = function() {
return this.countObjs("clipplanes");
};
/**
* Count lights in a scene
* @returns { number }
*/
rglwidgetClass.prototype.countLights = function() {
return this.countObjs("light");
};
/**
* Count objects of specific type in a scene
* @returns { number }
* @param { string } type - Type of object to count
*/
rglwidgetClass.prototype.countObjs = function(type) {
var self = this,
bound = 0;
Object.keys(this.scene.objects).forEach(
function(key) {
if (self.getObj(parseInt(key, 10)).type === type)
bound = bound + 1;
});
return bound;
};
/**
* Initialize a subscene
* @param { number } id - id of subscene.
*/
rglwidgetClass.prototype.initSubscene = function(id) {
var sub = this.getObj(id),
i, obj;
if (sub.type !== "subscene")
return;
sub.par3d.userMatrix = this.toCanvasMatrix4(sub.par3d.userMatrix);
sub.par3d.userProjection = this.toCanvasMatrix4(sub.par3d.userProjection);
sub.par3d.userProjection.transpose();
sub.par3d.listeners = [].concat(sub.par3d.listeners);
sub.backgroundId = undefined;
sub.subscenes = [];
sub.clipplanes = [];
sub.transparent = [];
sub.opaque = [];
sub.lights = [];
for (i=0; i < sub.objects.length; i++) {
obj = this.getObj(sub.objects[i]);
if (typeof obj === "undefined") {
sub.objects.splice(i, 1);
i--;
} else if (obj.type === "background")
sub.backgroundId = obj.id;
else
sub[this.whichList(obj.id)].push(obj.id);
}
};
/**
* Copy object
* @param { number } id - id of object to copy
* @param { string } reuse - Document id of scene to reuse
*/
rglwidgetClass.prototype.copyObj = function(id, reuse) {
var obj = this.getObj(id),
prev = document.getElementById(reuse);
if (prev !== null) {
prev = prev.rglinstance;
var
prevobj = prev.getObj(id),
fields = ["flags", "type",
"colors", "vertices", "centers",
"normals", "offsets",
"texts", "cex", "family", "font", "adj",
"material",
"radii",
"texcoords",
"userMatrix", "ids",
"dim",
"par3d", "userMatrix",
"viewpoint", "finite",
"pos"],
i;
for (i = 0; i < fields.length; i++) {
if (typeof prevobj[fields[i]] !== "undefined")
obj[fields[i]] = prevobj[fields[i]];
}
} else
console.warn("copyObj failed");
};
/**
* Update the triangles used to display a plane
* @param { number } id - id of the plane
* @param { Object } bbox - bounding box in which to display the plane
*/
rglwidgetClass.prototype.planeUpdateTriangles = function(id, bbox) {
var perms = [[0,0,1], [1,2,2], [2,1,0]],
x, xrow, elem, A, d, nhits, i, j, k, u, v, w, intersect, which, v0, v2, vx, reverse,
face1 = [], face2 = [], normals = [],
obj = this.getObj(id),
nPlanes = obj.normals.length;
obj.bbox = bbox;
obj.vertices = [];
obj.initialized = false;
for (elem = 0; elem < nPlanes; elem++) {
//    Vertex Av = normal.getRecycled(elem);
x = [];
A = obj.normals[elem];
d = obj.offsets[elem][0];
nhits = 0;
for (i=0; i<3; i++)
for (j=0; j<2; j++)
for (k=0; k<2; k++) {
u = perms[0][i];
v = perms[1][i];
w = perms[2][i];
if (A[w] !== 0.0) {
intersect = -(d + A[u]*bbox[j+2*u] + A[v]*bbox[k+2*v])/A[w];
if (bbox[2*w] < intersect && intersect < bbox[1+2*w]) {
xrow = [];
xrow[u] = bbox[j+2*u];
xrow[v] = bbox[k+2*v];
xrow[w] = intersect;
x.push(xrow);
face1[nhits] = j + 2*u;
face2[nhits] = k + 2*v;
nhits++;
}
}
}
if (nhits > 3) {
/* Re-order the intersections so the triangles work */
for (i=0; i<nhits-2; i++) {
which = 0; /* initialize to suppress warning */
for (j=i+1; j<nhits; j++) {
if (face1[i] == face1[j] || face1[i] == face2[j] ||
face2[i] == face1[j] || face2[i] == face2[j] ) {
which = j;
break;
}
}
if (which > i+1) {
this.swap(x, i+1, which);
this.swap(face1, i+1, which);
this.swap(face2, i+1, which);
}
}
}
if (nhits >= 3) {
/* Put in order so that the normal points out the FRONT of the faces */
v0 = [x[0][0] - x[1][0] , x[0][1] - x[1][1], x[0][2] - x[1][2]];
v2 = [x[2][0] - x[1][0] , x[2][1] - x[1][1], x[2][2] - x[1][2]];
/* cross-product */
vx = this.xprod(v0, v2);
reverse = this.dotprod(vx, A) > 0;
for (i=0; i<nhits-2; i++) {
obj.vertices.push(x[0]);
normals.push(A);
for (j=1; j<3; j++) {
obj.vertices.push(x[i + (reverse ? 3-j : j)]);
normals.push(A);
}
}
}
}
obj.pnormals = normals;
};
rglwidgetClass.prototype.getAdj = function (pos, offset, text) {
switch(pos) {
case 1: return [0.5, 1 + offset];
case 2: return [1 + offset/text.length, 0.5];
case 3: return [0.5, -offset];
case 4: return [-offset/text.length, 0.5];
}
}
/**
* Initialize object for display
* @param { number } id - id of object to initialize
*/
rglwidgetClass.prototype.initObj = function(id) {
var obj = this.getObj(id),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = obj.is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
is_brush = flags & this.f_is_brush,
gl = this.gl || this.initGL(),
polygon_offset,
texinfo, drawtype, nclipplanes, f, nrows, oldrows,
i,j,v,v1,v2, mat, uri, matobj, pass, passes, pmode,
dim, nx, nz, attr;
if (typeof id !== "number") {
this.alertOnce("initObj id is "+typeof id);
}
obj.initialized = true;
if (type === "bboxdeco" || type === "subscene")
return;
if (type === "light") {
obj.ambient = new Float32Array(obj.colors[0].slice(0,3));
obj.diffuse = new Float32Array(obj.colors[1].slice(0,3));
obj.specular = new Float32Array(obj.colors[2].slice(0,3));
obj.lightDir = new Float32Array(obj.vertices[0]);
return;
}
if (type === "clipplanes") {
obj.vClipplane = this.flatten(this.cbind(obj.normals, obj.offsets));
return;
}
if (type === "background" && typeof obj.ids !== "undefined") {
obj.quad = this.flatten([].concat(obj.ids));
return;
}
polygon_offset = this.getMaterial(id, "polygon_offset");
if (polygon_offset[0] != 0 || polygon_offset[1] != 0)
obj.polygon_offset = polygon_offset;
if (is_transparent) {
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}
if (is_brush)
this.initSelection(id);
if (typeof obj.vertices === "undefined")
obj.vertices = [];
v = obj.vertices;
obj.vertexCount = v.length;
if (!obj.vertexCount) return;
if (is_twosided) {
if (typeof obj.userAttributes === "undefined")
obj.userAttributes = {};
v1 = Array(v.length);
v2 = Array(v.length);
if (obj.type == "triangles" || obj.type == "quads") {
if (obj.type == "triangles")
nrow = 3;
else
nrow = 4;
for (i=0; i<Math.floor(v.length/nrow); i++)
for (j=0; j<nrow; j++) {
v1[nrow*i + j] = v[nrow*i + ((j+1) % nrow)];
v2[nrow*i + j] = v[nrow*i + ((j+2) % nrow)];
}
} else if (obj.type == "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz && j+1 < nx) {
v2[j + nx*i] = v[j + nx*(i+1)];
v1[j + nx*i] = v[j+1 + nx*(i+1)];
} else if (i+1 < nz) {
v2[j + nx*i] = v[j-1 + nx*i];
v1[j + nx*i] = v[j + nx*(i+1)];
} else {
v2[j + nx*i] = v[j + nx*(i-1)];
v1[j + nx*i] = v[j-1 + nx*(i-1)];
}
}
}
}
obj.userAttributes.aPos1 = v1;
obj.userAttributes.aPos2 = v2;
}
if (!sprites_3d) {
if (gl.isContextLost()) return;
obj.prog = gl.createProgram();
gl.attachShader(obj.prog, this.getShader( gl.VERTEX_SHADER,
this.getVertexShader(id) ));
gl.attachShader(obj.prog, this.getShader( gl.FRAGMENT_SHADER,
this.getFragmentShader(id) ));
//  Force aPos to location 0, aCol to location 1
gl.bindAttribLocation(obj.prog, 0, "aPos");
gl.bindAttribLocation(obj.prog, 1, "aCol");
gl.linkProgram(obj.prog);
var linked = gl.getProgramParameter(obj.prog, gl.LINK_STATUS);
if (!linked) {
// An error occurred while linking
var lastError = gl.getProgramInfoLog(obj.prog);
console.warn("Error in program linking:" + lastError);
gl.deleteProgram(obj.prog);
return;
}
}
if (type === "text") {
texinfo = this.drawTextToCanvas(obj.texts,
this.flatten(obj.cex),
this.flatten(obj.family),
this.flatten(obj.family));
}
if (fixed_quads && !sprites_3d) {
obj.ofsLoc = gl.getAttribLocation(obj.prog, "aOfs");
}
if (sprite_3d) {
obj.origLoc = gl.getUniformLocation(obj.prog, "uOrig");
obj.sizeLoc = gl.getUniformLocation(obj.prog, "uSize");
obj.usermatLoc = gl.getUniformLocation(obj.prog, "usermat");
}
if (has_texture || type == "text") {
if (!obj.texture)
obj.texture = gl.createTexture();
obj.texLoc = gl.getAttribLocation(obj.prog, "aTexcoord");
obj.sampler = gl.getUniformLocation(obj.prog, "uSampler");
}
if (has_texture) {
mat = obj.material;
if (typeof mat.uri !== "undefined")
uri = mat.uri;
else if (typeof mat.uriElementId === "undefined") {
matobj = this.getObj(mat.uriId);
if (typeof matobj !== "undefined") {
uri = matobj.material.uri;
} else {
uri = "";
}
} else
uri = document.getElementById(mat.uriElementId).rglinstance.getObj(mat.uriId).material.uri;
this.loadImageToTexture(uri, obj.texture);
}
if (type === "text") {
this.handleLoadedTexture(obj.texture, this.textureCanvas);
}
var stride = 3, nc, cofs, nofs, radofs, oofs, tofs, vnew, fnew,
nextofs = -1, pointofs = -1, alias, colors, key, selection, filter, adj, pos, offset;
obj.alias = undefined;
colors = obj.colors;
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
key = this.scene.crosstalk.key[j];
options = this.scene.crosstalk.options[j];
colors = colors.slice(0); 
for (i = 0; i < v.length; i++)
colors[i] = obj.colors[i % obj.colors.length].slice(0);
if ( (selection = this.scene.crosstalk.selection) &&
(selection.length || !options.selectedIgnoreNone) )
for (i = 0; i < v.length; i++) {
if (!selection.includes(key[i])) {
if (options.deselectedColor)
colors[i] = options.deselectedColor.slice(0);
colors[i][3] = colors[i][3]*options.deselectedFade;   /* default: mostly transparent if not selected */
} else if (options.selectedColor)
colors[i] = options.selectedColor.slice(0);
}
if ( (filter = this.scene.crosstalk.filter) )
for (i = 0; i < v.length; i++) 
if (!filter.includes(key[i])) {
if (options.filteredColor)
colors[i] = options.filteredColor.slice(0);
colors[i][3] = colors[i][3]*options.filteredFade;   /* default: completely hidden if filtered */
}
}  
nc = obj.colorCount = colors.length;
if (nc > 1) {
cofs = stride;
stride = stride + 4;
v = this.cbind(v, colors);
} else {
cofs = -1;
obj.onecolor = this.flatten(colors);
}
if (typeof obj.normals !== "undefined") {
nofs = stride;
stride = stride + 3;
v = this.cbind(v, typeof obj.pnormals !== "undefined" ? obj.pnormals : obj.normals);
} else
nofs = -1;
if (typeof obj.radii !== "undefined") {
radofs = stride;
stride = stride + 1;
// FIXME:  always concat the radii?
if (obj.radii.length === v.length) {
v = this.cbind(v, obj.radii);
} else if (obj.radii.length === 1) {
v = v.map(function(row, i, arr) { return row.concat(obj.radii[0]);});
}
} else
radofs = -1;
// Add default indices
f = Array(v.length);
for (i = 0; i < v.length; i++)
f[i] = i;
obj.f = [f,f];
if (type == "sprites" && !sprites_3d) {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
fnew = new Array(4*v.length);
alias = new Array(v.length);
var rescale = fixed_size ? 72 : 1,
size = obj.radii, s = rescale*size[0]/2;
last = v.length;
f = obj.f[0];
for (i=0; i < v.length; i++) {
if (size.length > 1)
s = rescale*size[i]/2;
vnew[i]  = v[i].concat([0,0,-s,-s]);
fnew[4*i] = f[i];
vnew[last]= v[i].concat([1,0, s,-s]);
fnew[4*i+1] = last++;
vnew[last]= v[i].concat([1,1, s, s]);
fnew[4*i+2] = last++;
vnew[last]= v[i].concat([0,1,-s, s]);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (type === "text") {
tofs = stride;
stride += 2;
oofs = stride;
stride += 2;
vnew = new Array(4*v.length);
f = obj.f[0];
fnew = new Array(4*f.length);
alias = new Array(v.length);
last = v.length;
adj = this.flatten(obj.adj);
if (typeof obj.pos !== "undefined") {
pos = this.flatten(obj.pos);
offset = adj[0];
}
for (i=0; i < v.length; i++) {
if (typeof pos !== "undefined")
adj = this.getAdj(pos[i % pos.length], offset, obj.texts[i]);
vnew[i]  = v[i].concat([0,-0.5]).concat(adj);
fnew[4*i] = f[i];
vnew[last] = v[i].concat([1,-0.5]).concat(adj);
fnew[4*i+1] = last++;
vnew[last] = v[i].concat([1, 1.5]).concat(adj);
fnew[4*i+2] = last++;
vnew[last] = v[i].concat([0, 1.5]).concat(adj);
fnew[4*i+3] = last++;
alias[i] = [last-3, last-2, last-1];
for (j=0; j < 4; j++) {
v1 = vnew[fnew[4*i+j]];
v1[tofs+2] = 2*(v1[tofs]-v1[tofs+2])*texinfo.widths[i];
v1[tofs+3] = 2*(v1[tofs+1]-v1[tofs+3])*texinfo.textHeights[i];
v1[tofs] = (texinfo.offsetsx[i] + v1[tofs]*texinfo.widths[i])/texinfo.canvasX;
v1[tofs+1] = 1.0-(texinfo.offsetsy[i] -
v1[tofs+1]*texinfo.textHeights[i])/texinfo.canvasY;
vnew[fnew[4*i+j]] = v1;
}
}
v = vnew;
obj.vertexCount = v.length;
obj.f = [fnew, fnew];
} else if (typeof obj.texcoords !== "undefined") {
tofs = stride;
stride += 2;
oofs = -1;
v = this.cbind(v, obj.texcoords);
} else {
tofs = -1;
oofs = -1;
}
obj.alias = alias;
if (typeof obj.userAttributes !== "undefined") {
obj.userAttribOffsets = {};
obj.userAttribLocations = {};
obj.userAttribSizes = {};
for (attr in obj.userAttributes) {
obj.userAttribLocations[attr] = gl.getAttribLocation(obj.prog, attr);
if (obj.userAttribLocations[attr] >= 0) { // Attribute may not have been used
obj.userAttribOffsets[attr] = stride;
v = this.cbind(v, obj.userAttributes[attr]);
stride = v[0].length;
obj.userAttribSizes[attr] = stride - obj.userAttribOffsets[attr];
}
}
}
if (typeof obj.userUniforms !== "undefined") {
obj.userUniformLocations = {};
for (attr in obj.userUniforms)
obj.userUniformLocations[attr] = gl.getUniformLocation(obj.prog, attr);
}
if (sprites_3d) {
obj.userMatrix = new CanvasMatrix4(obj.userMatrix);
obj.objects = this.flatten([].concat(obj.ids));
is_lit = false;
for (i=0; i < obj.objects.length; i++)
this.initObj(obj.objects[i]);
}
if (is_lit && !fixed_quads) {
obj.normLoc = gl.getAttribLocation(obj.prog, "aNorm");
}
nclipplanes = this.countClipplanes();
if (nclipplanes && !sprites_3d) {
obj.clipLoc = [];
for (i=0; i < nclipplanes; i++)
obj.clipLoc[i] = gl.getUniformLocation(obj.prog,"vClipplane" + i);
}
if (is_lit) {
obj.emissionLoc = gl.getUniformLocation(obj.prog, "emission");
obj.emission = new Float32Array(this.stringToRgb(this.getMaterial(id, "emission")));
obj.shininessLoc = gl.getUniformLocation(obj.prog, "shininess");
obj.shininess = this.getMaterial(id, "shininess");
obj.nlights = this.countLights();
obj.ambientLoc = [];
obj.ambient = new Float32Array(this.stringToRgb(this.getMaterial(id, "ambient")));
obj.specularLoc = [];
obj.specular = new Float32Array(this.stringToRgb(this.getMaterial(id, "specular")));
obj.diffuseLoc = [];
obj.lightDirLoc = [];
obj.viewpointLoc = [];
obj.finiteLoc = [];
for (i=0; i < obj.nlights; i++) {
obj.ambientLoc[i] = gl.getUniformLocation(obj.prog, "ambient" + i);
obj.specularLoc[i] = gl.getUniformLocation(obj.prog, "specular" + i);
obj.diffuseLoc[i] = gl.getUniformLocation(obj.prog, "diffuse" + i);
obj.lightDirLoc[i] = gl.getUniformLocation(obj.prog, "lightDir" + i);
obj.viewpointLoc[i] = gl.getUniformLocation(obj.prog, "viewpoint" + i);
obj.finiteLoc[i] = gl.getUniformLocation(obj.prog, "finite" + i);
}
}
obj.passes = is_twosided + 1;
obj.pmode = new Array(obj.passes);
for (pass = 0; pass < obj.passes; pass++) {
if (type === "triangles" || type === "quads" || type === "surface")
pmode = this.getMaterial(id, (pass === 0) ? "front" : "back");
else pmode = "filled";
obj.pmode[pass] = pmode;
}
obj.f.length = obj.passes;
for (pass = 0; pass < obj.passes; pass++) {
f = fnew = obj.f[pass];
pmode = obj.pmode[pass];
if (pmode === "culled")
f = [];
else if (pmode === "points") {
// stay with default
} else if ((type === "quads" || type === "text" ||
type === "sprites") && !sprites_3d) {
nrows = Math.floor(obj.vertexCount/4);
if (pmode === "filled") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[4*i];
fnew[6*i+1] = f[4*i + 1];
fnew[6*i+2] = f[4*i + 2];
fnew[6*i+3] = f[4*i];
fnew[6*i+4] = f[4*i + 2];
fnew[6*i+5] = f[4*i + 3];
}
} else {
fnew = Array(8*nrows);
for (i=0; i < nrows; i++) {
fnew[8*i] = f[4*i];
fnew[8*i+1] = f[4*i + 1];
fnew[8*i+2] = f[4*i + 1];
fnew[8*i+3] = f[4*i + 2];
fnew[8*i+4] = f[4*i + 2];
fnew[8*i+5] = f[4*i + 3];
fnew[8*i+6] = f[4*i + 3];
fnew[8*i+7] = f[4*i];
}
}
} else if (type === "triangles") {
nrows = Math.floor(obj.vertexCount/3);
if (pmode === "filled") {
fnew = Array(3*nrows);
for (i=0; i < fnew.length; i++) {
fnew[i] = f[i];
}
} else if (pmode === "lines") {
fnew = Array(6*nrows);
for (i=0; i < nrows; i++) {
fnew[6*i] = f[3*i];
fnew[6*i + 1] = f[3*i + 1];
fnew[6*i + 2] = f[3*i + 1];
fnew[6*i + 3] = f[3*i + 2];
fnew[6*i + 4] = f[3*i + 2];
fnew[6*i + 5] = f[3*i];
}
}
} else if (type === "spheres") {
// default
} else if (type === "surface") {
dim = obj.dim[0];
nx = dim[0];
nz = dim[1];
if (pmode === "filled") {
fnew = [];
for (j=0; j<nx-1; j++) {
for (i=0; i<nz-1; i++) {
fnew.push(f[j + nx*i],
f[j + nx*(i+1)],
f[j + 1 + nx*(i+1)],
f[j + nx*i],
f[j + 1 + nx*(i+1)],
f[j + 1 + nx*i]);
}
}
} else if (pmode === "lines") {
fnew = [];
for (j=0; j<nx; j++) {
for (i=0; i<nz; i++) {
if (i+1 < nz)
fnew.push(f[j + nx*i],
f[j + nx*(i+1)]);
if (j+1 < nx)
fnew.push(f[j + nx*i],
f[j+1 + nx*i]);
}
}
}
}
obj.f[pass] = fnew;
if (depth_sort) {
drawtype = "DYNAMIC_DRAW";
} else {
drawtype = "STATIC_DRAW";
}
}
if (fat_lines) {
alias = undefined;
obj.nextLoc = gl.getAttribLocation(obj.prog, "aNext");
obj.pointLoc = gl.getAttribLocation(obj.prog, "aPoint");
obj.aspectLoc = gl.getUniformLocation(obj.prog, "uAspect");
obj.lwdLoc = gl.getUniformLocation(obj.prog, "uLwd");
// Expand vertices to turn each segment into a pair of triangles
for (pass = 0; pass < obj.passes; pass++) {
f = obj.f[pass];    
oldrows = f.length;
if (obj.pmode[pass] === "lines") 
break;
}
if (type === "linestrip") 
nrows = 4*(oldrows - 1); 
else
nrows = 2*oldrows;
vnew = new Array(nrows);
fnew = new Array(1.5*nrows);
var fnext = new Array(nrows),
fpt = new Array(nrows), 
pt, start, gap = type === "linestrip" ? 3 : 1;
// We're going to turn each pair of vertices into 4 new ones, with the "next" and "pt" attributes
// added.
// We do this by copying the originals in the first pass, adding the new attributes, then in a 
// second pass add new vertices at the end.
for (i = 0; i < v.length; i++) {
vnew[i] = v[i].concat([0,0,0,0,0]); 
}
nextofs = stride;
pointofs = stride + 3;
stride = stride + 5;
// Now add the extras
last = v.length - 1;
ind = 0;
alias = new Array(f.length);
for (i = 0; i < f.length; i++)
alias[i] = [];
for (i = 0; i < f.length - 1; i++) {
if (type !== "linestrip" && i % 2 == 1)
continue;
k = ++last;
vnew[k] = vnew[f[i]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i+1]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = -1;
fnew[ind] = k;
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+1] = last;
alias[f[i]].push(last-1, last);
last++;
k = last;
vnew[k] = vnew[f[i+1]].slice();
for (j=0; j<3; j++)
vnew[k][nextofs + j] = vnew[f[i]][j];
vnew[k][pointofs] = -1;
vnew[k][pointofs+1] = 1;
fnew[ind+2] = k;
fnew[ind+3] = fnew[ind+1];
last++;
vnew[last] = vnew[k].slice();
vnew[last][pointofs] = 1;
fnew[ind+4] = last;
fnew[ind+5] = fnew[ind+2];
ind += 6;
alias[f[i+1]].push(last-1, last);
}
vnew.length = last+1;
v = vnew;
obj.vertexCount = v.length;
if (typeof alias !== "undefined" && typeof obj.alias !== "undefined") {  // Already have aliases from previous section?
var oldalias = obj.alias, newalias = Array(obj.alias.length);
for (i = 0; i < newalias.length; i++) {
newalias[i] = oldalias[i].slice();
for (j = 0; j < oldalias[i].length; j++)
Array.prototype.push.apply(newalias[i], alias[oldalias[j]]); // pushes each element 
}
obj.alias = newalias;
} else
obj.alias = alias;
for (pass = 0; pass < obj.passes; pass++)
if (type === "lines" || type === "linestrip" || obj.pmode[pass] == "lines") {
obj.f[pass] = fnew;
}
if (depth_sort) 
drawtype = "DYNAMIC_DRAW";
else
drawtype = "STATIC_DRAW";
}
for (pass = 0; pass < obj.passes; pass++) {
if (obj.vertexCount > 65535) {
if (this.index_uint) {
obj.f[pass] = new Uint32Array(obj.f[pass]);
obj.index_uint = true;
} else
this.alertOnce("Object has "+obj.vertexCount+" vertices, not supported in this browser.");
} else {
obj.f[pass] = new Uint16Array(obj.f[pass]);
obj.index_uint = false;
}
}
if (stride !== v[0].length) {
this.alertOnce("problem in stride calculation");
}
obj.vOffsets = {vofs:0, cofs:cofs, nofs:nofs, radofs:radofs, oofs:oofs, tofs:tofs,
nextofs:nextofs, pointofs:pointofs, stride:stride};
obj.values = new Float32Array(this.flatten(v));
if (type !== "spheres" && !sprites_3d) {
obj.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW); //
obj.ibuf = Array(obj.passes);
obj.ibuf[0] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[0]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[0], gl[drawtype]);
if (is_twosided) {
obj.ibuf[1] = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[1]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, obj.f[1], gl[drawtype]);
}
}
if (!sprites_3d) {
obj.mvMatLoc = gl.getUniformLocation(obj.prog, "mvMatrix");
obj.prMatLoc = gl.getUniformLocation(obj.prog, "prMatrix");
}
if (fixed_size) {
obj.textScaleLoc = gl.getUniformLocation(obj.prog, "textScale");
}
if (is_lit && !sprites_3d) {
obj.normMatLoc = gl.getUniformLocation(obj.prog, "normMatrix");
}
if (is_twosided) {
obj.frontLoc = gl.getUniformLocation(obj.prog, "front");
}
};
/**
* Set gl depth test based on object's material
* @param { number } id - object to use
*/
rglwidgetClass.prototype.setDepthTest = function(id) {
var gl = this.gl || this.initGL(),
tests = {never: gl.NEVER,
less:  gl.LESS,
equal: gl.EQUAL,
lequal:gl.LEQUAL,
greater: gl.GREATER,
notequal: gl.NOTEQUAL,
gequal: gl.GEQUAL,
always: gl.ALWAYS},
test = tests[this.getMaterial(id, "depth_test")];
gl.depthFunc(test);
};
rglwidgetClass.prototype.mode4type = {points : "POINTS",
linestrip : "LINE_STRIP",
abclines : "LINES",
lines : "LINES",
sprites : "TRIANGLES",
planes : "TRIANGLES",
text : "TRIANGLES",
quads : "TRIANGLES",
surface : "TRIANGLES",
triangles : "TRIANGLES"};
/**
* Sort objects from back to front
* @returns { number[] }
* @param { Object } obj - object to sort
*/
rglwidgetClass.prototype.depthSort = function(obj) {
var n = obj.centers.length,
depths = new Float32Array(n),
result = new Array(n),
compare = function(i,j) { return depths[j] - depths[i]; },
z, w;
for(i=0; i<n; i++) {
z = this.prmvMatrix.m13*obj.centers[i][0] +
this.prmvMatrix.m23*obj.centers[i][1] +
this.prmvMatrix.m33*obj.centers[i][2] +
this.prmvMatrix.m43;
w = this.prmvMatrix.m14*obj.centers[i][0] +
this.prmvMatrix.m24*obj.centers[i][1] +
this.prmvMatrix.m34*obj.centers[i][2] +
this.prmvMatrix.m44;
depths[i] = z/w;
result[i] = i;
}
result.sort(compare);
return result;
};
rglwidgetClass.prototype.disableArrays = function(obj, enabled) {
var gl = this.gl || this.initGL(),
objLocs = ["normLoc", "texLoc", "ofsLoc", "pointLoc", "nextLoc"],
thisLocs = ["posLoc", "colLoc"], i, attr;
for (i = 0; i < objLocs.length; i++) 
if (enabled[objLocs[i]]) gl.disableVertexAttribArray(obj[objLocs[i]]);
for (i = 0; i < thisLocs.length; i++)
if (enabled[thisLocs[i]]) gl.disableVertexAttribArray(this[objLocs[i]]);
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.disableVertexAttribArray( obj.userAttribLocations[attr] );
}
}
}
/**
* Draw an object in a subscene
* @param { number } id - object to draw
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawObj = function(id, subsceneid) {
var obj = this.getObj(id),
subscene = this.getObj(subsceneid),
flags = obj.flags,
type = obj.type,
is_lit = flags & this.f_is_lit,
has_texture = flags & this.f_has_texture,
fixed_quads = flags & this.f_fixed_quads,
is_transparent = flags & this.f_is_transparent,
depth_sort = flags & this.f_depth_sort,
sprites_3d = flags & this.f_sprites_3d,
sprite_3d = flags & this.f_sprite_3d,
is_lines = flags & this.f_is_lines,
fat_lines = flags & this.f_fat_lines,
is_points = flags & this.f_is_points,
fixed_size = flags & this.f_fixed_size,
is_twosided = (flags & this.f_is_twosided) > 0,
gl = this.gl || this.initGL(),
mat,
sphereMV, baseofs, ofs, sscale, i, count, light,
pass, mode, pmode, attr,
enabled = {};
if (typeof id !== "number") {
this.alertOnce("drawObj id is "+typeof id);
}
if (type === "planes") {
if (obj.bbox !== subscene.par3d.bbox || !obj.initialized) {
this.planeUpdateTriangles(id, subscene.par3d.bbox);
}
}
if (!obj.initialized)
this.initObj(id);
if (type === "clipplanes") {
count = obj.offsets.length;
var IMVClip = [];
for (i=0; i < count; i++) {
IMVClip[i] = this.multMV(this.invMatrix, obj.vClipplane.slice(4*i, 4*(i+1)));
}
obj.IMVClip = IMVClip;
return;
}
if (type === "light" || type === "bboxdeco" || !obj.vertexCount)
return;
if (!is_transparent &&
obj.someHidden) {
is_transparent = true;
depth_sort = ["triangles", "quads", "surface",
"spheres", "sprites", "text"].indexOf(type) >= 0;
}        
this.setDepthTest(id);
if (sprites_3d) {
var norigs = obj.vertices.length,
savenorm = new CanvasMatrix4(this.normMatrix);
this.origs = obj.vertices;
this.usermat = new Float32Array(obj.userMatrix.getAsArray());
this.radii = obj.radii;
this.normMatrix = subscene.spriteNormmat;
for (this.iOrig=0; this.iOrig < norigs; this.iOrig++) {
for (i=0; i < obj.objects.length; i++) {
this.drawObj(obj.objects[i], subsceneid);
}
}
this.normMatrix = savenorm;
return;
} else {
gl.useProgram(obj.prog);
}
if (typeof obj.polygon_offset !== "undefined") {
gl.polygonOffset(obj.polygon_offset[0],
obj.polygon_offset[1]);
gl.enable(gl.POLYGON_OFFSET_FILL);
}
if (sprite_3d) {
gl.uniform3fv(obj.origLoc, new Float32Array(this.origs[this.iOrig]));
if (this.radii.length > 1) {
gl.uniform1f(obj.sizeLoc, this.radii[this.iOrig][0]);
} else {
gl.uniform1f(obj.sizeLoc, this.radii[0][0]);
}
gl.uniformMatrix4fv(obj.usermatLoc, false, this.usermat);
}
if (type === "spheres") {
gl.bindBuffer(gl.ARRAY_BUFFER, this.sphere.buf);
} else {
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
}
gl.uniformMatrix4fv( obj.prMatLoc, false, new Float32Array(this.prMatrix.getAsArray()) );
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(this.mvMatrix.getAsArray()) );
var clipcheck = 0,
clipplaneids = subscene.clipplanes,
clip, j;
for (i=0; i < clipplaneids.length; i++) {
clip = this.getObj(clipplaneids[i]);
for (j=0; j < clip.offsets.length; j++) {
gl.uniform4fv(obj.clipLoc[clipcheck + j], clip.IMVClip[j]);
}
clipcheck += clip.offsets.length;
}
if (typeof obj.clipLoc !== "undefined")
for (i=clipcheck; i < obj.clipLoc.length; i++)
gl.uniform4f(obj.clipLoc[i], 0,0,0,0);
if (is_lit) {
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(this.normMatrix.getAsArray()) );
gl.uniform3fv( obj.emissionLoc, obj.emission);
gl.uniform1f( obj.shininessLoc, obj.shininess);
for (i=0; i < subscene.lights.length; i++) {
light = this.getObj(subscene.lights[i]);
if (!light.initialized) this.initObj(subscene.lights[i]);
gl.uniform3fv( obj.ambientLoc[i], this.componentProduct(light.ambient, obj.ambient));
gl.uniform3fv( obj.specularLoc[i], this.componentProduct(light.specular, obj.specular));
gl.uniform3fv( obj.diffuseLoc[i], light.diffuse);
gl.uniform3fv( obj.lightDirLoc[i], light.lightDir);
gl.uniform1i( obj.viewpointLoc[i], light.viewpoint);
gl.uniform1i( obj.finiteLoc[i], light.finite);
}
for (i=subscene.lights.length; i < obj.nlights; i++) {
gl.uniform3f( obj.ambientLoc[i], 0,0,0);
gl.uniform3f( obj.specularLoc[i], 0,0,0);
gl.uniform3f( obj.diffuseLoc[i], 0,0,0);
}
}
if (fixed_size) {
gl.uniform2f( obj.textScaleLoc, 0.75/this.vp.width, 0.75/this.vp.height);
}
gl.enableVertexAttribArray( this.posLoc );
enabled.posLoc = true;
var nc = obj.colorCount;
count = obj.vertexCount;
if (type === "spheres") {
subscene = this.getObj(subsceneid);
var scale = subscene.par3d.scale,
scount = count, indices;
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.enableVertexAttribArray(obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc,  3, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,  0);
gl.disableVertexAttribArray( this.colLoc );
var sphereNorm = new CanvasMatrix4();
sphereNorm.scale(scale[0], scale[1], scale[2]);
sphereNorm.multRight(this.normMatrix);
gl.uniformMatrix4fv( obj.normMatLoc, false, new Float32Array(sphereNorm.getAsArray()) );
if (nc == 1) {
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
}
if (has_texture) {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*this.sphere.vOffsets.stride,
4*this.sphere.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (depth_sort)
indices = this.depthSort(obj);
for (i = 0; i < scount; i++) {
sphereMV = new CanvasMatrix4();
if (depth_sort) {
baseofs = indices[i]*obj.vOffsets.stride;
} else {
baseofs = i*obj.vOffsets.stride;
}
ofs = baseofs + obj.vOffsets.radofs;
sscale = obj.values[ofs];
sphereMV.scale(sscale/scale[0], sscale/scale[1], sscale/scale[2]);
sphereMV.translate(obj.values[baseofs],
obj.values[baseofs+1],
obj.values[baseofs+2]);
sphereMV.multRight(this.mvMatrix);
gl.uniformMatrix4fv( obj.mvMatLoc, false, new Float32Array(sphereMV.getAsArray()) );
if (nc > 1) {
ofs = baseofs + obj.vOffsets.cofs;
gl.vertexAttrib4f( this.colLoc, obj.values[ofs],
obj.values[ofs+1],
obj.values[ofs+2],
obj.values[ofs+3] );
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.sphere.ibuf);
gl.drawElements(gl.TRIANGLES, this.sphere.sphereCount, gl.UNSIGNED_SHORT, 0);
}
this.disableArrays(obj, enabled);
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
return;
} else {
if (obj.colorCount === 1) {
gl.disableVertexAttribArray( this.colLoc );
gl.vertexAttrib4fv( this.colLoc, new Float32Array(obj.onecolor));
} else {
gl.enableVertexAttribArray( this.colLoc );
enabled.colLoc = true;
gl.vertexAttribPointer(this.colLoc, 4, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.cofs);
}
}
if (is_lit && obj.vOffsets.nofs > 0) {
gl.enableVertexAttribArray( obj.normLoc );
enabled.normLoc = true;
gl.vertexAttribPointer(obj.normLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nofs);
}
if (has_texture || type === "text") {
gl.enableVertexAttribArray( obj.texLoc );
enabled.texLoc = true;
gl.vertexAttribPointer(obj.texLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.tofs);
gl.activeTexture(gl.TEXTURE0);
gl.bindTexture(gl.TEXTURE_2D, obj.texture);
gl.uniform1i( obj.sampler, 0);
}
if (fixed_quads) {
gl.enableVertexAttribArray( obj.ofsLoc );
enabled.ofsLoc = true;
gl.vertexAttribPointer(obj.ofsLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.oofs);
}
if (typeof obj.userAttributes !== "undefined") {
for (attr in obj.userAttribSizes) {  // Not all attributes may have been used
gl.enableVertexAttribArray( obj.userAttribLocations[attr] );
gl.vertexAttribPointer( obj.userAttribLocations[attr], obj.userAttribSizes[attr],
gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.userAttribOffsets[attr]);
}
}
if (typeof obj.userUniforms !== "undefined") {
for (attr in obj.userUniformLocations) {
var loc = obj.userUniformLocations[attr];
if (loc !== null) {
var uniform = obj.userUniforms[attr];
if (typeof uniform.length === "undefined")
gl.uniform1f(loc, uniform);
else if (typeof uniform[0].length === "undefined") {
uniform = new Float32Array(uniform);
switch(uniform.length) {
case 2: gl.uniform2fv(loc, uniform); break;
case 3: gl.uniform3fv(loc, uniform); break;
case 4: gl.uniform4fv(loc, uniform); break;
default: console.warn("bad uniform length");
}
} else if (uniform.length == 4 && uniform[0].length == 4)
gl.uniformMatrix4fv(loc, false, new Float32Array(uniform.getAsArray()));
else
console.warn("unsupported uniform matrix");
}
}
}
for (pass = 0; pass < obj.passes; pass++) {
pmode = obj.pmode[pass];
if (pmode === "culled")
continue;
mode = fat_lines && (is_lines || pmode == "lines") ? "TRIANGLES" : this.mode4type[type];
if (depth_sort && pmode == "filled") {// Don't try depthsorting on wireframe or points
var faces = this.depthSort(obj),
nfaces = faces.length,
frowsize = Math.floor(obj.f[pass].length/nfaces);
if (type !== "spheres") {
var f = obj.index_uint ? new Uint32Array(obj.f[pass].length) : new Uint16Array(obj.f[pass].length);
for (i=0; i<nfaces; i++) {
for (j=0; j<frowsize; j++) {
f[frowsize*i + j] = obj.f[pass][frowsize*faces[i] + j];
}
}
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, f, gl.DYNAMIC_DRAW);
}
}
if (is_twosided)
gl.uniform1i(obj.frontLoc, pass !== 0);
if (type !== "spheres") 
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, obj.ibuf[pass]);
if (type === "sprites" || type === "text" || type === "quads") {
count = count * 6/4;
} else if (type === "surface") {
count = obj.f[pass].length;
}
count = obj.f[pass].length;
if (!is_lines && pmode === "lines" && !fat_lines) {
mode = "LINES";
} else if (pmode === "points") {
mode = "POINTS";
}
if ((is_lines || pmode === "lines") && fat_lines) {
gl.enableVertexAttribArray(obj.pointLoc);
enabled.pointLoc = true;
gl.vertexAttribPointer(obj.pointLoc, 2, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.pointofs);
gl.enableVertexAttribArray(obj.nextLoc );
enabled.nextLoc = true;
gl.vertexAttribPointer(obj.nextLoc, 3, gl.FLOAT, false, 4*obj.vOffsets.stride, 4*obj.vOffsets.nextofs);
gl.uniform1f(obj.aspectLoc, this.vp.width/this.vp.height);
gl.uniform1f(obj.lwdLoc, this.getMaterial(id, "lwd")/this.vp.height);
}
gl.vertexAttribPointer(this.posLoc,  3, gl.FLOAT, false, 4*obj.vOffsets.stride,  4*obj.vOffsets.vofs);
gl.drawElements(gl[mode], count, obj.index_uint ? gl.UNSIGNED_INT : gl.UNSIGNED_SHORT, 0);
this.disableArrays(obj, enabled);
}
if (typeof obj.polygon_offset !== "undefined") 
gl.disable(gl.POLYGON_OFFSET_FILL);
};
/**
* Draw the background for a subscene
* @param { number } id - id of background object
* @param { number } subsceneid - id of subscene
*/
rglwidgetClass.prototype.drawBackground = function(id, subsceneid) {
var gl = this.gl || this.initGL(),
obj = this.getObj(id),
bg, i;
if (!obj.initialized)
this.initObj(id);
if (obj.colors.length) {
bg = obj.colors[0];
gl.clearColor(bg[0], bg[1], bg[2], bg[3]);
gl.depthMask(true);
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
}
if (typeof obj.quad !== "undefined") {
this.prMatrix.makeIdentity();
this.mvMatrix.makeIdentity();
gl.disable(gl.BLEND);
gl.disable(gl.DEPTH_TEST);
gl.depthMask(false);
for (i=0; i < obj.quad.length; i++)
this.drawObj(obj.quad[i], subsceneid);
}
};
/**
* Draw a subscene
* @param { number } subsceneid - id of subscene
* @param { boolean } opaquePass - is this the opaque drawing pass?
*/
rglwidgetClass.prototype.drawSubscene = function(subsceneid, opaquePass) {
var gl = this.gl || this.initGL(),
sub = this.getObj(subsceneid),
objects = this.scene.objects,
subids = sub.objects,
subscene_has_faces = false,
subscene_needs_sorting = false,
flags, i, obj;
if (sub.par3d.skipRedraw)
return;
for (i=0; i < subids.length; i++) {
obj = objects[subids[i]];
flags = obj.flags;
if (typeof flags !== "undefined") {
subscene_has_faces |= (flags & this.f_is_lit)
& !(flags & this.f_fixed_quads);
obj.is_transparent = (flags & this.f_is_transparent) || obj.someHidden;
subscene_needs_sorting |= (flags & this.f_depth_sort) || obj.is_transparent;
}
}
this.setViewport(subsceneid);
if (typeof sub.backgroundId !== "undefined" && opaquePass)
this.drawBackground(sub.backgroundId, subsceneid);
if (subids.length) {
this.setprMatrix(subsceneid);
this.setmvMatrix(subsceneid);
if (subscene_has_faces) {
this.setnormMatrix(subsceneid);
if ((sub.flags & this.f_sprites_3d) &&
typeof sub.spriteNormmat === "undefined") {
sub.spriteNormmat = new CanvasMatrix4(this.normMatrix);
}
}
if (subscene_needs_sorting)
this.setprmvMatrix();
var clipids = sub.clipplanes;
if (typeof clipids === "undefined") {
console.warn("bad clipids");
}
if (clipids.length > 0) {
this.invMatrix = new CanvasMatrix4(this.mvMatrix);
this.invMatrix.invert();
for (i = 0; i < clipids.length; i++)
this.drawObj(clipids[i], subsceneid);
}
subids = sub.opaque.concat(sub.transparent);
if (opaquePass) {
gl.enable(gl.DEPTH_TEST);
gl.depthMask(true);
gl.disable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (!this.getObj(subids[i]).is_transparent) 
this.drawObj(subids[i], subsceneid);
}
} else {
gl.depthMask(false);
gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA,
gl.ONE, gl.ONE);
gl.enable(gl.BLEND);
for (i = 0; i < subids.length; i++) {
if (this.getObj(subids[i]).is_transparent)
this.drawObj(subids[i], subsceneid);
}
}
subids = sub.subscenes;
for (i = 0; i < subids.length; i++) {
this.drawSubscene(subids[i], opaquePass);
}
}
};
/**
* Respond to brush change
*/
rglwidgetClass.prototype.selectionChanged = function() {
var i, j, k, id, subid = this.select.subscene, subscene,
objids, obj,
p1 = this.select.region.p1, p2 = this.select.region.p2,
filter, selection = [], handle, keys, xmin, x, xmax, ymin, y, ymax, z, v,
someHidden;
if (!subid)
return;
subscene = this.getObj(subid);
objids = subscene.objects;
filter = this.scene.crosstalk.filter;
this.setmvMatrix(subid);
this.setprMatrix(subid);
this.setprmvMatrix();
xmin = Math.min(p1.x, p2.x);
xmax = Math.max(p1.x, p2.x);
ymin = Math.min(p1.y, p2.y);
ymax = Math.max(p1.y, p2.y);
for (i = 0; i < objids.length; i++) {
id = objids[i];
j = this.scene.crosstalk.id.indexOf(id);
if (j >= 0) {
keys = this.scene.crosstalk.key[j];
obj = this.getObj(id);
someHidden = false;
for (k = 0; k < keys.length; k++) {
if (filter && filter.indexOf(keys[k]) < 0) {
someHidden = true;
continue;
}
v = [].concat(obj.vertices[k]).concat(1.0);
v = this.multVM(v, this.prmvMatrix);
x = v[0]/v[3];
y = v[1]/v[3];
z = v[2]/v[3];
if (xmin <= x && x <= xmax && ymin <= y && y <= ymax && -1.0 <= z && z <= 1.0) {
selection.push(keys[k]);
} else
someHidden = true;
}
obj.someHidden = someHidden && (filter || selection.length);
obj.initialized = false;
/* Who should we notify?  Only shared data in the current subscene, or everyone? */
if (!this.equalArrays(selection, this.scene.crosstalk.selection)) {
handle = this.scene.crosstalk.sel_handle[j];
handle.set(selection, {rglSubsceneId: this.select.subscene});
}
}
}
};
/**
* Respond to selection or filter change from crosstalk
* @param { Object } event - crosstalk event
* @param { boolean } filter - filter or selection?
*/
rglwidgetClass.prototype.selection = function(event, filter) {
var i, j, ids, obj, keys, crosstalk = this.scene.crosstalk,
selection, someHidden;
// Record the message and find out if this event makes some objects have mixed values:
crosstalk = this.scene.crosstalk;
if (filter) {
filter = crosstalk.filter = event.value;
selection = crosstalk.selection;
} else {  
selection = crosstalk.selection = event.value;
filter = crosstalk.filter;
}
ids = crosstalk.id;
for (i = 0; i < ids.length ; i++) {
obj = this.getObj(ids[i]);
obj.initialized = false;
keys = crosstalk.key[i];
someHidden = false;
for (j = 0; j < keys.length && !someHidden; j++) {
if ((filter && filter.indexOf(keys[j]) < 0) ||
(selection.length && selection.indexOf(keys[j]) < 0))
someHidden = true;
}
obj.someHidden = someHidden;
}
this.drawScene();
};
/**
* Clear the selection brush
* @param { number } except - Subscene that should ignore this request
*/
rglwidgetClass.prototype.clearBrush = function(except) {
if (this.select.subscene != except) {
this.select.state = "inactive";
this.delFromSubscene(this.scene.brushId, this.select.subscene);
}
this.drawScene();
};
/**
* Compute mouse coordinates relative to current canvas
* @returns { Object }
* @param { Object } event - event object from mouse click
*/
rglwidgetClass.prototype.relMouseCoords = function(event) {
var totalOffsetX = 0,
totalOffsetY = 0,
currentElement = this.canvas;
do {
totalOffsetX += currentElement.offsetLeft;
totalOffsetY += currentElement.offsetTop;
currentElement = currentElement.offsetParent;
}
while(currentElement);
var canvasX = event.pageX - totalOffsetX,
canvasY = event.pageY - totalOffsetY;
return {x:canvasX, y:canvasY};
};
/**
* Set mouse handlers for the scene
*/
rglwidgetClass.prototype.setMouseHandlers = function() {
var self = this, activeSubscene, handler,
handlers = {}, drag = 0;
handlers.rotBase = 0;
this.screenToVector = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
radius = Math.max(width, height)/2.0,
cx = width/2.0,
cy = height/2.0,
px = (x-cx)/radius,
py = (y-cy)/radius,
plen = Math.sqrt(px*px+py*py);
if (plen > 1.e-6) {
px = px/plen;
py = py/plen;
}
var angle = (Math.SQRT2 - plen)/Math.SQRT2*Math.PI/2,
z = Math.sin(angle),
zlen = Math.sqrt(1.0 - z*z);
px = px * zlen;
py = py * zlen;
return [px, py, z];
};
handlers.trackballdown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.rotBase = this.screenToVector(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.trackballmove = function(x,y) {
var rotCurrent = this.screenToVector(x,y),
rotBase = handlers.rotBase,
dot = rotBase[0]*rotCurrent[0] +
rotBase[1]*rotCurrent[1] +
rotBase[2]*rotCurrent[2],
angle = Math.acos( dot/this.vlen(rotBase)/this.vlen(rotCurrent) )*180.0/Math.PI,
axis = this.xprod(rotBase, rotCurrent),
objects = this.scene.objects,
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
l = activeModel.par3d.listeners,
i;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(angle, axis[0], axis[1], axis[2]);
}
this.drawScene();
};
handlers.trackballend = 0;
this.clamp = function(x, lo, hi) {
return Math.max(lo, Math.min(x, hi));
};
this.screenToPolar = function(x,y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height,
r = Math.min(width, height)/2,
dx = this.clamp(x - width/2, -r, r),
dy = this.clamp(y - height/2, -r, r);
return [Math.asin(dx/r), Math.asin(-dy/r)];
};
handlers.polardown = function(x,y) {
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
handlers.dragBase = this.screenToPolar(x, y);
this.saveMat = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
activeSub.camBase = [-Math.atan2(activeSub.saveMat.m13, activeSub.saveMat.m11),
Math.atan2(activeSub.saveMat.m32, activeSub.saveMat.m22)];
}
};
handlers.polarmove = function(x,y) {
var dragCurrent = this.screenToPolar(x,y),
activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
objects = this.scene.objects,
l = activeModel.par3d.listeners,
i, changepos = [];
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
for (j=0; j<2; j++)
changepos[j] = -(dragCurrent[j] - handlers.dragBase[j]);
activeSub.par3d.userMatrix.makeIdentity();
activeSub.par3d.userMatrix.rotate(changepos[0]*180/Math.PI, 0,-1,0);
activeSub.par3d.userMatrix.multRight(objects[l[i]].saveMat);
activeSub.par3d.userMatrix.rotate(changepos[1]*180/Math.PI, -1,0,0);
}
this.drawScene();
};
handlers.polarend = 0;
handlers.axisdown = function(x,y) {
handlers.rotBase = this.screenToVector(x, this.canvas.height/2);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.saveMat = new CanvasMatrix4(activeSub.par3d.userMatrix);
}
};
handlers.axismove = function(x,y) {
var rotCurrent = this.screenToVector(x, this.canvas.height/2),
rotBase = handlers.rotBase,
angle = (rotCurrent[0] - rotBase[0])*180/Math.PI,
rotMat = new CanvasMatrix4();
rotMat.rotate(angle, handlers.axis[0], handlers.axis[1], handlers.axis[2]);
var activeSub = this.getObj(activeSubscene),
activeModel = this.getObj(this.useid(activeSub.id, "model")),
i, l = activeModel.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.userMatrix.load(activeSub.saveMat);
activeSub.par3d.userMatrix.multLeft(rotMat);
}
this.drawScene();
};
handlers.axisend = 0;
handlers.y0zoom = 0;
handlers.zoom0 = 0;
handlers.zoomdown = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
handlers.y0zoom = y;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.zoom0 = Math.log(activeSub.par3d.zoom);
}
};
handlers.zoommove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.zoom = Math.exp(activeSub.zoom0 + (y-handlers.y0zoom)/this.canvas.height);
}
this.drawScene();
};
handlers.zoomend = 0;
handlers.y0fov = 0;
handlers.fovdown = function(x, y) {
handlers.y0fov = y;
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.fov0 = activeSub.par3d.FOV;
}
};
handlers.fovmove = function(x, y) {
var activeSub = this.getObj(activeSubscene),
activeProjection = this.getObj(this.useid(activeSub.id, "projection")),
i, l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = this.getObj(l[i]);
activeSub.par3d.FOV = Math.max(1, Math.min(179, activeSub.fov0 +
180*(y-handlers.y0fov)/this.canvas.height));
}
this.drawScene();
};
handlers.fovend = 0;
handlers.selectingdown = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height, 
p = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
this.select.region = {p1: p, p2: p};
if (this.select.subscene && this.select.subscene != activeSubscene)
this.delFromSubscene(this.scene.brushId, this.select.subscene);
this.select.subscene = activeSubscene;
this.addToSubscene(this.scene.brushId, activeSubscene);
this.select.state = "changing";
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingmove = function(x, y) {
var viewport = this.getObj(activeSubscene).par3d.viewport,
width = viewport.width*this.canvas.width,
height = viewport.height*this.canvas.height;
if (this.select.state === "inactive") 
return;
this.select.region.p2 = {x: 2.0*x/width - 1.0, y: 2.0*y/height - 1.0};
if (typeof this.scene.brushId !== "undefined")
this.getObj(this.scene.brushId).initialized = false;
this.drawScene();
};
handlers.selectingend = 0;
this.canvas.onmousedown = function ( ev ){
if (!ev.which) // Use w3c defns in preference to MS
switch (ev.button) {
case 0: ev.which = 1; break;
case 1:
case 4: ev.which = 2; break;
case 2: ev.which = 3;
}
drag = ["left", "middle", "right"][ev.which-1];
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height-coords.y;
activeSubscene = self.whichSubscene(coords);
var sub = self.getObj(activeSubscene), f;
handler = sub.par3d.mouseMode[drag];
switch (handler) {
case "xAxis":
handler = "axis";
handlers.axis = [1.0, 0.0, 0.0];
break;
case "yAxis":
handler = "axis";
handlers.axis = [0.0, 1.0, 0.0];
break;
case "zAxis":
handler = "axis";
handlers.axis = [0.0, 0.0, 1.0];
break;
}
f = handlers[handler + "down"];
if (f) {
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
ev.preventDefault();
} else
console.warn("Mouse handler '" + handler + "' is not implemented.");
};
this.canvas.onmouseup = function ( ev ){
if ( drag === 0 ) return;
var f = handlers[handler + "end"];
if (f) {
f.call(self);
ev.preventDefault();
}
drag = 0;
};
this.canvas.onmouseout = this.canvas.onmouseup;
this.canvas.onmousemove = function ( ev ) {
if ( drag === 0 ) return;
var f = handlers[handler + "move"];
if (f) {
var coords = self.relMouseCoords(ev);
coords.y = self.canvas.height - coords.y;
coords = self.translateCoords(activeSubscene, coords);
f.call(self, coords.x, coords.y);
}
};
handlers.wheelHandler = function(ev) {
var del = 1.02, i;
if (ev.shiftKey) del = 1.002;
var ds = ((ev.detail || ev.wheelDelta) > 0) ? del : (1 / del);
if (typeof activeSubscene === "undefined")
activeSubscene = self.scene.rootSubscene;
var activeSub = self.getObj(activeSubscene),
activeProjection = self.getObj(self.useid(activeSub.id, "projection")),
l = activeProjection.par3d.listeners;
for (i = 0; i < l.length; i++) {
activeSub = self.getObj(l[i]);
activeSub.par3d.zoom *= ds;
}
self.drawScene();
ev.preventDefault();
};
this.canvas.addEventListener("DOMMouseScroll", handlers.wheelHandler, false);
this.canvas.addEventListener("mousewheel", handlers.wheelHandler, false);
};
/**
* Find a particular subscene by inheritance
* @returns { number } id of subscene to use
* @param { number } subsceneid - child subscene
* @param { string } type - type of inheritance:  "projection" or "model"
*/
rglwidgetClass.prototype.useid = function(subsceneid, type) {
var sub = this.getObj(subsceneid);
if (sub.embeddings[type] === "inherit")
return(this.useid(sub.parent, type));
else
return subsceneid;
};
/**
* Check whether point is in viewport of subscene
* @returns {boolean}
* @param { Object } coords - screen coordinates of point
* @param { number } subsceneid - subscene to check
*/
rglwidgetClass.prototype.inViewport = function(coords, subsceneid) {
var viewport = this.getObj(subsceneid).par3d.viewport,
x0 = coords.x - viewport.x*this.canvas.width,
y0 = coords.y - viewport.y*this.canvas.height;
return 0 <= x0 && x0 <= viewport.width*this.canvas.width &&
0 <= y0 && y0 <= viewport.height*this.canvas.height;
};
/**
* Find which subscene contains a point
* @returns { number } subscene id
* @param { Object } coords - coordinates of point
*/
rglwidgetClass.prototype.whichSubscene = function(coords) {
var self = this,
recurse = function(subsceneid) {
var subscenes = self.getChildSubscenes(subsceneid), i, id;
for (i=0; i < subscenes.length; i++) {
id = recurse(subscenes[i]);
if (typeof(id) !== "undefined")
return(id);
}
if (self.inViewport(coords, subsceneid))
return(subsceneid);
else
return undefined;
},
rootid = this.scene.rootSubscene,
result = recurse(rootid);
if (typeof(result) === "undefined")
result = rootid;
return result;
};
/**
* Translate from window coordinates to viewport coordinates
* @returns { Object } translated coordinates
* @param { number } subsceneid - which subscene to use?
* @param { Object } coords - point to translate
*/
rglwidgetClass.prototype.translateCoords = function(subsceneid, coords) {
var viewport = this.getObj(subsceneid).par3d.viewport;
return {x: coords.x - viewport.x*this.canvas.width,
y: coords.y - viewport.y*this.canvas.height};
};
/**
* Initialize the sphere object
*/
rglwidgetClass.prototype.initSphere = function() {
var verts = this.scene.sphereVerts,
reuse = verts.reuse, result;
if (typeof reuse !== "undefined") {
var prev = document.getElementById(reuse).rglinstance.sphere;
result = {values: prev.values, vOffsets: prev.vOffsets, it: prev.it};
} else
result = {values: new Float32Array(this.flatten(this.cbind(this.transpose(verts.vb),
this.transpose(verts.texcoords)))),
it: new Uint16Array(this.flatten(this.transpose(verts.it))),
vOffsets: {vofs:0, cofs:-1, nofs:-1, radofs:-1, oofs:-1,
tofs:3, nextofs:-1, pointofs:-1, stride:5}};
result.sphereCount = result.it.length;
this.sphere = result;
};
/**
* Set the vertices in the selection box object
*/
rglwidgetClass.prototype.initSelection = function(id) {
if (typeof this.select.region === "undefined")
return;
var obj = this.getObj(id),
width = this.canvas.width,
height = this.canvas.height, 
p1 = this.select.region.p1,
p2 = this.select.region.p2;
obj.vertices = [[p1.x, p1.y, 0.0],
[p2.x, p1.y, 0.0],
[p2.x, p2.y, 0.0],
[p1.x, p2.y, 0.0],
[p1.x, p1.y, 0.0]];
};
/**
* Do the gl part of initializing the sphere
*/
rglwidgetClass.prototype.initSphereGL = function() {
var gl = this.gl || this.initGL(), sphere = this.sphere;
if (gl.isContextLost()) return;
sphere.buf = gl.createBuffer();
gl.bindBuffer(gl.ARRAY_BUFFER, sphere.buf);
gl.bufferData(gl.ARRAY_BUFFER, sphere.values, gl.STATIC_DRAW);
sphere.ibuf = gl.createBuffer();
gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, sphere.ibuf);
gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, sphere.it, gl.STATIC_DRAW);
return;
};
/**
* Initialize the DOM object
* @param { Object } el - the DOM object
* @param { Object } x - the scene data sent by JSON from R
*/
rglwidgetClass.prototype.initialize = function(el, x) {
this.textureCanvas = document.createElement("canvas");
this.textureCanvas.style.display = "block";
this.scene = x;
this.normMatrix = new CanvasMatrix4();
this.saveMat = {};
this.distance = null;
this.posLoc = 0;
this.colLoc = 1;
if (el) {
el.rglinstance = this;
this.el = el;
this.webGLoptions = el.rglinstance.scene.webGLoptions;
this.initCanvas();
}
if (typeof Shiny !== "undefined") {
var self = this;
Shiny.addCustomMessageHandler("shinyGetPar3d",
function(message) {
var i, param, 
subscene = self.getObj(message.subscene),
parameters = [].concat(message.parameters),
result = {tag: message.tag, subscene: message.subscene};
if (typeof subscene !== "undefined") {
for (i = 0; i < parameters.length; i++) {
param = parameters[i];
result[param] = subscene.par3d[param];
};
} else {
console.log("subscene "+message.subscene+" undefined.")
}
Shiny.setInputValue("par3d:shinyPar3d", result, {priority: "event"});
});
Shiny.addCustomMessageHandler("shinySetPar3d",
function(message) {
var param = message.parameter, 
subscene = self.getObj(message.subscene);
if (typeof subscene !== "undefined") {
subscene.par3d[param] = message.value;
subscene.initialized = false;
self.drawScene();
} else {
console.log("subscene "+message.subscene+" undefined.")
}
})
}
};
/**
* Restart the WebGL canvas
*/
rglwidgetClass.prototype.restartCanvas = function() {
var newcanvas = document.createElement("canvas"),
self = this;
newcanvas.width = this.el.width;
newcanvas.height = this.el.height;
newcanvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
newcanvas.addEventListener("webglcontextlost",
this.onContextLost, false);
while (this.el.firstChild) {
this.el.removeChild(this.el.firstChild);
}
this.el.appendChild(newcanvas);
this.canvas = newcanvas;
this.setMouseHandlers();
if (this.gl) 
Object.keys(this.scene.objects).forEach(function(key){
self.getObj(parseInt(key, 10)).texture = undefined; 
});
this.gl = null;
};
/**
* Initialize the WebGL canvas
*/
rglwidgetClass.prototype.initCanvas = function() {
this.restartCanvas();
var objs = this.scene.objects,
self = this;
Object.keys(objs).forEach(function(key){
var id = parseInt(key, 10),
obj = self.getObj(id);
if (typeof obj.reuse !== "undefined")
self.copyObj(id, obj.reuse);
});
Object.keys(objs).forEach(function(key){
self.initSubscene(parseInt(key, 10));
});
this.setMouseHandlers();
this.initSphere();
this.onContextRestored = function(event) {
self.initGL();
self.drawScene();
};
this.onContextLost = function(event) {
if (!self.drawing)
this.gl = null;
event.preventDefault();
};
this.initGL0();
this.lazyLoadScene = function() {
if (typeof self.slide === "undefined")
self.slide = self.getSlide();
if (self.isInBrowserViewport()) {
if (!self.gl || self.gl.isContextLost())
self.initGL();
self.drawScene();
}
};
window.addEventListener("DOMContentLoaded", this.lazyLoadScene, false);
window.addEventListener("load", this.lazyLoadScene, false);
window.addEventListener("resize", this.lazyLoadScene, false);
window.addEventListener("scroll", this.lazyLoadScene, false);
this.slide = this.getSlide();
if (this.slide) {
if (typeof this.slide.rgl === "undefined")
this.slide.rgl = [this];
else
this.slide.rgl.push(this);
if (this.scene.context.rmarkdown) 
if (this.scene.context.rmarkdown === "ioslides_presentation") {
this.slide.setAttribute("slideenter", "this.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window);})");
} else if (this.scene.context.rmarkdown === "slidy_presentation") {
// This method would also work in ioslides, but it gets triggered
// something like 5 times per slide for every slide change, so
// you'd need a quicker function than lazyLoadScene.
var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver,
observer = new MutationObserver(function(mutations) {
mutations.forEach(function(mutation) {
self.slide.rgl.forEach(function(scene) { scene.lazyLoadScene.call(window); });});});
observer.observe(this.slide, { attributes: true, attributeFilter:["class"] });
}
}
};
/**
* Start the writeWebGL scene. This is only used by writeWebGL; rglwidget has
no debug element and does the drawing in rglwidget.js.
*/
rglwidgetClass.prototype.start = function() {
if (typeof this.prefix !== "undefined") {
this.debugelement = document.getElementById(this.prefix + "debug");
this.debug("");
}
this.drag = 0;
this.drawScene();
};
/**
* Display a debug message
* @param { string } msg - The message to display
* @param { Object } [img] - Image to insert before message
*/
rglwidgetClass.prototype.debug = function(msg, img) {
if (typeof this.debugelement !== "undefined" && this.debugelement !== null) {
this.debugelement.innerHTML = msg;
if (typeof img !== "undefined") {
this.debugelement.insertBefore(img, this.debugelement.firstChild);
}
} else if (msg !== "")
alert(msg);
};
/**
* Get the snapshot image of this scene
* @returns { Object } The img DOM element
*/
rglwidgetClass.prototype.getSnapshot = function() {
var img;
if (typeof this.scene.snapshot !== "undefined") {
img = document.createElement("img");
img.src = this.scene.snapshot;
img.alt = "Snapshot";
}
return img;
};
/**
* Initial test for WebGL
*/
rglwidgetClass.prototype.initGL0 = function() {
if (!window.WebGLRenderingContext){
alert("Your browser does not support WebGL. See http://get.webgl.org");
return;
}
};
/**
* If we are in an ioslides or slidy presentation, get the
* DOM element of the current slide
* @returns { Object }
*/
rglwidgetClass.prototype.getSlide = function() {
var result = this.el, done = false;
while (result && !done && this.scene.context.rmarkdown) {
switch(this.scene.context.rmarkdown) {
case "ioslides_presentation":
if (result.tagName === "SLIDE") return result;
break;
case "slidy_presentation":
if (result.tagName === "DIV" && result.classList.contains("slide"))
return result;
break;
default: return null;
}
result = result.parentElement;
}
return null;
};
/**
* Is this scene visible in the browser?
* @returns { boolean }
*/
rglwidgetClass.prototype.isInBrowserViewport = function() {
var rect = this.canvas.getBoundingClientRect(),
windHeight = (window.innerHeight || document.documentElement.clientHeight),
windWidth = (window.innerWidth || document.documentElement.clientWidth);
if (this.scene.context && this.scene.context.rmarkdown !== null) {
if (this.slide)
return (this.scene.context.rmarkdown === "ioslides_presentation" &&
this.slide.classList.contains("current")) ||
(this.scene.context.rmarkdown === "slidy_presentation" &&
!this.slide.classList.contains("hidden"));
}
return (
rect.top >= -windHeight &&
rect.left >= -windWidth &&
rect.bottom <= 2*windHeight &&
rect.right <= 2*windWidth);
};
/**
* Initialize WebGL
* @returns { Object } the WebGL context
*/
rglwidgetClass.prototype.initGL = function() {
var self = this;
if (this.gl) {
if (!this.drawing && this.gl.isContextLost())
this.restartCanvas();
else
return this.gl;
}
// if (!this.isInBrowserViewport()) return; Return what??? At this point we know this.gl is null.
this.canvas.addEventListener("webglcontextrestored",
this.onContextRestored, false);
this.canvas.addEventListener("webglcontextlost",
this.onContextLost, false);
this.gl = this.canvas.getContext("webgl", this.webGLoptions) ||
this.canvas.getContext("experimental-webgl", this.webGLoptions);
this.index_uint = this.gl.getExtension("OES_element_index_uint");
var save = this.startDrawing();
this.initSphereGL();
Object.keys(this.scene.objects).forEach(function(key){
self.initObj(parseInt(key, 10));
});
this.stopDrawing(save);
return this.gl;
};
/**
* Resize the display to match element
* @param { Object } el - DOM element to match
*/
rglwidgetClass.prototype.resize = function(el) {
this.canvas.width = el.width;
this.canvas.height = el.height;
};
/**
* Draw the whole scene
*/
rglwidgetClass.prototype.drawScene = function() {
var gl = this.gl || this.initGL(),
wasDrawing = this.startDrawing();
if (!wasDrawing) {
if (this.select.state !== "inactive")
this.selectionChanged();
gl.enable(gl.DEPTH_TEST);
gl.depthFunc(gl.LEQUAL);
gl.clearDepth(1.0);
gl.clearColor(1,1,1,1);
gl.depthMask(true); // Must be true before clearing depth buffer
gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);
this.drawSubscene(this.scene.rootSubscene, true);
this.drawSubscene(this.scene.rootSubscene, false);
}
this.stopDrawing(wasDrawing);
};
/**
* Change the displayed subset
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The subset control data.
*/
rglwidgetClass.prototype.subsetSetter = function(el, control) {
if (typeof control.subscenes === "undefined" ||
control.subscenes === null)
control.subscenes = this.scene.rootSubscene;
var value = Math.round(control.value),
subscenes = [].concat(control.subscenes),
fullset = [].concat(control.fullset),
i, j, entries, subsceneid,
adds = [], deletes = [],
ismissing = function(x) {
return fullset.indexOf(x) < 0;
},
tointeger = function(x) {
return parseInt(x, 10);
};
if (isNaN(value))
value = control.value = 0;
if (control.accumulate)
for (i=0; i <= value; i++)
adds = adds.concat(control.subsets[i]);
else
adds = adds.concat(control.subsets[value]);
deletes = fullset.filter(function(x) { return adds.indexOf(x) < 0; });
for (i = 0; i < subscenes.length; i++) {
subsceneid = subscenes[i];
if (typeof this.getObj(subsceneid) === "undefined")
this.alertOnce("typeof object is undefined");
for (j = 0; j < adds.length; j++)
this.addToSubscene(adds[j], subsceneid);
for (j = 0; j < deletes.length; j++)
this.delFromSubscene(deletes[j], subsceneid);
}
};
/**
* Change the requested property
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The property setter control data.
*/
rglwidgetClass.prototype.propertySetter = function(el, control)  {
var value = control.value,
values = [].concat(control.values),
svals = [].concat(control.param),
direct = values[0] === null,
entries = [].concat(control.entries),
ncol = entries.length,
nrow = values.length/ncol,
properties = this.repeatToLen(control.properties, ncol),
objids = this.repeatToLen(control.objids, ncol),
property, objid = objids[0],
obj = this.getObj(objid),
propvals, i, v1, v2, p, entry, gl, needsBinding,
newprop, newid,
getPropvals = function() {
if (property === "userMatrix")
return obj.par3d.userMatrix.getAsArray();
else if (property === "scale" || property === "FOV" || property === "zoom")
return [].concat(obj.par3d[property]);
else
return [].concat(obj[property]);
};
putPropvals = function(newvals) {
if (newvals.length == 1)
newvals = newvals[0];
if (property === "userMatrix")
obj.par3d.userMatrix.load(newvals);
else if (property === "scale" || property === "FOV" || property === "zoom")
obj.par3d[property] = newvals;
else
obj[property] = newvals;
};
if (direct && typeof value === "undefined")
return;
if (control.interp) {
values = values.slice(0, ncol).concat(values).
concat(values.slice(ncol*(nrow-1), ncol*nrow));
svals = [-Infinity].concat(svals).concat(Infinity);
for (i = 1; i < svals.length; i++) {
if (value <= svals[i]) {
if (svals[i] === Infinity)
p = 1;
else
p = (svals[i] - value)/(svals[i] - svals[i-1]);
break;
}
}
} else if (!direct) {
value = Math.round(value);
}
for (j=0; j<entries.length; j++) {
entry = entries[j];
newprop = properties[j];
newid = objids[j];
if (newprop !== property || newid != objid) {
if (typeof property !== "undefined")
putPropvals(propvals);
property = newprop;
objid = newid;
obj = this.getObj(objid);
propvals = getPropvals();
}
if (control.interp) {
v1 = values[ncol*(i-1) + j];
v2 = values[ncol*i + j];
this.setElement(propvals, entry, p*v1 + (1-p)*v2);
} else if (!direct) {
this.setElement(propvals, entry, values[ncol*value + j]);
} else {
this.setElement(propvals, entry, value[j]);
}
}
putPropvals(propvals);
needsBinding = [];
for (j=0; j < entries.length; j++) {
if (properties[j] === "values" &&
needsBinding.indexOf(objids[j]) === -1) {
needsBinding.push(objids[j]);
}
}
for (j=0; j < needsBinding.length; j++) {
gl = this.gl || this.initGL();
obj = this.getObj(needsBinding[j]);
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertices
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The vertext setter control data.
*/
rglwidgetClass.prototype.vertexSetter = function(el, control)  {
var svals = [].concat(control.param),
j, k, p, a, propvals, stride, ofs, obj, entry,
attrib,
ofss    = {x:"vofs", y:"vofs", z:"vofs",
red:"cofs", green:"cofs", blue:"cofs",
alpha:"cofs", radii:"radofs",
nx:"nofs", ny:"nofs", nz:"nofs",
ox:"oofs", oy:"oofs", oz:"oofs",
ts:"tofs", tt:"tofs"},
pos     = {x:0, y:1, z:2,
red:0, green:1, blue:2,
alpha:3,radii:0,
nx:0, ny:1, nz:2,
ox:0, oy:1, oz:2,
ts:0, tt:1},
values = control.values,
direct = values === null,
ncol,
interp = control.interp,
vertices = [].concat(control.vertices),
attributes = [].concat(control.attributes),
value = control.value, newval, aliases, alias;
ncol = Math.max(vertices.length, attributes.length);
if (!ncol)
return;
vertices = this.repeatToLen(vertices, ncol);
attributes = this.repeatToLen(attributes, ncol);
if (direct)
interp = false;
/* JSON doesn't pass Infinity */
svals[0] = -Infinity;
svals[svals.length - 1] = Infinity;
for (j = 1; j < svals.length; j++) {
if (value <= svals[j]) {
if (interp) {
if (svals[j] === Infinity)
p = 1;
else
p = (svals[j] - value)/(svals[j] - svals[j-1]);
} else {
if (svals[j] - value > value - svals[j-1])
j = j - 1;
}
break;
}
}
obj = this.getObj(control.objid);
// First, make sure color attributes vary in original
if (typeof obj.vOffsets !== "undefined") {
varies = true;
for (k = 0; k < ncol; k++) {
attrib = attributes[k];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0) {
switch(attrib) {
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(control.objid);
}
propvals = obj.values;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
for (k=0; k<ncol; k++) {
if (direct) {
newval = value;
} else if (interp) {
newval = p*values[j-1][k] + (1-p)*values[j][k];
} else {
newval = values[j][k];
}       
attrib = attributes[k];
vertex = vertices[k];
alias = aliases[vertex];
if (obj.type === "planes" || obj.type === "clipplanes") {
ofs = ["nx", "ny", "nz", "offset"].indexOf(attrib);
if (ofs >= 0) {
if (ofs < 3) {
if (obj.normals[vertex][ofs] != newval) {  // Assume no aliases here...
obj.normals[vertex][ofs] = newval;
obj.initialized = false;
}
} else {
if (obj.offsets[vertex][0] != newval) {
obj.offsets[vertex][0] = newval;
obj.initialized = false;
}
}
continue;
}
}
// Not a plane setting...
ofs = obj.vOffsets[ofss[attrib]];
if (ofs < 0)
this.alertOnce("Attribute '"+attrib+"' not found in object "+control.objid);
else {
stride = obj.vOffsets.stride;
ofs = ofs + pos[attrib];
entry = vertex*stride + ofs;
propvals[entry] = newval;
if (typeof alias !== "undefined")
for (a = 0; a < alias.length; a++)
propvals[alias[a]*stride + ofs] = newval;
}
}
if (typeof obj.buf !== "undefined") {
var gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, propvals, gl.STATIC_DRAW);
}
};
/**
* Change the requested vertex properties by age
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The age setter control data.
*/
rglwidgetClass.prototype.ageSetter = function(el, control) {
var objids = [].concat(control.objids),
nobjs = objids.length,
time = control.value,
births = [].concat(control.births),
ages = [].concat(control.ages),
steps = births.length,
j = Array(steps),
p = Array(steps),
i, k, age, j0, propvals, stride, ofs, objid, obj,
attrib, dim, varies, alias, aliases, a, d,
attribs = ["colors", "alpha", "radii", "vertices",
"normals", "origins", "texcoords",
"x", "y", "z",
"red", "green", "blue"],
ofss    = ["cofs", "cofs", "radofs", "vofs",
"nofs", "oofs", "tofs",
"vofs", "vofs", "vofs",
"cofs", "cofs", "cofs"],
dims    = [3,1,1,3,
3,2,2,
1,1,1,
1,1,1],
pos     = [0,3,0,0,
0,0,0,
0,1,2,
0,1,2];
/* Infinity doesn't make it through JSON */
ages[0] = -Infinity;
ages[ages.length-1] = Infinity;
for (i = 0; i < steps; i++) {
if (births[i] !== null) {  // NA in R becomes null
age = time - births[i];
for (j0 = 1; age > ages[j0]; j0++);
if (ages[j0] == Infinity)
p[i] = 1;
else if (ages[j0] > ages[j0-1])
p[i] = (ages[j0] - age)/(ages[j0] - ages[j0-1]);
else
p[i] = 0;
j[i] = j0;
}
}
// First, make sure color attributes vary in original
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
varies = true;
if (typeof obj.vOffsets === "undefined")
continue;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs < 0) {
switch(attribs[k]) {
case "colors":
case "alpha":
case "red":
case "green":
case "blue":
obj.colors = [obj.colors[0], obj.colors[0]];
break;
}
varies = false;
}
}
}
if (!varies)
this.initObj(objid);
}
for (l = 0; l < nobjs; l++) {
objid = objids[l];
obj = this.getObj(objid);
if (typeof obj.vOffsets === "undefined")
continue;
aliases = obj.alias;
if (typeof aliases === "undefined")
aliases = [];
propvals = obj.values;
stride = obj.vOffsets.stride;
for (k = 0; k < attribs.length; k++) {
attrib = control[attribs[k]];
if (typeof attrib !== "undefined") {
ofs = obj.vOffsets[ofss[k]];
if (ofs >= 0) {
dim = dims[k];
ofs = ofs + pos[k];
for (i = 0; i < steps; i++) {
alias = aliases[i];
if (births[i] !== null) {
for (d=0; d < dim; d++) {
propvals[i*stride + ofs + d] = p[i]*attrib[dim*(j[i]-1) + d] + (1-p[i])*attrib[dim*j[i] + d];
if (typeof alias !== "undefined")
for (a=0; a < alias.length; a++)
propvals[alias[a]*stride + ofs + d] = propvals[i*stride + ofs + d];
}
}
}
} else
this.alertOnce("\'"+attribs[k]+"\' property not found in object "+objid);
}
}
obj.values = propvals;
if (typeof obj.buf !== "undefined") {
gl = this.gl || this.initGL();
gl.bindBuffer(gl.ARRAY_BUFFER, obj.buf);
gl.bufferData(gl.ARRAY_BUFFER, obj.values, gl.STATIC_DRAW);
}
}
};
/**
* Bridge to old style control
* @param { Object } el - Element of the control; not used.
* @param { Object } control - The bridge control data.
*/
rglwidgetClass.prototype.oldBridge = function(el, control) {
var attrname, global = window[control.prefix + "rgl"];
if (global)
for (attrname in global)
this[attrname] = global[attrname];
window[control.prefix + "rgl"] = this;
};
/**
* Set up a player control
* @param { Object } el - The player control element
* @param { Object } control - The player data.
*/
rglwidgetClass.prototype.Player = function(el, control) {
var
self = this,
components = [].concat(control.components),
buttonLabels = [].concat(control.buttonLabels),
Tick = function() { /* "this" will be a timer */
var i,
nominal = this.value,
slider = this.Slider,
labels = this.outputLabels,
output = this.Output,
step;
if (typeof slider !== "undefined" && nominal != slider.value)
slider.value = nominal;
if (typeof output !== "undefined") {
step = Math.round((nominal - output.sliderMin)/output.sliderStep);
if (labels !== null) {
output.innerHTML = labels[step];
} else {
step = step*output.sliderStep + output.sliderMin;
output.innerHTML = step.toPrecision(output.outputPrecision);
}
}
for (i=0; i < this.actions.length; i++) {
this.actions[i].value = nominal;
}
self.applyControls(el, this.actions, false);
self.drawScene();
},
OnSliderInput = function() { /* "this" will be the slider */
this.rgltimer.value = Number(this.value);
this.rgltimer.Tick();
},
addSlider = function(min, max, step, value) {
var slider = document.createElement("input");
slider.type = "range";
slider.min = min;
slider.max = max;
slider.step = step;
slider.value = value;
slider.oninput = OnSliderInput;
slider.sliderActions = control.actions;
slider.sliderScene = this;
slider.className = "rgl-slider";
slider.id = el.id + "-slider";
el.rgltimer.Slider = slider;
slider.rgltimer = el.rgltimer;
el.appendChild(slider);
},
addLabel = function(labels, min, step, precision) {
var output = document.createElement("output");
output.sliderMin = min;
output.sliderStep = step;
output.outputPrecision = precision;
output.className = "rgl-label";
output.id = el.id + "-label";
el.rgltimer.Output = output;
el.rgltimer.outputLabels = labels;
el.appendChild(output);
},
addButton = function(which, label, active) {
var button = document.createElement("input"),
onclicks = {Reverse: function() { this.rgltimer.reverse();},
Play: function() { this.rgltimer.play();
this.value = this.rgltimer.enabled ? this.inactiveValue : this.activeValue; },
Slower: function() { this.rgltimer.slower(); },
Faster: function() { this.rgltimer.faster(); },
Reset: function() { this.rgltimer.reset(); },
Step:  function() { this.rgltimer.step(); }
};
button.rgltimer = el.rgltimer;
button.type = "button";
button.value = label;
button.activeValue = label;
button.inactiveValue = active;
if (which === "Play")
button.rgltimer.PlayButton = button;
button.onclick = onclicks[which];
button.className = "rgl-button";
button.id = el.id + "-" + which;
el.appendChild(button);
};
if (typeof control.reinit !== "undefined" && control.reinit !== null) {
control.actions.reinit = control.reinit;
}
el.rgltimer = new rgltimerClass(Tick, control.start, control.interval, control.stop,
control.step, control.value, control.rate, control.loop, control.actions);
for (var i=0; i < components.length; i++) {
switch(components[i]) {
case "Slider": addSlider(control.start, control.stop,
control.step, control.value);
break;
case "Label": addLabel(control.labels, control.start,
control.step, control.precision);
break;
default:
addButton(components[i], buttonLabels[i], control.pause);
}
}
el.rgltimer.Tick();
};
/**
* Apply all registered controls
* @param { Object } el - DOM element of the control
* @param { Object } x - List of actions to apply
* @param { boolean } [draw=true] - Whether to redraw after applying
*/
rglwidgetClass.prototype.applyControls = function(el, x, draw) {
var self = this, reinit = x.reinit, i, control, type;
for (i = 0; i < x.length; i++) {
control = x[i];
type = control.type;
self[type](el, control);
}
if (typeof reinit !== "undefined" && reinit !== null) {
reinit = [].concat(reinit);
for (i = 0; i < reinit.length; i++)
self.getObj(reinit[i]).initialized = false;
}
if (typeof draw === "undefined" || draw)
self.drawScene();
};
/**
* Handler for scene change
* @param { Object } message - What sort of scene change to do?
*/
rglwidgetClass.prototype.sceneChangeHandler = function(message) {
var self = document.getElementById(message.elementId).rglinstance,
objs = message.objects, mat = message.material,
root = message.rootSubscene,
initSubs = message.initSubscenes,
redraw = message.redrawScene,
skipRedraw = message.skipRedraw,
deletes, subs, allsubs = [], i,j;
if (typeof message.delete !== "undefined") {
deletes = [].concat(message.delete);
if (typeof message.delfromSubscenes !== "undefined")
subs = [].concat(message.delfromSubscenes);
else
subs = [];
for (i = 0; i < deletes.length; i++) {
for (j = 0; j < subs.length; j++) {
self.delFromSubscene(deletes[i], subs[j]);
}
delete self.scene.objects[deletes[i]];
}
}
if (typeof objs !== "undefined") {
Object.keys(objs).forEach(function(key){
key = parseInt(key, 10);
self.scene.objects[key] = objs[key];
self.initObj(key);
var obj = self.getObj(key),
subs = [].concat(obj.inSubscenes), k;
allsubs = allsubs.concat(subs);
for (k = 0; k < subs.length; k++)
self.addToSubscene(key, subs[k]);
});
}
if (typeof mat !== "undefined") {
self.scene.material = mat;
}
if (typeof root !== "undefined") {
self.scene.rootSubscene = root;
}
if (typeof initSubs !== "undefined")
allsubs = allsubs.concat(initSubs);
allsubs = self.unique(allsubs);
for (i = 0; i < allsubs.length; i++) {
self.initSubscene(allsubs[i]);
}
if (typeof skipRedraw !== "undefined") {
root = self.getObj(self.scene.rootSubscene);
root.par3d.skipRedraw = skipRedraw;
}
if (redraw)
self.drawScene();
};
/**
* Set mouse mode for a subscene
* @param { string } mode - name of mode
* @param { number } button - button number (1 to 3)
* @param { number } subscene - subscene id number
* @param { number } stayActive - if truthy, don't clear brush
*/
rglwidgetClass.prototype.setMouseMode = function(mode, button, subscene, stayActive) {
var sub = this.getObj(subscene),
which = ["left", "right", "middle"][button - 1];
if (!stayActive && sub.par3d.mouseMode[which] === "selecting")
this.clearBrush(null);
sub.par3d.mouseMode[which] = mode;
};
/**
* The class of an rgl timer object
* @class
*/
/**
* Construct an rgltimerClass object
* @constructor
* @param { function } Tick - action when timer fires
* @param { number } startTime - nominal start time in seconds
* @param { number } interval - seconds between updates
* @param { number } stopTime - nominal stop time in seconds
* @param { number } stepSize - nominal step size
* @param { number } value - current nominal time
* @param { number } rate - nominal units per second
* @param { string } loop - "none", "cycle" or "oscillate"
* @param { Object } actions - list of actions
*/
rgltimerClass = function(Tick, startTime, interval, stopTime, stepSize, value, rate, loop, actions) {
this.enabled = false;
this.timerId = 0;
/** nominal start time in seconds */
this.startTime = startTime;   
/** current nominal time */      
this.value = value;
/** seconds between updates */                 
this.interval = interval;
/** nominal stop time */           
this.stopTime = stopTime;
/** nominal step size */           
this.stepSize = stepSize;
/** nominal units per second */           
this.rate = rate;
/** "none", "cycle", or "oscillate" */                   
this.loop = loop;
/** real world start time */                   
this.realStart = undefined;
/** multiplier for fast-forward or reverse */         
this.multiplier = 1;                
this.actions = actions;
this.Tick = Tick;
};
/**
* Start playing timer object
*/
rgltimerClass.prototype.play = function() {
if (this.enabled) {
this.enabled = false;
window.clearInterval(this.timerId);
this.timerId = 0;
return;
}
var tick = function(self) {
var now = new Date();
self.value = self.multiplier*self.rate*(now - self.realStart)/1000 + self.startTime;
self.forceToRange();
if (typeof self.Tick !== "undefined") {
self.Tick(self.value);
}
};
this.realStart = new Date() - 1000*(this.value - this.startTime)/this.rate/this.multiplier;
this.timerId = window.setInterval(tick, 1000*this.interval, this);
this.enabled = true;
};
/**
* Force value into legal range
*/
rgltimerClass.prototype.forceToRange = function() {
if (this.value > this.stopTime + this.stepSize/2 || this.value < this.startTime - this.stepSize/2) {
if (!this.loop) {
this.reset();
} else {
var cycle = this.stopTime - this.startTime + this.stepSize,
newval = (this.value - this.startTime) % cycle + this.startTime;
if (newval < this.startTime) {
newval += cycle;
}
this.realStart += (this.value - newval)*1000/this.multiplier/this.rate;
this.value = newval;
}
}
};
/**
* Reset to start values
*/
rgltimerClass.prototype.reset = function() {
this.value = this.startTime;
this.newmultiplier(1);
if (typeof this.Tick !== "undefined") {
this.Tick(this.value);
}
if (this.enabled)
this.play();  /* really pause... */
if (typeof this.PlayButton !== "undefined")
this.PlayButton.value = "Play";
};
/**
* Increase the multiplier to play faster
*/
rgltimerClass.prototype.faster = function() {
this.newmultiplier(Math.SQRT2*this.multiplier);
};
/**
* Decrease the multiplier to play slower
*/
rgltimerClass.prototype.slower = function() {
this.newmultiplier(this.multiplier/Math.SQRT2);
};
/**
* Change sign of multiplier to reverse direction
*/
rgltimerClass.prototype.reverse = function() {
this.newmultiplier(-this.multiplier);
};
/**
* Set multiplier for play speed
* @param { number } newmult - new value
*/
rgltimerClass.prototype.newmultiplier = function(newmult) {
if (newmult != this.multiplier) {
this.realStart += 1000*(this.value - this.startTime)/this.rate*(1/this.multiplier - 1/newmult);
this.multiplier = newmult;
}
};
/**
* Take one step
*/
rgltimerClass.prototype.step = function() {
this.value += this.rate*this.multiplier;
this.forceToRange();
if (typeof this.Tick !== "undefined")
this.Tick(this.value);
};</script><div id="plotgroves_3Ddiv" class="rglWebGL">

</div>
<script type="text/javascript">
var plotgroves_3Ddiv = document.getElementById("plotgroves_3Ddiv"),
plotgroves_3Drgl = new rglwidgetClass();
plotgroves_3Ddiv.width = 673;
plotgroves_3Ddiv.height = 673;
plotgroves_3Drgl.initialize(plotgroves_3Ddiv,
{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":false,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0]},"rootSubscene":6,"objects":{"12":{"id":12,"type":"spheres","material":{},"vertices":[[-0.9949156,-1.362964,-0.7918071],[-0.6136786,-1.014338,-0.6798324],[2.666706,4.218828,-2.92926],[-13.60812,1.853951,1.094654],[2.197965,4.176379,-3.19599],[3.601282,4.86461,2.985327],[-7.934643,-16.00957,-0.007784056],[-0.6015099,-1.027714,-0.7772227],[-0.9949156,-1.362964,-0.7918071],[-0.6015099,-1.027714,-0.7772227],[-0.6071501,-1.02767,-0.7600724],[10.39432,-0.5055239,3.303895],[-8.220616,-10.05153,-3.407485],[-0.5427064,-1.072299,-0.6978133],[3.335418,4.157526,2.403558],[-0.0438281,2.763921,0.8655776],[-0.1646293,2.597969,0.1364589],[2.790806,4.938834,-2.092313],[10.5467,-10.76254,0.8196166],[-0.6117412,-2.21248,-0.2158628],[3.576294,4.872265,2.95932],[9.645061,-9.508871,1.647122],[3.870158,3.321538,2.054265],[-0.9260241,-0.8425136,-0.1084487],[-1.21909,-0.7161412,-0.763403],[2.472386,-7.161047,-0.7614649],[-8.862437,5.754373,-4.613686],[-1.21909,-0.7161412,-0.763403],[-14.57302,-1.706931,-1.299516],[-13.60248,1.853907,1.077504],[0.9178632,4.898732,1.359073],[2.278941,3.883534,-2.960994],[2.285686,5.619693,-2.162088],[-15.77487,0.3443657,3.902559],[2.149203,-14.41713,0.3786579],[-0.7909246,-0.5014425,0.1038729],[12.79081,-9.600045,2.137064],[0.9442719,1.037269,-0.6863963],[-1.248394,-0.3339338,-0.5918205],[3.982303,3.463745,2.218155],[-1.014263,-1.355353,-0.8349637],[2.019685,4.919504,-2.655126],[2.672347,4.218784,-2.94641],[3.600136,7.131599,-3.011472],[-0.3601551,-0.003023413,0.4189533],[3.37185,5.012124,-1.860255],[0.2525953,-13.06102,2.075024],[3.364723,3.775318,2.231975],[6.404612,7.012325,3.770709],[-0.9946995,0.3865269,0.08733879],[-9.421227,3.759625,-6.025177],[2.666706,4.218828,-2.92926],[-9.450078,-11.86661,-1.374805],[-0.6071501,-1.02767,-0.7600724],[13.17908,-8.322904,0.8663511],[1.820799,2.520865,0.7753312],[-1.249283,-0.320646,-0.5287309],[-0.9949156,-1.362964,-0.7918071],[2.437138,4.62733,-2.854346],[-13.04457,3.861943,2.552084],[-15.97055,-1.584011,1.221468],[-0.9133736,-1.370927,-1.087444],[-13.6311,-1.878582,-0.7507678],[3.647701,3.08391,2.28298],[0.6688659,-1.191303,-0.140546],[8.146827,-0.9391603,1.974874],[13.49343,-9.990533,1.522883],[4.043467,5.964764,-2.245874],[2.279157,5.633025,-2.081848],[-0.5806327,-1.031411,-1.064019],[2.366123,3.875527,-3.273781],[5.33313,7.565509,-1.232478],[-0.9949156,-1.362964,-0.7918071],[11.06656,-11.18433,1.00141],[-1.008407,0.3940936,0.02703187],[4.765381,6.987521,3.536032],[1.443811,1.377759,0.3129349],[-0.1713937,1.229759,-0.3469425],[2.026214,4.906172,-2.735366],[-8.753854,6.553636,-4.706606],[-0.8588281,-1.189885,-0.0073851],[-0.3302685,0.8685924,0.8328463],[3.900672,6.099016,-2.625947],[-0.0730717,1.229093,-0.9561538],[-16.52867,0.1463761,3.188743],[-0.9949156,-1.362964,-0.7918071],[2.472386,-7.161047,-0.7614649],[-9.650819,-11.80992,-1.393465],[-0.3359088,0.8686364,0.8499967],[-0.7965649,-0.5013985,0.1210232],[-0.5427064,-1.072299,-0.6978133],[1.049292,1.435853,-3.255288],[-1.21909,-0.7161412,-0.763403],[-15.67459,-1.763886,1.571694],[0.09799343,-0.2343741,0.3089316],[-9.347924,-3.789577,5.8859],[-0.4370131,0.6450718,0.6827733],[2.272412,3.896866,-2.880754],[-0.1768923,2.273135,0.7514774],[0.9551212,1.155463,0.5601541],[12.89756,-9.376524,2.287138],[5.510898,8.342071,-2.30107],[-10.46803,4.702755,11.18254],[-0.03999935,-5.514211,0.6504804],[9.528088,-8.229959,0.5600032],[3.589113,4.877986,3.082717],[4.423424,6.186438,3.84589],[0.04726566,0.01912063,1.425941],[-1.254171,-0.326994,-0.4859391],[2.361129,-7.316543,-0.9884453],[2.278941,3.883534,-2.960994],[-9.026934,4.081587,-6.073682],[2.07898,-7.496297,-0.7760493],[3.876686,3.308206,1.974025],[-6.461583,1.938578,7.473016],[2.031854,4.906128,-2.752517],[1.820354,1.762882,0.2447919],[-0.9949156,-1.362964,-0.7918071],[-1.014263,-1.355353,-0.8349637],[3.37749,5.01208,-1.877406],[0.1990978,-0.01080956,0.476155],[-0.1722819,1.243047,-0.2838529],[-1.008623,-1.355397,-0.852114],[4.15244,5.136487,3.661001],[-1.008407,0.3940936,0.02703187],[2.284581,3.88349,-2.978145],[-0.6071501,-1.02767,-0.7600724],[-0.5190526,-1.366221,0.424741],[2.081284,4.526616,-3.236537],[-16.56018,0.1673626,3.242977],[2.466883,-7.168068,-0.7494568],[-9.05281,4.10253,-6.036599],[3.480767,-10.8784,0.05950833],[-0.9958039,-1.349676,-0.7287175],[-0.988171,0.3731951,0.007098861],[4.035466,3.419204,2.314715],[-0.9949156,-1.362964,-0.7918071],[-1.324707,-0.8716806,-1.007534],[-0.9892754,-1.363008,-0.8089575],[3.568661,3.149394,2.223504],[-0.6071501,-1.02767,-0.7600724],[-7.668365,-1.00514,8.065874],[-0.3359088,0.8686364,0.8499967],[6.724702,-2.102284,1.887105],[-0.2773799,0.03595839,-0.2803444],[-0.6330262,-1.006727,-0.722989],[2.842484,5.891526,-1.503564],[0.09799343,-0.2343741,0.3089316],[2.928888,0.4612405,-5.002173],[3.203209,-9.87334,-0.2723051],[-0.3359088,0.8686364,0.8499967],[2.872347,-8.007597,-0.2230042],[4.32578,4.519807,2.75819],[-1.254171,-0.326994,-0.4859391],[2.836843,5.89157,-1.486414],[-1.007519,0.3808058,-0.03605772],[-0.9150134,-1.351248,-1.049996],[3.575406,4.885553,3.02241],[-0.9892754,-1.363008,-0.8089575],[-0.7071266,-1.183253,-1.021353],[-0.7127668,-1.183209,-1.004203],[2.266338,5.627304,-2.205245],[3.588897,3.128495,2.203571],[-1.011806,-1.368392,-0.8145414],[-9.256525,-11.48796,-1.44197],[2.33077,4.295294,-3.075832],[-0.1650351,-1.928836,-0.109861],[3.302903,4.009464,2.178162],[-0.9946995,0.3865269,0.08733879],[-16.21866,-0.02887561,3.322196],[3.588897,3.128495,2.203571],[-0.9825308,0.3731511,-0.01005148],[9.528088,-8.229959,0.5600032],[-0.6061009,-2.212524,-0.2330132],[2.736562,4.199468,-3.355089],[3.461065,7.742516,-1.645683],[2.278941,3.883534,-2.960994],[3.636803,-10.45828,-0.2914855],[2.472386,-7.161047,-0.7614649],[8.146827,-0.9391603,1.974874],[2.278941,3.883534,-2.960994],[-0.9958039,-1.349676,-0.7287175],[-9.250884,-11.488,-1.459121],[0.8596571,0.9318544,0.3757803],[0.7747498,10.07784,12.87482],[0.04726566,0.01912063,1.425941],[-15.88901,-1.591975,0.9258308],[0.4049706,1.739325,0.1999322],[2.425573,-7.361172,-0.9261863],[-0.6136786,-1.014338,-0.6798324],[-0.607013,-1.034735,-0.7652147],[-0.9199021,-1.357596,-1.007204],[2.284581,3.88349,-2.978145],[-0.6071501,-1.02767,-0.7600724],[-0.7656767,0.2020851,-1.010844],[4.1468,5.136531,3.678151],[-13.1809,1.525475,2.322809],[12.89756,-9.376524,2.287138],[4.262887,8.196048,12.9064],[2.026214,4.906172,-2.735366],[3.363674,7.458473,-2.639853]],"colors":[[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.5960785,0.8235294,0.4666667,1],[0.9960784,0.5960785,0.172549,1],[0.4901961,0.3294118,0.6470588,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.4901961,0.3294118,0.6470588,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.5960785,0.8235294,0.4666667,1],[0.4901961,0.3294118,0.6470588,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6941177,0.3490196,0.1568628,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.4901961,0.3294118,0.6470588,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.945098,0.4,0.4039216,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.4901961,0.3294118,0.6470588,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1],[0.6941177,0.3490196,0.1568628,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.4901961,0.3294118,0.6470588,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.6509804,0.8078431,0.8901961,1],[0.945098,0.4,0.4039216,1],[0.6509804,0.8078431,0.8901961,1],[0.6941177,0.3490196,0.1568628,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.5960785,0.8235294,0.4666667,1],[0.6509804,0.8078431,0.8901961,1],[0.6509804,0.8078431,0.8901961,1],[0.9960784,0.5960785,0.172549,1],[0.945098,0.4,0.4039216,1],[0.6941177,0.3490196,0.1568628,1],[0.9960784,0.5960785,0.172549,1],[0.5960785,0.8235294,0.4666667,1],[0.5960785,0.8235294,0.4666667,1]],"radii":[[0.6363989]],"centers":[[-0.9949156,-1.362964,-0.7918071],[-0.6136786,-1.014338,-0.6798324],[2.666706,4.218828,-2.92926],[-13.60812,1.853951,1.094654],[2.197965,4.176379,-3.19599],[3.601282,4.86461,2.985327],[-7.934643,-16.00957,-0.007784056],[-0.6015099,-1.027714,-0.7772227],[-0.9949156,-1.362964,-0.7918071],[-0.6015099,-1.027714,-0.7772227],[-0.6071501,-1.02767,-0.7600724],[10.39432,-0.5055239,3.303895],[-8.220616,-10.05153,-3.407485],[-0.5427064,-1.072299,-0.6978133],[3.335418,4.157526,2.403558],[-0.0438281,2.763921,0.8655776],[-0.1646293,2.597969,0.1364589],[2.790806,4.938834,-2.092313],[10.5467,-10.76254,0.8196166],[-0.6117412,-2.21248,-0.2158628],[3.576294,4.872265,2.95932],[9.645061,-9.508871,1.647122],[3.870158,3.321538,2.054265],[-0.9260241,-0.8425136,-0.1084487],[-1.21909,-0.7161412,-0.763403],[2.472386,-7.161047,-0.7614649],[-8.862437,5.754373,-4.613686],[-1.21909,-0.7161412,-0.763403],[-14.57302,-1.706931,-1.299516],[-13.60248,1.853907,1.077504],[0.9178632,4.898732,1.359073],[2.278941,3.883534,-2.960994],[2.285686,5.619693,-2.162088],[-15.77487,0.3443657,3.902559],[2.149203,-14.41713,0.3786579],[-0.7909246,-0.5014425,0.1038729],[12.79081,-9.600045,2.137064],[0.9442719,1.037269,-0.6863963],[-1.248394,-0.3339338,-0.5918205],[3.982303,3.463745,2.218155],[-1.014263,-1.355353,-0.8349637],[2.019685,4.919504,-2.655126],[2.672347,4.218784,-2.94641],[3.600136,7.131599,-3.011472],[-0.3601551,-0.003023413,0.4189533],[3.37185,5.012124,-1.860255],[0.2525953,-13.06102,2.075024],[3.364723,3.775318,2.231975],[6.404612,7.012325,3.770709],[-0.9946995,0.3865269,0.08733879],[-9.421227,3.759625,-6.025177],[2.666706,4.218828,-2.92926],[-9.450078,-11.86661,-1.374805],[-0.6071501,-1.02767,-0.7600724],[13.17908,-8.322904,0.8663511],[1.820799,2.520865,0.7753312],[-1.249283,-0.320646,-0.5287309],[-0.9949156,-1.362964,-0.7918071],[2.437138,4.62733,-2.854346],[-13.04457,3.861943,2.552084],[-15.97055,-1.584011,1.221468],[-0.9133736,-1.370927,-1.087444],[-13.6311,-1.878582,-0.7507678],[3.647701,3.08391,2.28298],[0.6688659,-1.191303,-0.140546],[8.146827,-0.9391603,1.974874],[13.49343,-9.990533,1.522883],[4.043467,5.964764,-2.245874],[2.279157,5.633025,-2.081848],[-0.5806327,-1.031411,-1.064019],[2.366123,3.875527,-3.273781],[5.33313,7.565509,-1.232478],[-0.9949156,-1.362964,-0.7918071],[11.06656,-11.18433,1.00141],[-1.008407,0.3940936,0.02703187],[4.765381,6.987521,3.536032],[1.443811,1.377759,0.3129349],[-0.1713937,1.229759,-0.3469425],[2.026214,4.906172,-2.735366],[-8.753854,6.553636,-4.706606],[-0.8588281,-1.189885,-0.0073851],[-0.3302685,0.8685924,0.8328463],[3.900672,6.099016,-2.625947],[-0.0730717,1.229093,-0.9561538],[-16.52867,0.1463761,3.188743],[-0.9949156,-1.362964,-0.7918071],[2.472386,-7.161047,-0.7614649],[-9.650819,-11.80992,-1.393465],[-0.3359088,0.8686364,0.8499967],[-0.7965649,-0.5013985,0.1210232],[-0.5427064,-1.072299,-0.6978133],[1.049292,1.435853,-3.255288],[-1.21909,-0.7161412,-0.763403],[-15.67459,-1.763886,1.571694],[0.09799343,-0.2343741,0.3089316],[-9.347924,-3.789577,5.8859],[-0.4370131,0.6450718,0.6827733],[2.272412,3.896866,-2.880754],[-0.1768923,2.273135,0.7514774],[0.9551212,1.155463,0.5601541],[12.89756,-9.376524,2.287138],[5.510898,8.342071,-2.30107],[-10.46803,4.702755,11.18254],[-0.03999935,-5.514211,0.6504804],[9.528088,-8.229959,0.5600032],[3.589113,4.877986,3.082717],[4.423424,6.186438,3.84589],[0.04726566,0.01912063,1.425941],[-1.254171,-0.326994,-0.4859391],[2.361129,-7.316543,-0.9884453],[2.278941,3.883534,-2.960994],[-9.026934,4.081587,-6.073682],[2.07898,-7.496297,-0.7760493],[3.876686,3.308206,1.974025],[-6.461583,1.938578,7.473016],[2.031854,4.906128,-2.752517],[1.820354,1.762882,0.2447919],[-0.9949156,-1.362964,-0.7918071],[-1.014263,-1.355353,-0.8349637],[3.37749,5.01208,-1.877406],[0.1990978,-0.01080956,0.476155],[-0.1722819,1.243047,-0.2838529],[-1.008623,-1.355397,-0.852114],[4.15244,5.136487,3.661001],[-1.008407,0.3940936,0.02703187],[2.284581,3.88349,-2.978145],[-0.6071501,-1.02767,-0.7600724],[-0.5190526,-1.366221,0.424741],[2.081284,4.526616,-3.236537],[-16.56018,0.1673626,3.242977],[2.466883,-7.168068,-0.7494568],[-9.05281,4.10253,-6.036599],[3.480767,-10.8784,0.05950833],[-0.9958039,-1.349676,-0.7287175],[-0.988171,0.3731951,0.007098861],[4.035466,3.419204,2.314715],[-0.9949156,-1.362964,-0.7918071],[-1.324707,-0.8716806,-1.007534],[-0.9892754,-1.363008,-0.8089575],[3.568661,3.149394,2.223504],[-0.6071501,-1.02767,-0.7600724],[-7.668365,-1.00514,8.065874],[-0.3359088,0.8686364,0.8499967],[6.724702,-2.102284,1.887105],[-0.2773799,0.03595839,-0.2803444],[-0.6330262,-1.006727,-0.722989],[2.842484,5.891526,-1.503564],[0.09799343,-0.2343741,0.3089316],[2.928888,0.4612405,-5.002173],[3.203209,-9.87334,-0.2723051],[-0.3359088,0.8686364,0.8499967],[2.872347,-8.007597,-0.2230042],[4.32578,4.519807,2.75819],[-1.254171,-0.326994,-0.4859391],[2.836843,5.89157,-1.486414],[-1.007519,0.3808058,-0.03605772],[-0.9150134,-1.351248,-1.049996],[3.575406,4.885553,3.02241],[-0.9892754,-1.363008,-0.8089575],[-0.7071266,-1.183253,-1.021353],[-0.7127668,-1.183209,-1.004203],[2.266338,5.627304,-2.205245],[3.588897,3.128495,2.203571],[-1.011806,-1.368392,-0.8145414],[-9.256525,-11.48796,-1.44197],[2.33077,4.295294,-3.075832],[-0.1650351,-1.928836,-0.109861],[3.302903,4.009464,2.178162],[-0.9946995,0.3865269,0.08733879],[-16.21866,-0.02887561,3.322196],[3.588897,3.128495,2.203571],[-0.9825308,0.3731511,-0.01005148],[9.528088,-8.229959,0.5600032],[-0.6061009,-2.212524,-0.2330132],[2.736562,4.199468,-3.355089],[3.461065,7.742516,-1.645683],[2.278941,3.883534,-2.960994],[3.636803,-10.45828,-0.2914855],[2.472386,-7.161047,-0.7614649],[8.146827,-0.9391603,1.974874],[2.278941,3.883534,-2.960994],[-0.9958039,-1.349676,-0.7287175],[-9.250884,-11.488,-1.459121],[0.8596571,0.9318544,0.3757803],[0.7747498,10.07784,12.87482],[0.04726566,0.01912063,1.425941],[-15.88901,-1.591975,0.9258308],[0.4049706,1.739325,0.1999322],[2.425573,-7.361172,-0.9261863],[-0.6136786,-1.014338,-0.6798324],[-0.607013,-1.034735,-0.7652147],[-0.9199021,-1.357596,-1.007204],[2.284581,3.88349,-2.978145],[-0.6071501,-1.02767,-0.7600724],[-0.7656767,0.2020851,-1.010844],[4.1468,5.136531,3.678151],[-13.1809,1.525475,2.322809],[12.89756,-9.376524,2.287138],[4.262887,8.196048,12.9064],[2.026214,4.906172,-2.735366],[3.363674,7.458473,-2.639853]],"ignoreExtent":false,"flags":3},"14":{"id":14,"type":"text","material":{"lit":false},"vertices":[[-1.533377,-21.30467,-9.926165]],"colors":[[0,0,0,1]],"texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-1.533377,-21.30467,-9.926165]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"15":{"id":15,"type":"text","material":{"lit":false},"vertices":[[-22.66032,-2.965865,-9.926165]],"colors":[[0,0,0,1]],"texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-22.66032,-2.965865,-9.926165]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"16":{"id":16,"type":"text","material":{"lit":false},"vertices":[[-22.66032,-21.30467,3.41636]],"colors":[[0,0,0,1]],"texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-22.66032,-21.30467,3.41636]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":2064},"10":{"id":10,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"9":{"id":9,"type":"background","material":{"fog":true},"colors":[[0.2980392,0.2980392,0.2980392,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"11":{"id":11,"type":"background","material":{"lit":false,"back":"lines"},"colors":[[1,1,1,1]],"centers":[[0,0,0]],"sphere":false,"fogtype":"none","flags":0},"13":{"id":13,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":[[-15,"NA","NA"],[-10,"NA","NA"],[-5,"NA","NA"],[0,"NA","NA"],[5,"NA","NA"],[10,"NA","NA"],["NA",-15,"NA"],["NA",-10,"NA"],["NA",-5,"NA"],["NA",0,"NA"],["NA",5,"NA"],["NA",10,"NA"],["NA","NA",-5],["NA","NA",0],["NA","NA",5],["NA","NA",10]],"colors":[[0,0,0,1]],"draw_front":true,"newIds":[24,25,26,27,28,29,30]},"6":{"id":6,"type":"subscene","par3d":{"antialias":16,"FOV":30,"ignoreExtent":false,"listeners":6,"mouseMode":{"left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,113.2858],"modelMatrix":[[0.8470181,0,0,1.298798],[0,0.3337413,1.260309,-3.315837],[0,-0.9169466,0.458715,-117.5725],[0,0,0,1]],"projMatrix":[[3.732051,0,0,0],[0,3.732051,0,0],[0,0,-3.863704,-408.3821],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.3420201,0.9396926,0],[0,-0.9396926,0.3420201,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.8470181,0.9757943,1.341193],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-17.31153,14.24477,-16.66176,10.73003,-6.548184,13.3809],"windowRect":[0,45,672,717],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/Library/Frameworks/R.framework/Versions/4.0/Resources/library/rgl/fonts/FreeSans.ttf","maxClipPlanes":6,"glVersion":2.1,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[11,13,12,14,15,16,10,24,25,26,27,28,29,30],"subscenes":[],"flags":2643},"24":{"id":24,"type":"lines","material":{"lit":false},"vertices":[[-15,-17.07264,-6.84712],[10,-17.07264,-6.84712],[-15,-17.07264,-6.84712],[-15,-17.77798,-7.360294],[-10,-17.07264,-6.84712],[-10,-17.77798,-7.360294],[-5,-17.07264,-6.84712],[-5,-17.77798,-7.360294],[0,-17.07264,-6.84712],[0,-17.77798,-7.360294],[5,-17.07264,-6.84712],[5,-17.77798,-7.360294],[10,-17.07264,-6.84712],[10,-17.77798,-7.360294]],"colors":[[0,0,0,1]],"centers":[[-2.5,-17.07264,-6.84712],[-15,-17.42531,-7.103707],[-10,-17.42531,-7.103707],[-5,-17.42531,-7.103707],[0,-17.42531,-7.103707],[5,-17.42531,-7.103707],[10,-17.42531,-7.103707]],"ignoreExtent":true,"origId":13,"flags":64},"25":{"id":25,"type":"text","material":{"lit":false},"vertices":[[-15,-19.18865,-8.386642],[-10,-19.18865,-8.386642],[-5,-19.18865,-8.386642],[0,-19.18865,-8.386642],[5,-19.18865,-8.386642],[10,-19.18865,-8.386642]],"colors":[[0,0,0,1]],"texts":[["-15"],["-10"],["-5"],["0"],["5"],["10"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-15,-19.18865,-8.386642],[-10,-19.18865,-8.386642],[-5,-19.18865,-8.386642],[0,-19.18865,-8.386642],[5,-19.18865,-8.386642],[10,-19.18865,-8.386642]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":13,"flags":2064},"26":{"id":26,"type":"lines","material":{"lit":false},"vertices":[[-17.78487,-15,-6.84712],[-17.78487,10,-6.84712],[-17.78487,-15,-6.84712],[-18.59744,-15,-7.360294],[-17.78487,-10,-6.84712],[-18.59744,-10,-7.360294],[-17.78487,-5,-6.84712],[-18.59744,-5,-7.360294],[-17.78487,0,-6.84712],[-18.59744,0,-7.360294],[-17.78487,5,-6.84712],[-18.59744,5,-7.360294],[-17.78487,10,-6.84712],[-18.59744,10,-7.360294]],"colors":[[0,0,0,1]],"centers":[[-17.78487,-2.5,-6.84712],[-18.19116,-15,-7.103707],[-18.19116,-10,-7.103707],[-18.19116,-5,-7.103707],[-18.19116,0,-7.103707],[-18.19116,5,-7.103707],[-18.19116,10,-7.103707]],"ignoreExtent":true,"origId":13,"flags":64},"27":{"id":27,"type":"text","material":{"lit":false},"vertices":[[-20.22259,-15,-8.386642],[-20.22259,-10,-8.386642],[-20.22259,-5,-8.386642],[-20.22259,0,-8.386642],[-20.22259,5,-8.386642],[-20.22259,10,-8.386642]],"colors":[[0,0,0,1]],"texts":[["-15"],["-10"],["-5"],["0"],["5"],["10"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-20.22259,-15,-8.386642],[-20.22259,-10,-8.386642],[-20.22259,-5,-8.386642],[-20.22259,0,-8.386642],[-20.22259,5,-8.386642],[-20.22259,10,-8.386642]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":13,"flags":2064},"28":{"id":28,"type":"lines","material":{"lit":false},"vertices":[[-17.78487,-17.07264,-5],[-17.78487,-17.07264,10],[-17.78487,-17.07264,-5],[-18.59744,-17.77798,-5],[-17.78487,-17.07264,0],[-18.59744,-17.77798,0],[-17.78487,-17.07264,5],[-18.59744,-17.77798,5],[-17.78487,-17.07264,10],[-18.59744,-17.77798,10]],"colors":[[0,0,0,1]],"centers":[[-17.78487,-17.07264,2.5],[-18.19116,-17.42531,-5],[-18.19116,-17.42531,0],[-18.19116,-17.42531,5],[-18.19116,-17.42531,10]],"ignoreExtent":true,"origId":13,"flags":64},"29":{"id":29,"type":"text","material":{"lit":false},"vertices":[[-20.22259,-19.18865,-5],[-20.22259,-19.18865,0],[-20.22259,-19.18865,5],[-20.22259,-19.18865,10]],"colors":[[0,0,0,1]],"texts":[["-5"],["0"],["5"],["10"]],"cex":[[1]],"adj":[[0.5,0.5]],"centers":[[-20.22259,-19.18865,-5],[-20.22259,-19.18865,0],[-20.22259,-19.18865,5],[-20.22259,-19.18865,10]],"family":[["sans"]],"font":[[1]],"ignoreExtent":true,"origId":13,"flags":2064},"30":{"id":30,"type":"lines","material":{"lit":false},"vertices":[[-17.78487,-17.07264,-6.84712],[-17.78487,11.14091,-6.84712],[-17.78487,-17.07264,13.67984],[-17.78487,11.14091,13.67984],[-17.78487,-17.07264,-6.84712],[-17.78487,-17.07264,13.67984],[-17.78487,11.14091,-6.84712],[-17.78487,11.14091,13.67984],[-17.78487,-17.07264,-6.84712],[14.71812,-17.07264,-6.84712],[-17.78487,-17.07264,13.67984],[14.71812,-17.07264,13.67984],[-17.78487,11.14091,-6.84712],[14.71812,11.14091,-6.84712],[-17.78487,11.14091,13.67984],[14.71812,11.14091,13.67984],[14.71812,-17.07264,-6.84712],[14.71812,11.14091,-6.84712],[14.71812,-17.07264,13.67984],[14.71812,11.14091,13.67984],[14.71812,-17.07264,-6.84712],[14.71812,-17.07264,13.67984],[14.71812,11.14091,-6.84712],[14.71812,11.14091,13.67984]],"colors":[[0,0,0,1]],"centers":[[-17.78487,-2.965865,-6.84712],[-17.78487,-2.965865,13.67984],[-17.78487,-17.07264,3.416359],[-17.78487,11.14091,3.416359],[-1.533377,-17.07264,-6.84712],[-1.533377,-17.07264,13.67984],[-1.533377,11.14091,-6.84712],[-1.533377,11.14091,13.67984],[14.71812,-2.965865,-6.84712],[14.71812,-2.965865,13.67984],[14.71812,-17.07264,3.416359],[14.71812,11.14091,3.416359]],"ignoreExtent":true,"origId":13,"flags":64}},"snapshot":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAKgCAIAAADLXliSAAAAHXRFWHRTb2Z0d2FyZQBSL1JHTCBwYWNrYWdlL2xpYnBuZ7GveO8AACAASURBVHic7N0HWFRX3j9wdzf7Zl8T3xQ7TboFCxZUEOnSe++9996kFwUBkW6niBoVpViwA5pYE8ESY8doNMYkYmKLBe7/ILv+XU0Uhpk5w+X7ebI+7ABzzx1m7vf87j33nCEMAAAAsM4Q2g0AAAAA7kPAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeABAABYCAEPAADAQgh4AAAAFkLAAwAAsBACHgAAgIUQ8AAAACyEgAcAAGAhBDwAAAALIeCBvsuXL7e1tb148eLVI3fv3t2yZcvG1xw7duz1H+BDG3qcOnWqtrb23LlzPN36K/zf8bfxeZffQP0V+NN3At3XBIAzCHigz9raOjQ09PHjx68eIYf4oUOHDnmNk5PTo0eP+NkGsjljY+N//vOfw4YN+9vf/ubm5sbTBvTg/46/jsouv4HuK8C89U4QhNcEgDMIeKCGHCiPHDkSGRn54YcfBgYGvh6u2dnZ06ZNu3379oP/+OOPP/jchuTk5BEjRrS0tJCiraamhqTO6tWrnz59yotmvMK3Hf9TVHb5DbRegb96JwjCawLAGQQ8UEMOlyIiIsOHD//HP/7xRrj6+PiYmpo+fPiQVhvI0VxSUjIsLOzVI6Q9WlpaJG942h6+7fjbaO3yG2i9An/6ThCQ1wSAMwh4oG/69OnBwcGvB7y2tjZ5ZNeuXUVFRRs3brx3715XVxc/23Dp0qVhw4aRg/7z5897HsnJyRk5cuT9+/d52gz+7/grtHb5DRRfgR6vvxME5DUB4AwCHuh7O+BlZGQ++uijzz77bPLkyf/617+EhISOHz/O0/FNb7Shqanp448/fn1414YNG4YOHXrjxg2e5g3/d/wVWrv8BoqvQI/X3wkC8poAcAYBD/S9Ea5PnjxRVFQMCwv7/fffyf8lB9Np06aRR3h6XvSNNjQ2NpKYaWtr6+zs7Hlk69at5Mh+4cKFV49wHZUdf4XKLr+B7ivQ4/V3giC8JgAcQ8ADn7S0tHzyySf/eCkkJOT1ev3tCv4NVVVV5Kh68eLFfpZNvW/DwYMHSel24sSJV6VbdXU1acOtW7e4WLq9oz09uLXjvcGfXe4rfr4CPV5/JwjmawLQSwh44BNyxCSH6e9e+umnn14/Pr434HuOs0eOHOnnqdret4GUaMOGDaurq3t18TU3N3f48OHcvfj6jvb04NaO9wZ/drmv+PkK9Hj9nSCYrwlALyHggb43wpXUtWpqaleuXHl1FnT58uXkOMvTC59vtIFsWkpKKj4+/smTJz2PmJuba2tr8/RcMZUdf4XKLr+B7ivQ4/V3giC8JgAcQ8ADfW+E671794SFhY2MjO7cuUMO66S6nThxoq2tLU8nGHn7LEJCQoKoqOj58+fJUf7AgQOkjiwvL3/27Bnv2kBlx1/H/11+A/VXgHnrnUD9NQHgGAIe6Hs7XBsbG4WEhD788MNRo0b9/e9/NzAw+NMz2DxtA/mabJeUj9LS0h988IGXl9c7LiJwC/93/HVUdvkNdF8B5q13giC8JgCcQcCDgHrw4MGePXu2bNly+vRpWhOAk1w5ceLEpk2bTp06xbc20N1xKrv8BkH4079OEF4TAA4g4AEAAFgIAQ8AAMBCCHgAAAAWQsADAACwEAIeAACAhRDwAAAALISABwAAYCEEPAAAAAsh4AEAAFgIAQ8AAMBCCHgAAAAWQsCDoFBTU2ttbaXbBnl5+fb2dupt6OjooNsGcXFxug0grwB5Hei2gbwTyHuSbhsA+gMBD4KCHEybmprotoGECvVOxqeffko94IcMoXxkIOFKXge6bSDvBOqdDID+QMCDoEDA90DAMy8DnvpZBAQ8DHQIeBAUpqamtbW1dNsgCAFPgo36ZQIEPEG6mzhFDwMaAh4Ehaura3l5Od02CMJZBAQ8g4AH4AYEPAgKBHwPBDyDgAfgBgQ8CIrQ0ND8/Hy6bUDA96Ae8IJw/bu2ttbU1JRuGwD6AwEPgkJAAp76OAAEPCMYAV9eXu7q6kq3DQD9gYAHQZHyEt02CMJAPwQ8g4AH4AYEPAgKBHwPBDyDgAfgBgQ8CAqS7qGhoXTbIAgD/ajfqtfR0UF9khlBGOCWn59P/Q0J0B8IeBAUgnA8RcAzCPj/EIQ3JEB/IOBBUAjCGVEEPIOA/w9BOKUE0B8IeBAUJFmp35UkCCP5EfCMwAQ89UEhAP2BgAdBIQi3HSPgGcEIeAF5MyDgYUBDwIOgEJBjOgIeAd9DEN4MAP2BgAdBIQhnZQWhaEPAM4IR8IIwIAOgPxDwICgEIeAF4bIrAp4RjAEZCHgY6BDw0F/t7e2h3ECOpyRXuPJUHCM9DJKvdNsgLi5Oso1iAwThD0FeAfI60G0DeSeQ9wOtrVOf7AhYAAEP/UKqPXIcJIfjfADgEtKxoH4SBVgAAQ/9Qg5GQ4YMoX5aG4BNej5WuEAA/YSAB86R8v3V+WTabQFgD9Jj7rlQQrshMLAh4IFzpM4g6S4IM9ABsEnoyzv0yMcK58agPxDwwKGe8r2pqUkQ7mgCYJOeAfyCcDsDDGgIeOAQqS16ch0BD8Bdr+7QQxEP/YGAB0701BY9t2uTgKd+/zrwFPlzH2pprt1URfcG/cGD9JjJx4r5zwcNt8wBZxDwwImeQUA9XwvCBDXAI/fvd5TEOWabjy62FapwFcm3HrvMTmjDmiLa7WK5VwHPvCziMcYFOIOAhz7rufr+qpgjX8jLy9NtEvDCsa9aMqylq9xE9oaIH4qQOBEn1RQu0Rg0rthOKMtTlXbr2Iz0mEm/uedrFPHAMQQ89Nkb62STQw/Je4rtAV4guZLrI7fRU7QlUuK7FJmr6bI/ZI2/nC57Jkl6T4j4aifhnDgf2m1kLdJjfhXwzMtB9SjigQMIeOibnjh/vZ4gX2OsL/ssXehTYDOWlOzfJsv8nD/54aqZzyrnPiyWv5k1oS1BekfAuESDUa+HEGdIN2JfY311yaLicOOyVL/i3HSUqsxb6xGQV2nIkCF4ZaCvEPDQN28vx4KbeVgp03H6OneRozGSNxaPf7JWkTmeyFxZzhxx/71o6pUM2YNhEmX2QmsKMvqziZbmpsWeqqX2QpWuItt8xTZ5ia5xFi5wEKpePdiv8b/Rh2b+e9QLQC8h4KEP3i7fGQQ8G5HyMVZ3xBZv0VMLpW8tnfJitwXD7GOYX5gnpU8qlK5ljj8SI7naSTgjxI7jTRxqaU6xkK5wET4QJnEsVup0knRrgvSRaMkdgeMKbMaWxDlycXcGnL/6lKGIhz5BwEMfhP7FculDhuCNxCp1dbVR2iM2eIgejZH6IXvSkwZD5tEm5tlvzPfhD0unX86QbQqXWO4gFGWnzNnzk7hKdVMhhTtJ97NJMt8vHn8nd9KPSyZcXzT+m4XSu4LG5VuN3dFQx92dGkBIlpOX6I0HUcRDX+G4DL3VU76/fdxh/uJ4BAMX+Wt6Kn+22lm4OULiu1TZX8tmd61XZXbbPF+reDt74unE7gzOsxqzKNqbs+evWlWUYTKq3n8ceapbuZOfrZzetUG5s3zO46Ip7ZmyJ+Ol1rmLRBlKcnenBpA/7TH33L2CIh56DwEPvfWOSbUQ8OxjpzEp03R0jbfYV9GS36WN/37xhNsFM65ljicFN0n9KjeRcK0RRYXLOHvy5EDbUnuhfSHipPdwv2Tmi6+jmZ8OMHeyujZr/Jw3iaR+g/+4LLPRgzbM/uqUWHl5OWaNhN5DwEOvtLa2viPFUViwT11drYfyZ8usx271EWsKlzgaK3UiTupItOTeEPH17iKZJqPddeQ47tX5G04usRMiHYVLGeN/36TFXExnmBsM08Q02dzNk/s2WWZX0LhUo9EtzU1c3aeB4d2DWl6fggLg3RDw0CvvnhP7jbt6gB08HCz8VD/PNh+9xll4o6foZm/RDR6iZfZCqUajLGb8X3/ukfNd0D1bzp4Q8fMpsh0FU198G8A8aGbur+2sVrmdPaE1QbrOTyzDZHRD/WC8DP/uiSVIEY+JI6GXEPDwfuRQ/ldX33sg4NkqJjLMaOqwEI3hsbojkw1HRWmP8Jr/uZPB3FcTqXIm0F4n3XjUVl+x47FS1zLHPyqb9aJK7WmF4i95chdTZb6Mkqx0EwlQ+3xwnhZ678xRKOKhlxDw8H6kYsjPz3/3D/R/zhMQTCRLFqWn2pto2evNcbO3SEtN6f94i0XpKYFqw1c6Cu8OFj8RJ/Vd6vhriydezRx/LlnmSIxknf+4HIsxgZZKXGn/gPPeuZ9JEY/JoaE3EPDwHu8t3xkEPPSdq9HcGJ0RKxyEGvzHHQyX+DJa8nCU5L5Q8RofsXzrse7zPmselBfgmZefuPfmN/lI9vMkCgwGCHh4j/eW78x/L34F0Bvt7e2GU4dFLhhBivU1zsLr3EQqXUWWOwhlmIzynv95bGQY7QZS05vlGcnHDQtAwHsh4OFdeo4j7z0l6+rqWl5ezpcWAXu0traaairYKXzip/p5xIIRwRrDSbQbzhIqKODw7jt2IB+63gyjQxEP74WAh3chB5reJHdoaOh7q3yAP0VSKiUlxdPRIiYyjLzZBufAuteRF6E3M9ahiIf3QsDDXyJHkF6O5UHAA3BLLwOeeXn3Cs6cwTsg4OEvkfK9l+cA/2qOegDoK9JXJh+o3vxkz/RTvG4PDFwIePhzvbwQ2OPtNWQBgDO9D3im1xfRYHBCwMOfk5eX7/2db306JAHAO/Spu4wiHt4BAQ9/oq9rWpCAx0KWAFzR1/Nh5KOKIh7+FAIe3tTR0dGn8p3py7AgAHi3vg5ZbW9vRxEPfwoBD28iB5e+LklZW1uLVSwBuIKDWSXIpw+3scDbEPDwX0j5Li4u3td5ZxHwANzCwSl3FPHwpxDw8F9SUlI4iOreTK4JAL3B2cTP717QGQYnBDz8f6R8J3UAB8vGvHf9KwDopd7PP/G6ng8v5gGE1yHg4f/jrHxnEPAA3MPx2owo4uENCHj4t56r7ySqOfhdUjdgWmwAriB9Zc4+hiji4Q0IePg30vfn+Fa3niMLd9sDMDiRvjLHIe36ElebAwMYAh669ad8ZxDwANzTn4Ann8QhQ4agiIceCHjoRsr3fs41Sw4r3GoMwGDWz9Ps5IOMIh564KAM/76C3s9ePwl4Uj1wqUUAg1c/P0oo4uEVBDxwZ7FXUnYg4AH6r/8nw/ozngbYBAE/2PWU7/3PZgQ8QP/11N/9f5L+n5MDFkDAD3bcune2P2P0+Iwc/g41N1eVlZF/0SkBgcKtO045WFEC2AcBP6hxq3xn+nHzLj+RPS1LSV2koZE7T7lEVTVzrmLszJlxJiaodUBAcCvgUcQDg4Af5Lg49VVfV5jlvxvXr+fZ2BSrqG7W1dtuYLjXxLRO32Czrm7+/Pn+U6Zsqa6m3UAAbk4KWV5e3tci/vLly21tbS9evHj9wVOnTtXW1p47d+6Nx0HwIeAHL5LHXLxwzvH8mnxTHBi0XE19h6HRcSvrU9Y2Z+3sv7a2+crCslZfv0RVLXTaADgDAazH3Vmf+3rhzNraOjQ09PHjxz3/99GjR8bGxv/85z+HDRv2t7/9zc3NjTzCrbYBHyDgBy/Su+fizNWcrZDBN2tLS3PmzdtpZHTMyvqqi8udgMB7wSG3vLy/tXc4ZG6xTU8/Y+5cR0VF2s2EwY67CzOSIr433QUS20eOHImMjPzwww8DAwNfBXxycvKIESNaWlpI7V5TUzN06NDVq1c/ffqUW80DXkPAD1LkOMKtq+89OFjEmp+KAgNXa2geNDW74OT8i4/vH/nLmA0bOvPzb3t6nbaz32VkXKqq5jd5Cq5ZAl1cX3mZfMzfe2qNhLeIiMjw4cP/8Y9/vAp4EuqSkpJhYWGv8p58xrW0tB48eMDF5gFPIeAHKXIQyc/P5+ITurq6CnLAJ2jrbNTR/crC8qqj04OSUub8+e5H79z5PTHpvIMjCf4KrQWBU6cWFhTQbikMarW1tdwd/d7LIr7H9OnTg4ODexL90qVLw4YNI9n//Pnznu/m5OSMHDny/v37XGwe8BQCfjAiBxHulu/My9lyuNtj4CKyp0FTp1VpLfjSwrLd3eN5/EKm/Xr3N05+/fvChPOOTvtNTVdpaARPm5aTkUG7sTCokTweMmSIfN+9Y2Yb8mHv5eWz1wOe1P0ff/zxsWPHXo2t27Bhw9ChQ2/cuNHV1cWVnQVeQ8APRqR853q1LcgBTyzU1l6rqXnA1OysvUOHr1/X4qyu3buZvKU/eHietLJuNDJeoabuP2WKIJ+EgMGAvANJVLdy5K+es6dD35utvx7wjY2NH330UVtbW2dnZ893t27dSgL+woULrx4BAYeAH3TIp53097k+wUvKS9x9Ti4qSEparKi0VU//sIXlt46ONzy9fg0Oueri2mprd9DUbKO2TubcuSYSkhhID3SRXnI/l336U+Qj35vO6+sBf/DgQVLBnzhx4lUFX11dTQL+1q1bqOAHCgT8oMOL8p0R+IBvaW4OnSZfpqZeq2/QbG5+zMrqhJX1V5aWpKav0dUrVlUl3w2ysKDdTBjseBTwvSziXw94UqkPGzasrq7u1TX43Nzc4cOH4xr8AIKAH1zI55y7Y3Rf4dGBiYti/P3D5acXqqiuW6C9TV+/3sCQFPRVWguWzVchjxtMnIjyHajjXUe5N0X86wHf2dkpJSUVHx//5MmTnu+am5tra2tjFP0AgoAfXHg3HU3PtUNePDMXJQcFuU+alKCgkKWotFR5/mJFRfK156RJxpPkcPUdBAHvxrKQ/uunn3767p95PeCJhIQEUVHR8+fPk7A/cODAxx9/TD4mz54940XzgBcQ8IMI78p3hge39/AIOUJ5aGsbiUvYy8qaSEgaTZxkoq2D299BQPD0dtP3TlbxRsCTLwwMDIYNGyYtLf3BBx94eXm9+hYMCAj4waKjo4On08UPlIB/hbwUpKbBanIgUHga8L0p4t/Q1dV14sSJTZs2nTp1CnPRDzgI+MGCg5Un+oSnpwcABgnyIeXplM8CPuMkcBcCflDoWTuSp4vBcH2KTYBBiNcB397e3tciHgYuBPygkJ+fz+vz59xdBQtgcOLDqoxcXCQaBBwCnv34UL4zLyuDXs6WBQB/hacDZXqQAwKK+EECAc9+pLfOh+FvOPUH0H8k4PkwHwOK+EECAc9yPb11PhwyUBYA9J+4uDgfbtrs+bTi7lDWQ8CzHOmn82f+GQQ8QP/xJ+CZl0W84M9MBf2EgGeznqvvfJuBdcgQvJ0A+oX0kvkzNwOK+MEAR2Q2I+U7P+eH59uxCYCt+NlLRhHPegh41uop3/nZQ0fAA/QTPwOefFrJ5lDEsxgCnrX4v34rn/sTACzD/4EsfBujA1Qg4Nmp5650Psctf+7wAWAr/k8mgSKe3RDw7BQaGsr/+1wR8AD9QWW2KBTxLIaAZ6GewwT/L4fzYZZNABajMt8z/wfrAN8g4FmI1jRVCHiA/iAfHyoLOvB6qUmgBQHPNqQIoFK+M7xfCAuA3WgtycjnCTOAbxDwbEPKd3KMqKWBBDzZOpVNA7BASkoKCVoqmw4NDcWVePZBwLONvLy8KSXk2ERx6wADnfhLtLaOmSjZB39RtqE4/SQpAvLz86lsGoAFysvLaZXRWEuClRDwbEPxXjUq9+YBsAbpH/NzbunXUblDD3gNAc82JOBpDWXn/9x5AGxCMeCp3KEHvIaAZxuK96pRPDwBsADFLjICnpUQ8GxjSu9eNRLwGIgLwDGKAU/rDj3gKQQ825CILS8vp7JpikOEAFiA4jDV2pe3uVLZNPAOAp5tcIwAGKDQOwfuQsCzDcWh7Ah4gP4gHx9aAY8BNKyEgGcbXMYDGKDoDqBBwLMPAp5tcKcNwABFMeBxjysrIeDZhuK1NAQ8QH9QvMeVHDQwDSX7IODZhuKFcEyGBdAfFKehpDi+D3gHAc82JOBpXQjHdNYA/UH6x7QWkqB4dQB4BwHPNk1NTbTOkyPgAfoDAQ/chYBnm9bWVornybHiJADHKC4FSfHyP/AODsdsQw4QFMtoBDwAx8gnt6Ojg8qmKV7+B97B4Zht6J4np3iEAhjoKPaPKV4dAN5BwLMNyVeKhwkEPABn6H5yEfCshIBnIYopSw4TONEHwAFcXAOuwx+VhXAlD2DAoTuNBAKelfBHZSGKZTQJeIzFBeAAxYkg6Z48AN5BwLMQxTIaN9sAcIZuwGMOSlZCwLMQxZQlm8Z0GQAcoLgYI1aRYCsEPAtRDHiKC1oDDGgUAx4LPbMVAp6FKKYslqwA4AzFZaIQ8GyFgGeh0NBQWis/Utw0wIBGcaFnsmlafQvgKQQ8CyHgAQYcugFPa9PAUwh4Fkp5abBtmv86OjpaW1sPNTf/1RRg5AcqSkuLk5MTTc0W+fisXLJke309f9sIAwbpGZP+8WDbNPAUAp6FEPC81tbWluvvHzVvXoKCQvLs2eHy8p6T5AoWL379Z1qam1PNLRYpKhbMV1mjqVmsorpEaV7szJmZIaGYExTehoAHrkPAsxDFE26D4UixuqQkVlm5RFWtQktrk45ujZ5+pdaCFerq8TNnBejp9cxA8NWhQzHzlEvV1Gr1DRqNjJvNzPcYm9TpG5CfTJk9x09hNu2dAIFDsXNMPrODoV8+CCHgWYjicFzWX8z7sqUlQ12dxPkOQyMS20ctrY5ZWpEvGo1NyjU1U+fM8Zw/v6OjI8nMbKW6RoOB4TEr61Yb2/MOjqft7E5a2+w1MSEZnzZnbqiTM+1dAcFCcfwKbn5hKwQ8C1EMeIqb5gOS3OlW1ivUNUi6H7Oy+tbB8YqL61UXV5LfJ6ysSaVOavpweXklObmMuYqkdv/KwvKSk/NPoWG/JyT+GhB43d2DZPxuY5NiFVX3iZNwoh5eRzFlEfBshYBnIYp3tbI74Hc1NCQpzP5CR5cU7pddXDsCAp8mpTxPSHwUFn7e3oGU8tv09LMUlaylZcrU1HYbG5+zd/jZx/d5QWFX425mw8YnQcHfOToeMjevXqCdoKBQXFBAe4dAgFBMWfKZxQSUrISAZyGKE0+SwwSLZ8yoXr68UEWlwcDwGxvbG75+T0rLXhw7zrS1MavX/Ojt02pru8vIeIWaOqnOlyjNaza3IJX9/cVZXRcvMZ1d5Nc7U1KvOruQsn6Lnl6iwmx/BwfaOwQChGLKYoZptkLAsxDFpSPYPSVWsqfnUuX5u41N2mzt7gUGMV9sYn77nXnRyXz51U+hYaft7PeZmK5Q1/CYJOcyYSL5+ryj0/3wCGb7Dqazk/xVnienXHJ0+tLCcqO2Dgn4CGcX2jsEAoRiwGMRSLZCwLNQR0cHrcUf2b1qRWlKSt48ZVLBf21t8727x9PFWcz175mHj5j8Zbe9fUhZv8PQqFhF1UdustckuZ1GRt2Fvofns8iop1VVnalptzy9TtvZHTQ1q9RaECE/PTMtjfYOgQDh/xISd+/e3bJly8aNG0eOHFlYWEi+OHbs2IsXL/jZBuApBDwLUQx4dq872VBfnzBL4Qsd3cPmFucdHe96+zwODXsSG3fP1++8gwMpzWv09LKV5hmKS/hNnlKltWC/qWmrrd0lJ+fbvn5XXd1I3X/I3GKrnn7uPGWH8eNRM8Hr+F9Gk3QfOnTokNc4OTk9evSIn20AnkLAsxP5rFLZLgl4Wn0LPiA9Jy85uWJVte2GRkcsrU7b2V92dbvi6nba1u6opdVOQ6NV6hqR02dYqqqGamgsUZq3UUdnr7HJYQsL8t2vLCxJ7U7SvVRNLWL69ISAQNp7A4KFBHzPJAp8k52dPW3atNu3b3/yySc//PDDgwcP/vjjD342AHgNAc9OJGVJGvF/uxRPHvBHYlRU1IwZpapq2/T095uatZhbkP8OmJrW6xus0dBMVpjtNH06OUyTUsxp/PjFikok8knMk1zfrKtboalVMF+F9AAMJk6k8tcBQSYuLs7nOyd9fHxMTU0fPnxIqx4AXsPflZ0Q8Lzjb2ZOQjpXWXmtpta6BdrrtXUqtLqTO0lBwXXixLTU1J4fIzHvqKQUNHVqosLszLmKqXPmxM2c5TxhgqeJCe6Ah7eRgO+Z66avON6itrZ2cHDwli1bSMBv3Ljx3r17XV1dXNwjoA4Bz078P933ymCoBlaXN9kTnwAAIABJREFUlNjJykbITyeZnThLgeS9p5yczZw59XV1b/xkSWFhnH9AqKWln5l5SkxMZUUFlQaD4CM949C+688UszIyMh999NEnn3zyP//zP//617+EhISOHz+OQXZswv5j8eBEMeBpnTzgM/LyrqusTI+NDXd2XhgZSaJ9MOw18A6fe8ZPnjxRVFQMCws7fPiwuLj4jRs3pk2bRh558OABP5sBPIWAZyf+33LzyiAJeADuonXq69WtrVVVVUOHDr148SJO1LMGAp6dKE6awf+xQgADHcXBK68mpzp48ODHH3985MgRnKVnDQQ8O1Gc15ri1QGAAYr/E0i0tLSQXL9y5cq2bdt6An758uXDhg27ceMGKnjWQMCzE8WlJxHwAH3F/4C/d++esLCwkZFRXl4eqQe+++67iRMn2traYqIbNkHAsxPFgKd4+R9ggKIyx3NjY6OQkNAHH3zwv//7v3//+98NDAx++uknlO9sgoBnp5SXqGwaAQ/QV7QWcXjw4IG/v7++vv7p06dx6Z19EPDsRMp3UsRT2TTWlgboK4rLMFIsBoDXEPDsVF5e7urqSmXTFMf3AQxQpE9MK+ApXs4DXkPAsxM5XpBKmsqmScDjeAHQJ6RPTPEDix45WyHg2YliwKMgAOgriqfcyIECAc9WCHh2onhJr5/zYwMMQhg0A7yAgGcnWoNyGYzZAeg7igGP215YDAHPTvyfN+MVku60DlUAAxTFTw1mpmIxBDw7UZzamtQitK4mAgxQFM97YfEIFkPAsxPFgKc4XAhggKI4NBUBz2IIeNaitfokxQH8AAMUxXvVsL4ziyHgWYvW5xYBD9BXFAOeViUAfIA/LWuRgKdy5o3iHXoAAxSte9UoXssDPkDAsxatwbEk4GndoQcwQNEKeIq32wAfIOBZi6QsldtbKd6CD4NK+0u0W8EdtG5Gx6eV3RDwrEXrkIGaAHiqo6NjeZpfrKV0nO7IFMNREQYShYm+Az3paZ1vQ8CzGwKetXBVDwYE8obZ0VC3fGlGUWb0xurKd0f1F+srw/Ql8q3HVrmK1PiINQSMW+8hutJJOFp7xIbqSn41mfto3auGETPshoBnLVrjchHw0HubN1QuNJXMMBmVbz1muYNwltnoVKNR+WlRf/rDpNyMNpIssxfaHjDuaIzkqYXSZ5NkTsRJNUdIVLqKZFgLD9wZ2WgFPO55YTcEPGvRmjqDBDxuvIHeSAqwTdAfVeEqTArxfSHiLRESjUHjtvmK5VqOCTWdumn9mxW5v4XSUqsxO4PGnYyTas+Uvb1k4s/5k28sHn8+RaY5XKLCRTjWaqCebaYV8JiWit1wIGYtiqu6IeDhvYoLlyUbjqpyE9kfJnEmSfpCquzVzPHnkmW+jpeu9xMrsh1rKv9/gZZKr+ZyINV5xIIRla7CX0VLXs2Se1Ax78UOXabJ8sWa2T9kTSC/WOc3Ls149PXr7VR3i0O0Zq2guMgN8AEOxKxFcXZrzI0F7xViMpWk+IEwidOJ0j/myv26RvFB1fxflk25lil7PFZqi49YuNaIRP2R6b4GPT+/rrIiTm8kqe+/WSh9J2fSk31BzI97mUfnmG+DHpROv5Amuz9MPN96LOk30N0vztDqEyPg2Q0Bz1oUP7oDLuCPHT6c6OQUb2ISoaTkq6qa7OlZVVFBu1FsRsrxWN2R1e4iR2Ikz6VP+qNamWnyYb6NY3YY/7J08sU02d3B4kutxoRqjsgyH7OqtID8SmJs+EL9UTU+Yq0LpX9cPrfrsAPT+SXDXGCuRj4olb+SIXswXCLXYkzBknTaO9dnFK9qYXFndkPAsxbFq2sDaPmK+x0dKZ6e6XPm5sxTLlNTW62hma88f7GiYtDUqSlBQQNlLwacqsqKEM3h4QtGBKsPj9IeGac7Mt5xWumiqI7rWY9WzSZpfThSsthurI/K5+UuwtFGEszL4WCkT/CFl+jRGKkb2XJPquYzVyK7buUzm9R/zpt0NkmmMWgc6Q3s2l5He+f6jLzNaI1LpbjIDfABAp61KI6PHSgrTJPKKcvWbpGi4gZtnXp9gz3GJvtNzbYbGtbo6hWrqkbPmOmurEy7jexUUrTMRfGzHIsxq5yEN3iIkrqcBHmpvVCQxvAtfhIk4JvCJYpshZINR9X6iZH473jJfvanJPX3hoifTpT5IXvi/YKpf5RMv5s76XK67JEYyWoPEfLrA7FPRnHqCIpz4AMfIOBZiwQ8rTtcB0rAr8zJyVNWJul+0Mz8hLV1m63dWTv7k9Y2X1pY1uobrFBXD5Of7mJtTbuZbEPyLM5EssBmLAnvQ5ESJ+KkWhOkj0RL7g+VWOMsHK83cou36K6gcYvNRpPIr/MXi9EZ2TNlU4CrZaLByCp3kf1h4t8slD6fInMxTfZskvRX0ZJ1ft1j7//q/joBR3G2GVqzZQB/IOBZi+Kc8LQm0euT021t0fPmVWhpHTA1a7Wx/d7L+05E5C/hET/4+JKYbzG32Kavn6WoZCMjMxCLQkEW7qxLwnh7wLjjsVJX0mRuLJL9ccmEaxmyZ5OlD4RJlLuKeMz7rMJVJHzBCPIzW3zEYl9W8MzLMy626hMTDEaudRau9RXbGypO+gQ7g8Zt8BTNNh8TYj1vYI38eAUBDzyCgGctctSgdd6PBLzgHzU2Vq0j+V2jq3fC2uZ7N/cn4RGdJaXM+vVMVvZ1d482O/tdRsZlaqSIl8c5TC4ib8twreHlLsJfRktezpxwf+XsJ/V6L3Yb/rFK4cbi8acTpRv8x6UYjfKe/xkp1lsiJJY7CIVaz3v16yTCk8K9fFQ+zzAZnWc1psB6LIn2UM3hGdHeAzTdGarTyQ2IvjhwDAHPWhRH7pCyQPBDsSx7yVLl+STFv7Gx/cHX71FdfdfNH5g//mCOHL0XFX3OweGgqVml1gIS8HGRkbQbyx6VFRWJBqP+fbfbkglPa82Yi1XM3TrmpP9vxdMupcvuCxUvsRNyU/rscJTkFm/RNOPRK0oK3ngS0n0sWJLmb6cT7KibFBve1jYArge9A8WAHyhX04AzCHjWojhl7IAYuVOUnJwzT3mHoWGbrd3PAYFdeUsZEvCPHjG79/waHfOtg+MBU9M1Gpph0+QzYmNpN5Y9lmalJRmOrPUTI8X6T2UKXYfdGeZbhrnO/Jz7sGz61QxZkusk4N2VPlvvIZpuPCot0pt2k3mO4njYAXTDC3AAAc9aFG+uHRD33uxsaMhSUtqmb3DMyvqyo9P9yKjOispnLYe6UtNuuLmftLYmxf1KdY2gqdMqcE889zTU1yUZjiKl+Yk4qVtZE59s1WHuLmb+2Mps179fOOVi93w1EkW2Y12VPgvWHJ4aMYBPvPce7mgFHkHAsxkJeCrHxwER8OSVCZOXX6Opuc/EtNXG9rKzy4+eXne9fdpd3c7Y2TebmW/S0V2sqGghJY2LlFxE4sRT+bPVTsLNERLfpcjczZ/6rHR6V/m8P4qm3nx5DX5HwLg041HeTpYD/cR771EMeFqHCOAPBDyb0ZpRbqBMj5Xu5UWKeBLk+01MSR3fZmt3+uVtci3m5vUGBmVq6lHTZ4Q5O9NuJku0NDfHOCiHaQ6P0h6xyHT0Vh+xIzGSpGS/mTXhTt6U9szxZ5NkmsIl1joLRxhIDKqykuKkk1g2gt3w12UzWuffBkrAdxfxGpqLFBXXLVhQp2+w29hkj7HJDkOjL3R0S1TVYmbMNJ4kh/qGKypWFEYZSRbbCm3wEK33F9sdLF7l1r2gO6njT8RKnYyXOhItuSdEvMJFOEZnZFnxm6Pq2I1WwFMchwv8gYBnM1pDZAfQChbk9fFVUY2eMSNPeX6JqupydfVCFZW0OXMDp04N1NcX/Jv9BoTm5qZ4E8kVDkI7A8eROG9L7J6j5tTC7glqSMyv9xDZ5CW6zl0k33ps5IIR2cmD7p4FWh1iijPoAX8g4NmM1k2ub1xTJCG6s6FBkK9kryouJjHvMWmS7+TJDuPHB+rplxUVoXbnliArpaVWY0nV/nW89PVF43/Mk/u1aNqt7AkXU2W+jJJc5yYSojE8UG14rJve6UFz3f11tMasUJxgB/gDAc9mtAK+57YfEpA5CxcGzpkTNWNG8uzZwdOmOU+YGGltLciXV8khD7nOXeQljdYZUekmQur19uzuddw7Gw2ZYy6d1cq3l0z8LkVmV9C4bPPRq8sKabeUGlq3lVKc7BL4AwHPZrQmnCEBP11efqGpabbSvJXq6tULtDfr6q7V1CpRVYufNctSSnp9VRX/WwVU1NfVxeqOrP33Ou4TH+8PYO7sYZ60M1fiHq6YdTldtjlSIkF/ZJT+yCVBRlmxPvX1A285uH6iGPC0JtgB/kDAsxk5cFA59UcCXlNEdNl8lRo9/X0mpoctLI5YWh00NdtpZLxWQzN1zlxbGVnMnzVI5CxOi9f7zzruZbO79lsyL3YzzHfMtYRHqxSuZY5f6yxcYje2yk1ktbNwgc3YJIORA3TNGI7RmhCe9CpoTbAD/IGAZzNa1/bKS0tz5ilv1dP/0sLijI3tRUeny07OZ23tjll1zx5TrqkVNWOGqrQ0/xsG/JcY5kUK9E3d67hLfp816fFaReasf9cPS5kazV+Wyu0MGrc9YNz+MIkj0ZJfRknuDRGv8RZbbDY61ceAdsP5h2LA07r/HvgDAc9mtEbnlnl5rdXUajE3P+/odNfb53Fa+tOMzN8TEr5zcDxqaUWCP1tJyWXCRBTxg0HBkrRkw1FbfcWORkteWzTh1+Wzn+y16vxuydM6/RMJ43cGjvs6XupCisz1DNlrGbLfpciQfsAWH7FM09Hr1w2WCQRpjZUZQHe7AGcQ8GxGK+CztbU36+odt7K+7ub2KD3jecshhmT5+g13/Pxbbe12GhmtUFf3nTxZ8Ge7g/4jtWnkghGkgj8eK3Utc/zdZdOelsp3rlftyJXb5it6IrY79TvWKD2s03+4Zu69IvmLabJfRUuucRYO0ZOg3XY+kZeXR8ADLyDg2Yx8gPl/Cq69vT1RQaFW3+BrG5vbHp7PSkqZGzeZp0+Zb079EhV9xs5+n4lpmVp3wAd5eXHw/B0dHcuXLIk1NY3T0PSWm5zi6ZkdH8/1vQBuIX8vZ8VPC2zG7gocd2qhNInzG1kTby6Z1OAvtitI/HyKzL3iacx+J+ZcKXMhuGuj2q3sCa0J0qTiTzEcNUjuaKA1X8VAmZAKOIaAZzMqg2jIQTlj7txNurrHrKyvOrs8iYlhmpqZn+4ypWV3/Py+trHdYWhUrKLqP2XKusrKvj55S3NzoqlZlpJSkYrKGk3NUlW1HKV5CbMU3GfOxKQ0AquqssJ8+v+5z/vMX/XzEI3hsTojM0xGldgJNYVLkHr997WzX9xczzC/MMwp5qD9z0vlziRJ7wwcl6A/qrm5iXbb+YHWjJMDYtVH6A8EPJvRWoYyw9FptYbmQTOzs3b2Nz08O3x8H0TH/Ortc97B8bCF5RZdPZLQppJSfY1kchCMU1YuVlWt1TdoNDJuNjPfY2xSb2BQqbUgdc5c5wkTcFFfALU0N0XZzcixGFNqL/Ry3jrRFQ5CS63GBGsM3xMi/l2ydEfpzM4jjgyzk+ksYzbMv7Nk4ulE6W2kgjcadf16O+3m8wMCHngEAc9m/LzPlRTu2+vrS7Oz49zc7ObODZ8+fd0C7RZzi1M2thecnC86u7TZ2h2xtCLl+0oNjajpMxw1NPt6AjbD23u5mnq9geHLhWFsv3NwPG1rd9LahsQ8yfhkhdnmCgo82jvgDMmtWGNJEucksA+8HCp/Ik6qJUJiZ9A4kvdFtkKnFkrfyJ74ZPnMrk1anZWz7+fLXcscfyxGqtpdJFRvsMyiSmtRKFqj94FvEPBsxrepKFuam9MtLCOnT/ecJJetpLRs/vyV6hprNDXJv6TaPmhqRqrtvSam2/T0ySMLZ82ynjK1r6OKTre1xc+ctVlX7ysLy0vOzndjYh8uzroXGdXu4Xni5d13BfNVPCZNwtrtAiXcWS/PckytnxjJ7IspMu0ZsjcXj7+ULtuaIL07WHyZzdhkw1HZ5mM2eIr+mCt3a8mkS2myX8dLbQ8Yl2c5NjPam3bz/xwJY+6eK6K1pBvp/SPg2Q0Bz2b8WUyiadeuOOXuRE+fMzdnnjLJYFKmHzA1229qSr7YoqtXoqpG/luloZE7T7m7dpeXr+x7DH+xbl2hispOI6PTdvZ3fXyfl5QyR48yjbsfREVfcHImfYhKLa3oGTMWpaXxYh+BA21treELRpS7Cn8VLXk6Ubo1Y0pzxsy9C6fsDpep9RWL0RkZojUiXm/kYrPR5F8/1c/jdEceipSs8xcrtBkbZjZVAEfYVVdVhFrPC9QRj9IeEa41IsRkSmEGF+bkoRXwtEbvA98g4NmMHCJ5vRwk2USqmtpqDc1GI+NSVTUS54fMLb6xtjlnZ3fWzv4bG9sWc/Mave6MJ8W9+eTJLkZGnF1u3LhiBanRSb/hnL3DbxGRzPETzIsXTGfn8yU5l51dDptbVC/Q7u49GBpyexeBQ+vXVaQZjybV+XIHoTIH4Y2eonV+YkutxoZoDree+YnHvM88lT8rs+9eYq7GR6zKVSTHYoyr4qfB6sMjzacJWvCQ93mkt3WY5ohC27FrnIU3eoiS3Vnl1D31XrLL/EMtzf15ZlprtpLeP4atsBsCns34cOzICQ8vUlHdbWzypblFhdaCZjPzs/YOtwKDOlJS78XG3Q4JJQV3k5nZem2dJIXZ2qJiHJdljZs2LZs/f1dPBe/n31W2nPntd+arI48Sk75zcm4yNavoruBnpkRHc3cHgWPpCyNIUU6q82K7saQu3x8mEas7kvyXZTa62HbsaifhpVZj0oxHbQ/ovn3uaIxkrZ8YyUsPDc7fJLwT42O9UG9Uz4q3zRESx2KlegYT7AoaR/ooC00lOW4zxTVbaQ3uA75BwLMcr8/+ZRoYkNL5qKVVs6XlVn39r61tbrq5/5GQ2FlXzzQ0dOUva3d1O2FtvU1ff9l8FTsZWY4rs9/u30+YpbBVT59s67KLy8/ePg9TUh8HBV91diEbbTQ2LlNT95okh1HBgmNFSYGZ/P+lm4yu9x+33kPUQ/mzFKNRVW4iOwLHHQiVOBwpsTtYnHyLhPqRGKlrmbIkMknYk5/Pzxas6yzFhcv81T4nhXvPvHuXUrvn3buxeMKltH8PJiClfHKgLWdPTjHgSe8fAc9uCHiW4+kAXfLMmSqqdQYGJ61tjpCUNTJutbX7MSDwWc1W5v797p+orbsTGHTy5bdIoe80fkJ/JtZIMjMjKb7LyJj0GM7ZO1xxdTvv4EiefL+JabW2dvrcudZTBPHC7aC1Ij/DX/Xz5Q5CDf7jfOZ/nmo0ar2HyMFwibNJMhfSZK9mjv82WYbU7iTUy11F7pfOuJIhezhKcpWjULKLCu22/xc/g8npxqNrfMROxEpeyRx/b+28B9t0n2zS/K1Yvj1T9pt4qW2+YnG6IzkLS4qLstO69g98gz8wy/E64BMVFLbpG5yysT3n7FJvYNBqa3vby/t5egZz9Rpz92dmzdofvLxJhd1gYJivPN994qT6Os4XAyUH0NBp08rU1Or0DQ68HJnfs0LdugXaixUVHcaP78+TA9eFeVoFqg/f6CkaoPY5Sfoy++6Zbc4kSf+YN/nXtUoP1qv9UjCVBOTJOKk6P7Gv06bezp5AviY5GqYvQDfIkTe59cxPSu2FdgWJkx7JL2UzO/fZMWezmfYMpkH/l3y5i2mye0LEC23H7mjg5O1HK+APHTpEAv7cuXMvXrzg/9aBPxDwLMfrWTAz1DU26eodsbT61t5h88svLjk5/+zr9zg17Wn2kt/9Ay44On35cnKbxYpKppKSHJ8SJMfZkuxsy9mz/eWne8rJkTi3l5VdraFRqKJCOhk+Cgori4u5umfQX5F2yiTaq9xEgtSHpxmP+sJT9Fis1M28qU83qDKHvJnLCcwu01+WTbmULrs3RHyls8itLFlS0G/yEg3RGC44p46bmppcFT8rcxBqipC4mDb+tzUKzy6sY5jHTOcd5nrkg9LpV9K7TzwU2QoV5qRz9vx8XpT90aNHxsbG//znP//+97//7W9/c3NzI4/wswHANwh4luN1wOdHRK5QUyf19Fl7+wYj450vz5+fd3C87u5xzdXtnL3DMSurnYZGK9XVw+XlrTk9kLU0N8ebmGbOnZunrEyeqmC+CukuxM6cSWJeb8IEH1NTDAbmKdK7ys7N8w6JDIhLDYqMzc7J7c1vZSVFeil/tsRiDCnfS+yE6v3HtSXK3Mmb/OSreOb5twzzhOkoerxy1rXM8V9FS65yEu5ZSm69u0iGuwCdoif77q70GWk/6YWcT5K6t2JO5wknpquBebaVVPD3C6deTpc9ECZRYDN2+5Z1HDx/bW0tnwM+OTl5xIgRq1atEhcXr6mpGTp06OrVq58+fcrPNgB/IOBZjtcrUW6vr0+dM6dGT4+U6cesrNdqaDYYGLaYW5BSnvzXbGZO/u9aTc2U2XMcOL3ptmeG2mXzVbbq6e8wNNxvarrTyIh8vVZTizyty4QJbUh3Xlq/caOJi49NYIxLdJpPcq5rdJp1QLSRo0fVuvfkWUVFua7cMO/5n/WMUKvxETu1UOrHZfIvdhkyf1QxXceY076Pls8gAd8SIbHcQWiLt9ieEPFl1mPTIjlZhYh3TGYLZ5uP6R7tnyB9I2viHytndzXov2gwfFo89Vb2hNOJ3TPnZ5qO5mxiXT4vGPHixQtJScmwsLCjR4/2XBogW9fS0nrw4AHf2gB8g4BnOT5MVpXp5FSs0j0/fIu5+XZDo/z58yu1FmzS1SX/rVugTb6VNHu2vez4jNRUzp5/kbdPmZo6eX7SY/jGxvacnf0pW7vjVtaNRsYVmlqke6E7YQLG1vHIqrXlRq5+nglLogor4pd/kVJeG1+2Mbqw0jMhW9/Ra+euxnf/up3uHD/VzwPVh1e4Cm/1ESMF+rXMCQ+Lp3dt139x1K+rQvHOkglnk2VIrudZjSmyFVrnLhKrO7KlmfPbynkhKtAjQmtEuYvwgZdjCK4vnnAnb/LP+VO/X9w9TrA5QoJ0X6ItpnL25CTgSdDm9x1nm7t06dKwYcNI4b5v376eMwc5OTkjR4683zMqFtgFAc9yfFhPgoRrlNaCpcrzq7QWkBgu19SKmzkrQUEhSWF29IwZ3nJyzppaHHcyjh46nDBLoUZX77CF5QUn59sRkfeSkn8KDrni6nbMyuo/M9TKFRcUcHengHk5/svUxcc3dWlsyfqsTXvzalsKdx7Nq23O3ryPxLxfWr6Ro+e7L5aT98ZMsf81mTYs33psY7D4wXCJr+OlSMbfyZ3UUTCNlL8XUmW/jJKs9hDJMBlNvptlPibUSZdf+9dbZC9cteXSjEetcxMhfZETsVKtCdJtCdIn46X2h4lXu4ukWUl/eYjDTgmJahK0oX3H2TCFpqamjz/++NixY1u3bu0J+A0bNgwdOvTGjRtdXV2c7QIILAQ8y5EDAced/d4jx5olYWER06enz5m7RGlexty5TuMnaIqImOnotLW29qe8riorK1RR2WVkdNbe4Wcf3+e5uQypGqurf385Q21T9wy1CxbOmuVuY8PF3YEewVFx9qELY4rXLdq4u3Tv1zVtV/Ze+7Hyq0ule79Z/MUekvq2wXHRCcnvfhLy13ezt4jWHkGq85YIieNxUsdeBuSZROlv4qVaIiU2e4nmWozZ7C1GegDLrMcuihHEKehJLroofZZmNGqlo9Bmb9F6fzHy3xZv0eUOwokGo5b148Z98vEkH1IuNvXdGhsbP/roo7a2tjVr1pDeP3mEJD0J+AsXLnR2dvKtGcAfCHiW40/A96ivq1uamRlkYRHh4qI0a1YYNw5bueERZWrqTWbm5x0cf01O6TpxgiF1xvPnzxZlXXF0Omxu8YWOTvzMWXozZvR/W/AGKzdfn+TcxNU1pHDfcub2yV9f3CFlfcezjd9cL9h5NGl1jXdKrrNvcG+eystUMd1k1AYP0QNhEifipJojJPaGiG/zFVvtJFxoR8piiXPJMntfXoDftL6S1/vFGdJTSQj18lT+PF5vZLrJ6DSj0Qn6IyPtlLdzdHfcKykpKfwM+IMHD5IK/sSJE68Cvrq6mgT8rVu3UMGzDwKe5VJe4v92Sa+i5/DRTytSU4tUVPeamJx3dPotMKizah3z8CHTdvrp4qyLDo6HXk5Bv3CWgg+NZe9ZT93Mzj+9IH3d9qJdx/ddvPP8RXcAkP/VXewoajyesW5HQGahrrVTb56KpKOPweRUo1HLX1bAtX5iNT5ia12E13uMu5E18WqG7LFYyY2eopELRgjODXJ/ijSvob4uPzutpGhZW1u/zk714PMnlFTqw4YNq6ury8nJ6elY5ObmDh8+HNfgWQkBz3J8rg9eKS8v50rAN9TVLVGat93Q8Gsbm3YX14ehoY/XrO1MSfnB3b3V1m6/ielaTc3gadOiw8P7vy14g7l7gE9KXkp5LYnzXVfv/fjyRqqfXjA15+6SyCeP+6bkeYbF9v4JvZwsfFU+D9cakWgwKsdyzBdeopfTZUntfixGcntA95y1Sxf68mpnBBU/z7ERnZ2dUlJS8fHxsbGxPUcGc3NzbW1tjKJnJQQ8y3EraPuqtraWKzf/dK/iNX3GWg1NkuUk0S85Od/w9Lrs5Nxma9diZr5FVy9bSclaRkbQFh9jBze/YNeYjPjlX+RubVrTcm7b+Z++av9163d3l+9vzd3WnLByk1tcZkxiH6pP8td0WSAXpjWcZHmD/7gDYRJN4d0z0m/yEs2zHBNiMhhnGubDMNg3JCQkiIqK2tjYkI7FgQMHPv74Y9KAZ8+e8bMNwB8IeJbjVtBS3O6+HTtS58xZt0B7t7HxIXOLo5ZWX1pYHjA1I+leoKIaOGVqYhQX1uSGt1WtqzZ1DwpaXEKK9bw/sLA2AAAgAElEQVTalpLdJ1c3nynZc5J8nVpRF5xVZuIW2NCwvU/PSSI8JcIrSGP4EvMxJOaL7YRyLcdEa48McdQV8JPzPML/gH/8+LGBgcGHH344ZsyYDz74wMvLizzCzwYA3yDgWY5WwHN3As5FoaGJCgqlqmrVC7Q36+pt1NZZo6G5ZN68kGnTvExMBmHZxzcuPgE2gTHBWaWJq7ZkVO9ctHE3+TdxdU1IdpltcFxsEodzG7S2ti7LTgu010kOtE1bGHHmdBt3mz2AkI8nr2eqeFtXV5eGhoavr++pU6cwFz2LIeBZjv8zXb/aLneX0NhQVRWttSBcfnqSwuzYmTMj5KfbT5tWUliIdOcp8vLae/pZ+IR5LMwKyioNy11J/vVMyLb2j/IMDMOL339UAp7idoGfEPAsR2utKh5tlxySNlVXk1zv5+310CelZcsN7Fx17dyNXP3Jv3o2zsUlpbQbxSHytiG9z+UlBVWVFYIwdIPXk0kL2naBnxDwLNfe3i4uTmHxTVrbBZ4ikTBw+1Wk5ekLI0L0xMO1RqQYjUo2HBWtPSLKYlp9Pc1Vhnm9HJSgbRf4CQHPcuSg9umnnw7o7ZJQycvMTLS3j3V1y8nIwHlF3jl0+MvA8GgHrwATF+/g6PiUjEW0W8Q1PdPNRuuMWO4gVO0uss1XrN5/3HoP0VVOwpHaI5amURunSfrBVEYX0tou8BMCnuUGdMCTJylKTo6dOTNZYXbePOWMuYoxM2f6T56yMCAAxybu6r4dMSHZzCvEISzBc2GWb+pS15g026BYfVvX6vUbaLeOC6K9rVONRq1xFm4MFv8qWvKbhdJtidLHYqQOhkuscxNJMx69a3s9lYYh4IF3EPDsN2QIhb8yCYx+bpc8Q7yJ6SJFxXULtLfo6m03NNqqp7deW6dQRTVsmrzVlMF4zzSPkFcyIHqhlX9UQGZRSM4Kp4hkI1c/Qxc/AycfY7cAXTv3+oaGv/rF7Nw8N78gJ99gZ7+QqPikyqoqPje+N9ZVVfipfr7aSXh3sPg38dJX02V+WDz+xyUT2jO7p9lpCpcgNX2gzuAKWtL/xieI9RDw7Efrk9zPgC9LSSlUUdmko9tibnHMyuqUrd0xK+tD5hZb9fRLVdUi5Kfb6utzq6mDXM7SfEvfCJfodNvgOB1bNz0HTwvvMLuQeBP3QF17DzUTG3Uji7dDqLm5xcE7wCYg2jE80TMh2z0u0z5koZlXSExiiqCVhvG+NmnGo7Z4i52Ik7q2eOJvlSpPdps+22/5ePnMm1njzyRJ7wwat8h09KoyCmsSDtCPJwwI+BuzHzmCDLgS4UxbW7Kq6mZdvSYz83N29te8fX4MDmn38PjW3oHkfa2+wRKledbS0hgGzBUWLt5KuqazNfW0bVydo1L8MwrDclfFFFWF5qzwTy+wDYqdp29WtnzF67/S1tZm4uztEJ5EfjK2eF3iqi0JKzZFF1UFZ5dZ+0dbufvxfy9aWpqjva1DrOcFaIvHOsxPjfRua/v3IDJXHbki27E7A8edSZL5pWDKi71OzKUK5pdq5pjbbyXyl9NlSRG/0lF4xdIM/jeb1gk2KlfugM8Q8OxHa7hsfwK+orRsqbLyTkOjM/YOd318n6akMhu/6Cos/DEomDyy19hkpbpGuPz0IiwD32/kvUFqdE1LR1K4u8VmRC5bm1ZZv2hD45KaA5nrd6VW1IXlrnSKSDawc3v1Ky9vjvcnPxy+dHV61facmoP59YeX1h1asuVASnktyXi74LiEZA7nwOEAaU9SuFewxvBM09HLrMeudhIuth2bZd692ltWUiT5rs2sTwqsx+4LFf8uRfbeqjmdbSkMc5d5cZP5Nf1RqXx75vgjMZLLHYQSA2z51uZXqAQ8bnIZJBDw7EcCnkql25+Li0vCw0mEHzA1O2/v8MuixZ1Nzczjx8wPPzxJSb3k7NJsZr5eWztu5ixfe3uuNnkwWpK31DogSlHH2DE8MaqwIqN6R37Dl8Xds9KeLW48sbT+cGpFPQlyC5/wkIh/DzXf8MUmI1f/oKxS0hXIq2upOnK+4Wx79fErq1vO5W5rJhnvk5KnYW7PnzPPZCvJgbaxuiNJQtf7j2sMEm+OkCBZvj1w3Dp3kWTDUZmhdr4Gk0nwd1fwidJ3l055utuMeVzEPKtm6vXuF069lC57IEyizF44P53fY+nJB4RKJU1regzgMwQ8+9Ga0YIcQaoqKkqyssKsrKKVlX10dOP9AyoqKnrzuyvT0kpV1Q6amZE4fxQU3LV9B3P/PnPh4tOcXPLIYQuLdQu0Y2fOwiqx/UTS0cDW1Tkq1dDZ1zclL2XttsIdRzZ+3f7l7fsX/nhW/93PJObzapsTVm52i818VcRHxMQ7RaZEF1aS2p3kesuPzy8/7br2rHPXld9InyB70z7SIbDyj2pububDLmRnpkZqj1jjLEzy++t4qXPJMpfTx59PkTmdKE2SfoOnaLrJ6CkSIxP1R9V4ix2PlbqaOf5+yczna2Y/36D+qHDKzawJbQnS2wPGpRmP3s73G+JpVdII+EECAc9+VOakJMkxf/Zs/ylTkmfPXjJPuWC+yiJFxfhZs1wmTIzy9X1vbVe7YUOBisouI+NWW7ubHp7PExL/2LuvK3/ZT94+Z+zsSWVfqbUgesbMBCwz0z919fVqJjby89RN3APD8lZlrt9Vuvebxgs/Xfv9xSOG+eHR881nbhftOk4qdVKva1k59/zhgqLiXKJSSern1basP37l5r2Hzzu714k/evvJ2kPnl2w5EFtSbR0QXVxSwodd8NeTWGIxhqT78Tipq+myd4pndFTMu5cvdztn0tkkmZYIiZWOQvazP/FX+7zMQYjU96QTQEr2m9kTb+fIXcuUPZskfTBcYq2LcJrbLP4PdiNBSyXgac1gDXyGgGc//i9XRVQuXUqifY2G5iYd3XoDgx2GhjW6etXa2tlKSiT1TWbNevevk0Nt3MxZG7R1ms3Mz9k7fO/qdtfL+5ab+3eOTsesrBoMjQrmz3edMBGT3vRTYVGRgbOPtrWLmWdwaM7KxV/sWXvo20O3n3Z2dX/3j05m+5XfCncdz6jeGbioSMfOnQQSKTrj0rNIBR9XtoEE/ObW7888/PezNd9+uuLg6ZytTVGFlTYB0bt27+F1+0l7wjSHk/L9QJjEpcwJ9yqUu/aZM2fDmGbbZ2vnfL9o/KkE6RofsUWmo13tzMO0hq9wECLF+uEoSdIbOBkvdSRacnewOEn3BDOpQy38ON/wdvupVNK01qACPkPAs19oaGh+fj4/t3imrS1LU7NcU2uPsckRS6uvbWy/sbE9aml10NSMZPay+fO95OTsLC3f/STZvr6k7iedgy8tLE/Z2JKYb7O1O2JpScr6ci2tBAWFYAsL3MjbH93n5+3cPOIXBy4uNvMKCckuS6/aTur12nM/3HzBPHveee4Js+741YIdR1LWbvNLL9C0cDRy8NC191A3s5urbeQclZq1aW/ZvlM1Z374+qcHX976vfLIlaLG44s2NIblrjL1COJ4BAaJvaycRc7+tj7RzpEJoUXFhX/1k0UFy0jAf+EpeiRG8vriiY++MO683cA8usU8qWRqFvyyVO5MknRjcPctcPV1dSkRXiTjcyzHVLiKbPQU3eQlus5dZKnVmEQzqU3rKzl8EfuHViVNevyk38//7QKfIeDZjwR8SkoKP7e4xMW1TE1tj4nJSSvry27uNwMCf/DxveruQWJ+n4kpyfgkhdn6494zBI/Ez0JT06XK8zfq6O40NCJ9hUYj4xo9/VUaGiTdLadMxUza/bRqbTnJdRLGaVXb1U1tPROyEldtyd3atOJAW8WRy9tO31x79ErJ7pPZW/bHla53ikhR1Db2SswJyCz0WJjlHJnSXfrbuOZsPVi8+2TB9q9WHDhduPNY9ub98WUb3GIzXQPDOWtVZFSEjuM844D5VlGaTil6VtGaRgHz7QPM/vTPvbG6MmLBCJLTR2Mkv8+Z/LjBgPkhh2FOM0/WMDsMf8qdeD5FZmfQuHST0bu2d19fJ08SaKkUqD48VHN4jM7ICAOJEEfd69fb+/My9getgCc9fnJY4P92gc8Q8OyX8hLfNkeCOUdHZ6O2zjFLq2vuHg+DQzpLSpk1a5/n5l12cj5pbVOrb5CvPN9jktx7LxyQHsCyyMiYmTPzlJWLVVXJby2aqxg4dWqopRXSvf8CI2IsfMN9UvIWLv9Cz97Dyj8yOLssee22nJqDBTuOkmhftv2rJVv2k9QPyCi09o+wCYxJXF1DqvyElZtjiteRXzT1CJ4yd76Chi4p67WsnMh/Bk7e5HFLzyDOxnUuX1Wq5axgn6DtX2QRvNw6stIhZIVNQJGFbfwCXfe5b//RySMBap9XuAg3hUtcTJ/QsWxKZ6NJ553MrpNOT0um3cwaf2qhdJ2fWIbJ6Dd6k6R5rQKwICGtU+UI+EECAc9+fP4wh1laZc6dW29g+LW1zU1vnydryzuvXmXu/szU1v0SFn7K1m63sfFKdQ1vObmIsLDePOHOhoachQsT7O0D9fSSAoPWVVZSPy6zAHkNje1cXGPSw3JXplbUZ2/ep2FuTyI8KKuUlOCpFXVplQ0p5bWxJdX+6ctIob/A2oUE/9K6Q4W7jpN/uyv15V/4ZxTo2Lop6hhrmDtoWji6xy9yCEtQNbb28fPnoEkkdHWd5jmn6gWVWSVscUut98rc7ZdS75VY404ecUrVM3LWfHsvDKcOy7EYU+c37mSc1LXM8b8slXtUMPm3vIm3sid8lyLT3D3ITjjaXpkbrxn30TpVzudOP9CCgGc/fh5EqpcvD5w6LW3OHBLwrTa2d7y8X+TkMBcuMvd/Y/bsvRMQeNrOfreRcYmqmv+UKfGRkfxpFbxt565GI1c/Eucky3O3Na9pPr226Wvb4HhjV3+X6FTf1KUBmUWkFncMTzJy8dN38iZhv7rpzM5v25uu/1R19GrJnq8Xf7EnrnQ9SXRtGxf3uEX6Dp62wXFRBeUu0WlGrv5vV9ukhn53WR+dFGYSpEJq97gvXLL2BZS3pda1FxQej8w+ELBws2tAiaWh37ydu7a/8VuNO+rDtbpvk9sdIk4y/nyKzJWM8ZfSZE8nSh+KlNjsLZpuPGrPTjoLybwXrYDn/7gcoAIBz358Ow1IjuCxysobtHVSZs/Zoqd31NLqspPzg7DwF6vXvNi3/3lC4veubscsrUj2F6qouk7EGHiaIuMSnCNToouquu9lP3Zp/80n1552XXjSGZ6zQs/BU1nfXNfeQ1HbaLy8gvTk6eF5q3K3Hqxp++HwjXsdDHOm4/mGk9cKdhxNWrOVdAVsAqJjitd5J+WYegRFLiuPLCh3i8vUt/r3HESkyE5Mi9e2V9JyVtD3VlKxkveNdf3TP72enZpDkk7oKtuMnT6VF9OOPam5yZw8+tumFW3xmY2+YWvsHBJ18gqy3/7FYDerSO0Ryx2Fav3E9odJtERKNEVI7AgcV+0ukmY8KjdFcPuRtE6VU7mzBvgPAc9+fAv4vTt2ZCspNRgYlmtplamp7zU2abW1veLsctvN/Ud3j2surm22dgfNzNYt0E6ePcdUTk7QliQZVEJiFpIYTly1ZWndodX7v6natnN19ebYtMV+CYt17dxJHW/pG07Kd+uA6O6V5Zy8bAJjl2w5kN9wuGLf8fqjZza33ixqPJGxbkfgoiKvxOxFGxrjyzY4R6U6hC5MX7cjKKuUFPEtLS3Xr183dtE09FN2TNZ1X2zou8zMbZEhyWlttzlRSW9eoJlrNNkxRTd6nWPmbr+aK8uevHjIdN9d/2DVhfhFe/xi1juTJ/GP9PzT3alaWeQ57zMS50W2Y1c6CpfYCS2xGBNjLFm5slCQL+jQCngqc2MA/yHg2a+pqYk/99puWLGiTE1tn4npOXuHAi2t9do65OtjVtYk10/b2R23sm4yM9uqp1+gouI3ZUpOxv9j7z3AmkjXBuxTvvPvd7l2BZQivfcOoYRQQnpPSEIKhN4Jvffee0ea2AtYsCuoq6uugm6v7rq9fOqu7q6uhf8JnOPvv2f3nNWFBMjcF1euMEwmMxMy9/PM+77Pq4CJPRCeEpmUHpRenN25I7G6E3TOiUkVJueF5VbNTgMfW9Yire3OaN2S2tgXX9kuySrD80MJgSG7r37YPf5Gy5FLYPSCvn05XTsgg6/YOtZ48Hzx0IGY0mZI4qv3nEprGgiU5pSWlwfH8+kJ6NAqSnIfP2NYlLNbkj4sTNrMCy4nkaPdW9qan90lRpg/ZPBJvbySscjBd4rffjz2ZPrBew+PdUxllB2Jgi0E5mJLa3+35XhycrK5ujhBgEuiWxXEcltrij9e8BGkotrCEcErCYjglz5yq5bVml/QgkafpNHfFgi/j47pZTD7fHz34gmHKZTDFOookTSMxdZ7eMRaWtE9PRdyXqUM5BYUCZPzqZJYoiAcUvnk+l7QeV7P7sy2YVB7Yf8IKBxUXbHjGKTpsjvw+TWU4JjB0dEL39zffvWTpoMXYJ2oonpxUs7u17/sODlVvv1oSv1mdlRK7b6JnK6dgdJcVS0Nf4lzeA01dSCwcH9Y6dHImokEyMXhOdhaUkH2ZNs8excnOTuBnugV28rO2xtSM57QMZm574PG1qm0ypMxeftC4jo41DjP0f0LtDX9xVBUW7iiylcjyBlE8EsfuU1osX90tMHD8xCJPMnlfRYa9iQ371xlVQvWv87do8kTXe3mnuXgEGRi6qCqGhcWJof9QfhNILSqqW+gcvgof4ofWxSWV5XWPCDT+e5TDfvPgdQhFwdJtxy53H/2jfbjk01jr8JfM9u3BmWU+NID7j+ZHn3vdtuxK6XDY9KaLlZo7NkvH7Qfv1q58wRECZDBl2w5BLGCIClPy2iTK9XSk2NLT0R3Xske+7Ltyv09g+8VV4/H5Y+ExrWxIblvbW95umPj4+PeAoegEmLSZn7+vpDSI1HVp+PKjkXByhAQBJUSxan0JRYXKqotXFEzTCLIGUTwSx+5zf0sK03j4LjNH3eOwXwrUHAzWPJtZNTXwZJDZAok7tkODmHm5ml29ul29l4GBnLYH4R/Z3xigiEM5cZlgIA9SSxufGZa0wAoufHg+S3n39h37UbPxFsV2491Hr9y9MP/++jBwzOf39s5+Sn8daa5vYUeGv/mhzeO3LgH+gfrx1W0BSZmDr/2SfPYRfB9YnUXM0Iqq2RX2wOmd2NYcTP9wO64UBdCmFv7zprvn3z50U+Xe1/PKzkcKbvlnudf01T17O5l5qT7h7iIi4nx7Zy0IUHGsAgeEzoDwPq0KO8JRVSTnVcUJfg/M9MjwiICEfzSB7wrtzmns3m8Jk/PUSLpn/VlAwXXuLzLItFFoeg8hzNOp+/wxxW7uHioqy+xVGxRILO7JEqUkp9U253RMoQNCArNqRSlFJDEkViOiCaJCU1MjssvA9+XbDlYufP4wIlLRyffGXnrm9k78KkNfazI5KTKhs1n3244cL6wfzSmtAlihdajr9XsOZ3TtUOSVUaVxGa1b5Nklfuw6TEtTGk3N66dE1lP52X5Yfj2owd3ff/o8963csuORqUOCrhZfhmFvy5419PfCWuyUrxFhfjgcpKwEM9IwniybYpLixVy0uYVRbWFI4JXEhDBKwUgePkItbuoqMzVdScOf4rBuBYo+Li84odr13757LPHnV0fisSvMFk7cbgiZ2eqnh5yfZEz8A/AEIVKMsuS63uLhw6K04rciQwHjD9ZHDXbYR70zIvPpIclQGYfKM3tOnWt9dgVyN3Lth2G9YsH96c29jEjkyIL65oOXSjfdiSteZCfmMOMSKrYcTyvZ3d8RZswITMgLiMstwofGMTPwebtkRQfjMjfF5K9M1hWqaYAjw9275ssbjgvLdwfltjF5aT7btk69Kv9/PjjG+5YJwd/EzeGlXeggyfHxptvz0zG+Imdan5rjNyiRlGCl9sFAUGxIIJXClavXi2f73N7VVWHF+YIhQqJ+5fhEU9Kyx5duTq9c+ed5JS3BMJxOmMY61/o5Czx85PDziA8S2d3D00Sm1jdmdW+lSAI82ULPcks0HlEQQ0k9OktQ9kd21Mb+2EFYUqBH1vUtWdk/LMfdl37rP7AK6XDY+DvkOxyZoRUWiObVTazbTg8v4YWEhdf2Qavii5uZIQnepLZguQ8kjiUEuNVdDC85ZW0getFdecSK0/IKtXEd3BoCWhqnGfJ4YjMbeKwaqqv2OlXcR78l8amhcM6kgpSUi8vbUgAwQE8Snu4QSVEQgRqVO5Tts8riursJrdbegiKBfmYlQK53ZG7c+dOnqMTZPAXWOx3BMJPgyXfxcZ9Iwl5VyC8zAkYI1PavTDRFpYiDkcOO4PwLOm5BUHpxRmtW1iRyeSgaDcCnRkujSpqyGzfWrb1cNWuk7X7JiAXh2QdUnxZZTpu0OsffXTq058hla/ceSKtaYCXkOXkgwe1QxAQkl2BDwzz5waL04p4Cdl+HJE9GutFZdthnMHEkKD3Xs87dqfrgyenJu4Mdl7PKjsSlToQKCok4MNc04eFMc1MTrpPUVXer3aypbXZV+QYWi0bVlcwElp8OLz6dFzp4ciC0VDZ4LoyEl60QIvOvhgKEbzcet0iKBxE8EqBPDvN1kVHt3t5HSSRz7PYU1zeW4GCazz+qyz2MQp1ix+2xMU1yM4O6cErf8gBQkjBRWmFOJ4kOKMUTQmQZJVld24v33605fCl3vHrWy68237iasOBV4oG96c09LGjUiLjky5/+7Dr9PXqPacgMuDFZbhiKbz4TAgRwhNTK6qqQ+OSUrNzW9vaZ+eJx7I9+dnYlL5AWSm662Xf/vT5wycPHk7/OPBRfuXJmMzt4rAaKjrANqSSzEz25kZQ//2uUmx6OCvZO66dnT8S2nox/eDnLZd/3LX5zfzq8fj8fSGxrWxKnOeZc2cUcgLnA4X0ZodPSj7jZhEUDiJ4pUCeiQJctdP9/Jo90btw+CMU6gkqDdQ+QiAO+PqVuLjwjYwbGxrksycIz4JjC4IzS7EcMTc+EyTNCJfGlbdCvt554urI299N3n7w+eMnxz65BzqvGzmT07UDogE8L2jPW9+2HbtSseNYSmNfQGw6jcUJi4iYunbtN1t8ItPF3Ew/6Uylmi3vlb3+4OD09MPvnrw5fKOk/HhU1nZxSAXZV+hIDvXq7Gn/zS2QhN6iIkLyZj5k7VvfrH73wYXbTz795OeLndcyS8YiYDk/B9vR3Tb/Z0tOKKSzG4QU8ql8haBwEMErBXK+E3htaiqTSs1zdGry8OzAYFrR6Bo39xRbW4GNbWtTk9x2A+FZ0BQOJO6+bJEotdDZl8iOSk1t7Adzd56cOv/Rt9/8/PiX6enPf3y0+/oXTYcuFA6Mxpa1eDP4dSNnG/afK+wfjS5pwnKDUTgqjh+CofES0rL+PfXMzE2nS73i2jmySjUT8YMfFF38ds+Oz8rLjkZT4z3dGNbuTGtbD7Om5t/9HyAGewrycWmDgsrjsSNfN9x98tXj6ft3H33a/Wa27Cb/oCAgw7ewIneeT5X8+JXgIegpLy7kk7E8X9cgL6s4EaeipHDO31RupS0RFA4ieKWARqPJf7hte3Oz9fr1Um+fUHuHFA6noawc6TmvQGLSsiWZpVYotAeR6YDxZ0enpjRsrtx5Ysur77/y9aPZdW4/nN771rfNYxeLBw9EFdVDNJBU2yNOK/QgMVE42r8eWZKsMmFyvh9bnJ2bP/vC8YlxThjFj4fCBNoHlRBT+vmF+8OqTsXVX5Dyc/w92TbECBRD6gX5Nz3RCx+OCgin7Nu3b//+UZDNs6k8O5QM60t7uMUHI5ovpp55NHj35xtHbrfXv5IIG0zoCmCn+Rw4tF/+Z2+eeLb3q2y2XAdTqsnaAIv1QTYqkQ5qYmsVjvk6lp324ED/HL4pvBFE/HO4QYQFCyJ4pSAoKEghFTHl1nsf4b9SUCKb0dUa5cWOSqEExzAjkpJqu0uHDzUfvrjr2s0Pfpm+9/OD8W9/2Xz27bqRM7k9uyPya1ywZC9qAEUSGxCbLk4tDMkq58Vn0cMSvGhceAzJqSAHRW8ZHs4rzvYROEBuLSzAh1ZR4DGshpYyEJizOxgSd1B+QKZfZD09ro0t7eHBY0Q9nZPui+HZg/ixwc7uDOuskpTZ4C8jJ40Y6RZRT8vcJi47GtXwirT5ckrt2YTSw5GZ20Rh1VR6lM9SChOf9mZvaGhw27SSZbYu2mlDqpt6lodmIUYrx1MzzU0jxmkDzWTt3m2/Hk/4wkCsL5/ZpxAUDiJ4pUBRJa8RwS8cBgYHjawdMDRuaG5ldsd2/4Cg0NyqnK6d1XtOd5y42jPx1pZLsolkmg69OlOirhUiABNbJ050Skxpc3L95oy24X+Oo6vqCJTm+POCgzNLIQhAUzjegQ6CfFxcOzu5jw9ilnWSb2ERIty8uHaeAbbwp5hWVtaOoPx9IcWHIvL2hmTvCIIVAvNw7kzr8FqauJjASfNBUS1H94/Cfws9FMvN8ottY4PRC0ZCiw6G54+EZGwVwUtgtfrWGkWfyLlkVvCTk5NoEw2+5fo4540g9So/7TqcTgtBrwGnU43VBtPHO2+EtH6uuuMpahJ6BPmDCF4pUNSkVSD4pZRvLV6Gt24jBUpmmt5TEqo6IHGv2nmMn5gdX9me17uncueJ+pkq9CmN/aE5leyoVJIoEkPneZJZ4rSivJ5d5duPQhxQu2+8YsexosH90pquoPRiDyIDxM+KTEazXcDuObuCiw+Flx+PDq+heXJsvQUOxAgUPQEd08wC60MK3vZqxuDrxfXnEiE1hyUgbHKUGyXGI3VQAM9B6uRQLxD86dOnUXQrSPFDq6mw2cRuLsh+puM9BhL9pRQvPq0hLeGxCIarox035KE1q7E67SS9bor+FpZxH92wi6xfj9MpwmjFOm2I8J2bhnNFzf4ImqwAACAASURBVFGLIH8QwSsFihI8MqfFQgBiLIoonBwU7YDx5yfmpDcPVu062TP++oEr7ycU18WWNkuru0SphbyErLDcqpjSpqS6ntiylrC8Kl58ljuRIckqaz9+ZfDcm4PnZePo6kbOFPaPJFR3UoNjyOIoSVa5Bw0DCXrF8Zht71XkdUZhePaMJIyknBxRT49pZkp7uKWHo4beLZm4N/Dp9Csnvuttu5xeMhYh7eEF5vr7BTmVHI7M2i6Oa2MzkzDJ2QnTM+ZLy5P6Ch0psR6wKXK0OzUC09LWvJTsPv2v4WpwUF4mGmTjNSF2qmluGuDyzWyL43GY98q4xyJc9wRadZH16v11Mtw1uJbr5yRcRgSvPCCCVwrgK62Qm3KI4BcCUQlJnJjU2PIWJx8CWDyjdUvNntNbL3149buH4+Pjrj44R4y/D0soTM7P6dohmyh225Gigf253bsgU4eFOJ6k/8yb7/z46NNfHh/7+F778as1e8czWraIUgr8OGLI+N1J+Px9oc2XUvZcb/cLdIFcPKqBkb5FmL0zqGA0NGNYVH40eu+7bXcf3no8/ej+k1ub38ktOxYFy4PKiN58h57rueD7jGGhuIRAi/R+uttgvpHREfA6/AstMbXPMiv406dPW6otY5mvi3BQA4uX+2yqxmo34nW7eQ57Q912CWyHGIatRN18L60we7UzczHdjqLCfQT5gwheKVBUtxpk2umFQGBUYmh2BQgbQ2Zy4zNTGvoqdhyr3TcuSMigBUUxI5ICpbkhWeWB0pzk+t783j0RBbUMcRiZFcAISxAk5cFL3P1J391/8nB6+v07D7e99nH96FlYLTy/BoWjwguxAlnpus1v5UmLI0jR7lFNzPRhYdHB8KpTsS2vplWeiKk8HrvrZvXNh688mb5/8+Frve/klh+LhghAVIjnx5FGP2upmYjP2RUc1cjwlzgvSZf/JrPj0cuLC330VoG8szw0Kny1W4l6XRT9XqrBZppBB1m/AadT569Tj9Mp89kUaqfa3ToHo0wV1eUWQf4gglcK9u3bhwheOYE0ER8YGl/ZXjS435cthHQ8uqQR0nRYSA6KCskul9Z2pzUPZnduj6/qcMb4+ZmokY1lI7X4luvpJmv9DVa7u7n6MAWz3v3w7uPhyx83HjwPgg/NqfBli3igf6ZD3t6Q2jMJ2CAXXjZW2sMtORTZ90bh8Vvd7z85tvfT+upT8fDXrTfLr3w5OnijqO5sIug/uY8vyMcVVGac+La/ejwOthDZwMCFuChPp41ZwRMcTdlm6xJdNoLCG3E6wwEWZ6Q+1/JoR8Kcd/Etu8l6dTidXLRmEko9xE716MHRP/++ipqjFkH+IIJXChQ18lVRk2UhPGVyagrHC4krby3bOiat6XInMCBfB2HTQuPD86rTW4ZKh8cqdx4vHT5E8PWmGq+NdFBLcNmY5qaR6aGR5Koe47QBZO+qu653197bPz84eOPubOXarI5twRklviwhjh/ETvXO3hlUOBrmwbKRlJPThgSQoO99p+3zX9776cntbx58sPntvOJDEdWn4xovJNWeiZdNNrNdHFnPIISjWvbmdFxPLz8enbUjKKyGyksgKfqE/SHm5DYDfCt1dHRsN74cZKOa4a5RjdXuY5q8IvX+ujfp7mjN7faQiViPIaZRO0mvCKMV7biBZbZuTqIf5FupPCCCVwoUVZwSyRUUDijBnxssTM4XJOVC7o6mBHiQWO5EhjC5IKN1GOzeeOhC96kpXlAIiBx0nofWhFSyBqtT769T4add7L0p2VVdaKXiZ2PYd/69jpNTDQdeKRk6mFDVQZXEonBUe6x5bCsrpT8wrJpKlLiJi4npW4Q1pxP2flV759GHj6d//ObRe33v5pUejszdIyncH5a3TzbmLbaVHZDhy0rG1F2IrzwVWzAaKu3hcTP9IqUhij5h/wlQsojq722q4a27CqO7iu5inhYT9sKyB8v+5S9/QWmtAMHneGo2EvQHWKYXCnm3b0w+efzLk3fG3ykP2Mk16yDrV/ppg+BDGLg5OQqI9RHBKwmI4JUCRU0vgbT2LQT82QL/gKDo4oakuh5flsCTxKIER0cW1Rf07Ws5fHH3619WDezAGayOdd4Idq/112kj6XaR9Xqp+p1k/WaCbqnPphQ3dUgfMTgS5O7FQwfTmgaC0osJAaKg0HBdS3U3hjU6wJYYgXIimAkL8UmbebI6dK+mjP3Q9vn3V/Z/01h/LrHwQFh8Bwd+YltYkOVD0u8d6JC1PajoQFjubknSZr6knESL9J6amlL02fptwOJZqUk+equ4FuvFNirhDmpgXImdKt9yva/eqqEXqjQHsS+41kN7pdhGNctDA878MNfiWh7t3o6s6Y+O3z9Q+0qS93aOSRdZH0KuSAe1turSOTkWiPWRhjMlARG8UvB0xK2c+TMFds6fORPPYkWh0RIzsyA3N6lIhKQdL4Y4IiYgNj2loY8oDGeESyGhJwdFz5SxG2s9+tqpd74oLyvmW61Pd9eowWqD1A9IHK/mUF7LJOwPtgfNN+J1CzFaYXZqviYbM9u3JlZ1iFILKIJQ+DgEERz/YOfAXGxQKTGynk5PQJOj3OGJbOD7kcjaM/GNF5Kqx+NKDkdkbBOF19Jo8WhihBsl2gPDsw+tpCR2BSR0BUQ10EVFBP8QF1IAVtGn6ndJjgqFGAjUnoxSBxkXeGkVY7QgHsrw0IhwUCMbrzn2/AV0ZwvO+NiZQJQAJx/S9C6q0fYA8wtSn5sdkdfScXt45v00A4ix4PwH26ruHx2Zk2OBWB8Z26IkIIJXChaX4GFvyxITM+0dil1c6tw9Gjw8Sl1dsx0cAgwNEyMi5mM/lzbSzNzQ3EpWVDKWI44srONEp9JC4hKqOsq2HemdeOPEp/fjxAFgqXwvLXDJ7kDry5n4zwfyHh6re7dGuCfQqptiUO67SeqqTjBcw41Lp0nigiJjP/7kk/zSHHKMh7iEmNjNTRsUZO8MytgqEuTjeFl+sa1seJ63L0R2T36vJH1YFD0zATwk+lFNzLoJ6au/bD1xYXfVPmlELR1ewpB6kWPcc8pSFX2qfpvGhgbI3UPsVFNR6iXem+r8dZoIum0kvQa8LqTduWhNWU8Fh+eeF2528Gp0mARvuDrKcQOc/zqcTjfVYIhptJVtMswwBLu3k/RA/BBVkIzWzFWAq5Ap7BAUAiJ4ZeFp1Wt58gIjbsHulWJxgZPzoK/fLhz+AJE0SiTtxOEH/fxKXVxCzcwi+fx52tulCpkrCsoogdwd1J5U15PbvYskjoqraCscGG06dGHr5Q9JzuYg+FKfTW0k/d0C64+OVDz56a3pB9/febXtaLhLL9WgFquTglInGq5Jy8i8dv369Gy3Ta5dcBlJ2sMFhReNhdeMx5cfiyo6GB5SSWGn+cBjbCsrvoMT08IKLicxkzEeLBtYmLMruPJkbPPFlKE3SxovJVWejMnbGxLXzqEnogeHBhR9qn4bvIMpx2IdWBZOkWyEOkV/gGG0nWs+W2kOHA9ultiq5sSHP9dmZwvOwD882dmMb6kidd1YhNGC6KGVqNdJ1u8g6UG8BXbP8tDkmK9D66wkG6/F6K5koSy2b/lTJwqpL6k8IIJXFhRSFh7s/rw1s/rb2ytQqCE/7Aka7QKbfTWAezkg4DyLdYxKBcfXuLnzjYz6++dycq2lzcjoKJ4fIpvsNSAoJLs8s31b7b5xbzovKL04q31r5c4TbcdeY/p7hdurgV3aiHp7RXZX0/ynL7ZPvz7yfovkgNi2h2oAmkl02Ug3Xfvxv8TQ3ddBjfOAdByEXX9Guu/j+qt3d2//oLLtcnrmVhEt3hMX4oIPc4XUnBCBwgY7+4ocfQQOwkK8tJubu1tSPBZRcTym9HAkZPlJfbygEmJgEmVhjoCfnJzE6q8OtZP1g6vz1x7kmI8nYN4pZn3VJBkLcdzBNZ/tBAfnh+vwfN1cnn47ZNV5tVbwLdcnOG8EnZd4byr33VTms6nASwusz52ZXA4isHjnjZEOsoZ/nuV6rq/rC0taIbE+gkJAPmllQSGCf94KerCHCS6uvT4+x6m0K5yAD0LDPkuUfhoe8YEk5BIn4CiFutnHN8XWlmNlNX/7vMRoaGnnxmWkNGzG0HmhOZX5m/fW7z+X1bqFGSGNK2/N791TvfsUicMXWavmojUhPe2jG40IrS+nYd+sDjwcbD8oK6OmB5lrjNMGkT/q6WYjk0L4OdiE7oCiA+FdkzmT945//ej9rx69XX48Oq6NndjFjW5icrP86Iletr5GhHBUQlcAJ90Hw7MPzMNBTp/cx08bEqYMBMa2scXFBEq418Rc1GibD+B/GG+4BuQKAVArSX8nx/RaGf/Wyf5fpo582RlxQGTTRzOox+lkeWgIrFWeS7rP3t+ampzk+LiQjdaIbVSiHDfEu2yMdtwQaKUCdo912gAbz/fSAvHDPsDHlO6uAasFelq+2BEhglcekE9aWVBIz5rnnbfq2tRUqYvrLjzhMicAvP4gLX1667bpvv6fK6veEQgvsNg7cbgKVxTX0Ai5x/gHSUjPDsmuyOrcjqFxo4rqweh1I2eGL3/Ei0lhR6fGVbRmd2yPLmkEtYDDQOQtBN1eqsEWpvEw26SfZtBB0qvCaoNRIL+sLS96ullJAj8g0xc8XTIWOfh+8WcP3r5x44PckgxvgYMX186LZ4fh2/tLXFypli4UCy1TNV4OFpQvLiHAn6ixnrxsrKyMXTYWcv3IdPH1168p8BT9Z0qLCgmGa+KcNkBK3U422C+2+3Aod/rxremf7jw50zwWbAeCb8LrQn4fYL5+fPz0H9/yr3qoQHRrYqBnpfYyWmclWnulg/pyvtX6BJd/Dm2A2KuNpN9C1GvE6Vb5yT6RUHu1kqyU5z2cpwNqvvnmm127dm17hldfffXRo0fPu0GEhQwieGVBIWXh/2AFvdk5xAb6+8uKimrc3MfIlEku74v4hIe7dj/56qvpb7+d7ur+MjLqEptzgERu8PDkGBgg43z+IILwWElmGXgdx5OE51Xn9e5tHnt1x9RnB69/kl1URgmODkovji5pwvj6CaxUUlDqxd6bIB9tIepC4g7eApdke2qG2auFEd2fvQMEVuak+yZ0BBSMhpYfjWYnY/FiNzA6JdaDnoiGJ5CsY4OcweKQx/uJnfRtNEiRbgEZvoJ82SyxIP5QqSCvJPvAwf0L8878U+B/mGi0BvJpyJ6bCbo7+JaTWcT7o0XTk0M3qrn7Ai03U2UTvmXIsmrV54o7f1UlIozP9tNbDZ9CostGlNYKiCoiHdQKvLRq/GXzyw0wjHfyLQcZRn00wzaiXoWvdpqbBtV47fNGuk8FD3ZftmzZX55BKBT++OOPz7U1hAUOInhlQSFVY/+r4CFlLw4LDzEzi7eyjrGyIujolLuiDpHI13n87yKjHrW1T9/4eBocv337p5KQKwHc/URSnbu7wNgYyeD/IBV1jSD4rI5tIPjgzNKs9m01e093nJwafffbt76523fiImVmUjiSKNLVWAvSdMjjMz00CjFaWR4avvqrHNWXg2zcN63AezhVlBQ+Pe3Z+RnsNO+YZmbuXolfkBMonJ/nH1pNjW5mxraxw2tks7zjQl24mX4JXQFBJURipBuRiqusLc8sSq5pqDxzdmKBe/0psJ8umssltrImDBB5L81wF9/yVCTqSiFjRGA5xDDqJOlBGCR13RhGcH+uLT8r+KbGBm/dVcG2qsmu6nDynTSWw2eR5Kpe7rupk2J4JMrjzULGF/Wid4pZoyKbXqp+K1EX3C+xU+1seb7q9E9rXlVWVlpbW3/xxRd3/8X9+/efa1MICx9E8MqCQspX/ecSuZvb2qSuKEjZW9DozT6+XRhMuatrmYvrXgIRkvUPReIfpUm/DA493rb9XqL0faHoPIu1G0+oRLnhtLXleBCLm4HBQWa4NKm+FyzOCEuQdZ7vH6kbPdt+/GrPxBtgekjoGw+cq959snR4DMfkYQ1Wg1pwBqvB61STtWzzdSJrFdAbz3I9zWQtWmclqGh6JnTDBjuHVVNxoa6ECBRk6vEdnMytotzdkvx9IZnbxcl9fEk5mZHoBb8m9fIkFWQfoeMiDcsiBWym2boEl43F3jO96KkGkEkPs0376YYdM73oczw1wc21ZUX/fVvP8LRkLMQQ7kbqLPN1Sa6yt0h103BQf1lsowIxVg1Wp49hcirR97vDbfeuHHm4v/xyBn4n17xzpvoNRGMNFcXP9aZPv5IRERGwA/fu3XuulyMsLhDBKwsKqRoLV5PfK5E7MT6e54lu8UTvIxDHyJTTdPpRCnWUSIqxtOr29j5BpV3j8sDxXwRLPhOJ3hOKIH2HFXq9fZJsbGIDBXI+kMULyEMYmxKWW5VcP9vPriKjZahk6GD59qN9E1Nn3/jwytffb33t46axV0u2HEqo6sho3WJiaY3RXQVGj3PemIxSh4Q+B62Z5qaR6LIRNIY3XBMlYMOWBXFMXpafL9d1Nk3P3hlcfiy6biKx/hVp5YkY8Do4XlRMiGlmQZYP+qdL0Q1tNYo+H8/NQH8/2NdFc4XAWgXS6yKMFhi9Ca/bQtBtwOtWYbVzPTUjHNQyQ3nPe0/iqeDh0U9/dYitaraso75OM8kAoiuIq+DM1+N1B9lm17KJd986O/3T/z1698yn9aJdXLNuin6Vn7astHD881WGeCp4LBYbHx8/NjbW3Ny8bdu2W7duPXny5Lk2hbDwQQSvLPyZonIvzO/VwIdLYT6d0YnBjBKJF1jsyQDuW/zAazz+5QBuK9qrxMVlK9b/BI1+kc2Z4vLgr7DOMQoVFpa7osR2dgu2oOnCBK7pOJ4kNKeSIAgTpxalNw9V7Di2+cybI69//tF3d899cmv4tRuQx5dtPSyt6WKEJ/oYqYJdZodlV/hqg88acDqgE0gZM9w1wu3VILPfPzoCWrL1NSJGoCA7Tx8W1o5Ld35SdfnezjfuH9h2o6zsWFTuHklkAyMwF1d6JDK5ny8qIsRlLLI6RWB3tM7KAIt1dFPZ3QtwfJzzhnR3jXwvzcKZDu0QAIXZq4nRVi/Q4gCiBcdD5O2N8YKwCcIp2GYLUX+PwBqtK6uaB28EAUQXxeBoBOqL2sDpC50/b886Gua0jW3cQdIr8d4U7bhh77ah53rTp/1eDQ0NX3755TVr1lhYWPzv//6vurr6xYsXkU52SwxE8MqCQgT/ezXwXzlzJs/RaRcOf47Jekcg+CIz63ZV9bfpGR+HR1zmBKTb2ec7OW328d2Dxx8ikw+SyLvxhD4f31IX11B7hwFkEPzzc/bcOWFMMgpPE6YWZLZtrdp1svPk5NDFD4+98+Xw5GedJ6fqR88W9O2LKqq3NNLlmMuKuoDdG3C6HWT9Htnc5IadZFkXbvA9pJUhdqp+5poEpu/sELjoZmbubkntmfizn498/cuNB9Pfn7+9t+VSWsFoKGT2ARm+kNlnDIvExURKkK+iz8RzAP+9GBMNgZVKgsvGfC+tYm8tkvEaguEavqWsHD0k3EJrFYrx2qLMlBfrTwCxb0FBARiXz2Y821H/QJC9l6km3WQtxFiwpJWkP8QyHRXbTsR5jgXbbeeYbKYZNOJ189CagVYqn3x847nedFbwP//8s6urq1Qq/eGHH2DhzZs3ra2tYcndu3df4EAQFiyI4JWFFygq9+f5vRK5va2tzZ7oMRL5On+mM11d/fTEmelDYz+Xlb0nFJ1hMBOsbSItLCCVr0Khqt3cS5xdYEkSm30Nyd3/BG0dnVRJbExpc37vnpo9pyFr7zhxtfXI5dqRMyVDB5PrNzMjpL4Ga8PsVcFntf6QO+ofDHG6mE64mIbbJ7IdYBg1E3TLfWVNvzSTteYuOtYYQ8jgIxvokKx3Xsk++UPfk+l7P01/deWHI00XkosOhid0BrDTfCCDTxkIlM1Dkx+t6HPwHITwWSSjNbFOGwpnbstDiNNLNeihG0PeDI6HMCjETo1htk6MQ/33bf0WT0eujo6MkP7VUb8Jr7NXZDcUivHTXyWxVYVwqtJPu42k10szGGQaw08PRb+FoAvih7AjiUf8g+81MTGxatWqv//973/7298cHBx++umnX60wODi4bNmyd999F7lRv5RABK8svEBRuT/P7wm+JT+/Fe11ik5/kx/4XVb2kzNnpx8/nn706HFt3cdBwa8wWXvwhGJnF4ymZkFaemlCQmVx8dmJRdPveiGTW1jEjEiKLWvO6thWPHigdHgM1J7XuyeptluQlGfu5MYwXQvmKPHeBLn7/mDHK5mEr7uljw+UvlPJ2x9kLytb6y8bEhZko2php2nnZ4wLdQmvpWZuE0Ga3vt63uUHOz748UTf+/nVp+MKRkJlgk/1zh8JTewKYKV4R8ctplv0eEdTSJFT3WT3yTspBmMRqOv59K8ag4+Gu+wOtALfV2O1k1zVuRbrX2z7T2vCwyNKa0XIvzrqb6Yb7RVYE03VwPoRDmpZHhoQVNXNNPw3zlS/L8ZoJbluFDnr/fF4F4wO8n777bdjYmLCw8P/3eKnTp1avnz5+fPnkbv0SwlE8MrC89acmRNAyb9ZNqu3pqbRw/MohfpGoOBWZNTjhsbpDz6cfu3Kw6rq94Wic0zWdn8cCF6IesHcCOE/UFpVSw9LEKcVQSqfUNkeW94allsVEJselZyZLE2E1DzVTb3aT9b0Oxrm/Mnxqh8/n3xy76sfzjcfC3Xspxs24HQhvw+yUdHbsNyDZYMNcgqrpqYPC8uORLW/ljFxu/+De6f73i2oPRNfMBoa3xnASpWNpgupIGODnb3Zzoo++j8K5NaumivC7NVy0JoNeN0tTJOLGYTvDjT+Mjn2bXfkUTgVM/fJczw1BVYqv1dhYrbAQ1NDQ2VJITz5VYT67KQvNC9nltm6xJnQCkTeQ5X1z2eZy0YuhNipSV1lJWzz0JrwdunuGpDrB7vqHXyhyeUgyodYHxJ6Ly+vDz744DEE1jN0dHSsWLHi5s2bSAa/lEAEryz8wZozc85vCv77O3dKXFxGiMRLnIAPReI7MbH36hseZGV/Fiy5zuOfotEH/fxSbe3YeLz8d1gZACFJM3MDo6Tk4GhmSExUckZLayssPzA6QjNdK3VVr/TT7qEaHI10e79OPP3R7ul3z3x7oOBkpOvTqm1iaxVrM1XvQAdHvGlAhqwXfd6+kMqTsfWvJDZdSq47m1B6JDJruzi8jgaJOzfTL2kzH56TYzwWy0g5kLGn9spQO1mpmRai/g6e5ev1YY8f3Jz+5e70lYFTMe6DDMNmgmwwOt9y/exErvCSxoaG7NSkOBEnPiJEmpjobaqB0VlJMFwN8iYbr/XSXZkbH/70DDxbPRoWum9aKbKR1Rr6Z0d9gqyjfqCVClZ/Nd10Lc9yfZCNKgQTfEuVMAbu4xc9jbOjaW7duqWhoUEmk7/66iswOmT2pqamXC4XKXSzxEAErywoSvC/VwM/n87o9vY+RqFeDeC+KxDeCJZA7n6Nxz/LYO7BE+rcPULMzJEJ4OUMfFIEwzWyW/QzM8sNMY1ORbt/2xr+077ciym+O2dGZ9X4y+quB1qtN7HSRdEs0QG2hAhUSCUluZ+ftzek5HBk+bHowgNhhaNhuXskqYOC6CamqBAPf4pv51BiPfoHFk0fSay5Zqid7LZ5A053OMD8Yqr/D1tSpq9t+bYjfL/AcjbWyfbUFFmrTE1NJkllOscZrGaYrgWdW6ot89KRDTUMs1eLcdqQjFKPd94Ybq8WZKOC0V01GxD8KvYdHz/trbtKaK0Ca2bIOuprzXbUT3JV99VbHUjG9rQ1nZkY/5MRElwEZofLHj58WF1d/aWXXlJVVf3b3/5GJBK//vprJH1fYiCCVxb+c82Z+eP3BA/XqWwHhz4f3zEyBaR+gcU+x2SdpNF34/HNnp5xVlaF6eny31sEkpNZ8L8GZIPOt7JNdnBM9gmtt7KMNlMNIKcs9dkU57yRaLRmcnLShWzhRDRjJHmFVJKlPdyKI3HD12o++PL6h99NHf+2v3o8DtL6qEYGLR5dMBoa08IiR7vvP7Bf0Yf4R6GgnbkW68G11VidLorBdq758XCXyWLWAZH1EMOwm6xfMzOLbgzFI4TP8tJZybNYDy5PdNmI1lkJ52d2qGEeWnN2tGHpzOxws2MQuDOTx//7zS1YmBEbBq+F+ElsI6svJEvZHXW7W5vmqgPK08H3wN27d48ePbpr165r164hTe9LEkTwysLvDUmfb55taPwVF86ezXdyavT0HPLz2+GP2+bv3+vtU4VyS7C2iaDRF2aXurMTE5VZWdE4fKCra2Z0zNIbs3fuzPg/q7ZhtOpxsirovVSDzTMTnzcTdEFUsz3sqnPTYOXxiXELdz1qnCfIO3e3pOp03PZPKj/65cT1+yMdU+nlx6OydgSF19LcGFY+dEtnCzWM4RoBBZudmrQobtRDni2r6uO4AZJpCHfA8QN0w2G2yQDDCM5GA04H5A0JurGG7C66cKaGPCg81E4NpbVCbPPPorP1ON0Wol4H2aCNJKvtX43VzvLQiHLYQHY2+83+p9Mzmh8eHKgtK+5sabo2NTW3XwSFlKxGUBSI4JWF3xuSPt/850lu4OJVnZSUae+QZmeXYmsbZ2WdweWOjrxI76H5RlacJzRUNkbf0anGzb0Chcp2cIi1suJiMItCV3+cpKhQjrmsjF0uWhOMDnlqjb9OtZ92sbdWqptsShUPI/Wn1oEP15NjKy4mpPQHFh0IrxmPrz+fWHc+vvJUDGTt0c1Me+dNJKM1LLN1gVYqoXaylBSe4wxWg+YVe5h/hLBANtNsbZzzhjy0Fri5Aa8LUU4jXhfOCdg92lHNz0zTUnUZd6Zu/KzOKcZrycZrIJUv8taqw+lCKLAtwPxQqPPWmcgANF/pp53hoQEnQV9PV/5HpJBJpxAUBSJ4ZeH3RqzNN3/wggKOJqkT3wAAIABJREFUnJqcXJhZ+/TM2cvm8dgGBvATYmbGMTAMMDSMsrRsRXsl29oKXJdab//MuDAwUIidqtRVPdVNPd1dIwWlHuWgBpL2sFRzwps5k8zTC/6ZiGfmpFPjPSFTTx0IzN0jKToYDqaHhD66heXhoEE1WQtpbtJMyVtIhSF/TUapRzqoUY3XSug4RR/ofwE+d7a3C8t8HexwKkodIh44hNkCduH2ahKMdbI0EYIVeD5TOUA2Vj7ASk1krQInrcJPu5dhfDrR98Myzp3OqI8ruGMhDptl88ToQaIP58Te1ED+R/Qf7qghLD0QwSsLihL80rglWF5cHGRqmuvoWO6KavJEV6JQuY5OsIRraNSJwUhtbGLDwhS9j3MMhGXhTBzNZC3ddC3bbB088bXZ4II3Dczzh3ydl+VHS0C7MaxGZvqLiaK5lFiP4DJSTDMrsZub2BUQ1UB38tJnmq2LctyQ5aEJaSv4D9LfOn9Z1VtwZKzTBrb5utamRkUf6H+nqbHBV28V7K3ASiXYRhWiHJ6DzmBnC3ynxAFMWJ74z8oBBifiMNEehsG2qjmempC+9zONxzMot84M/PTmuceHa17LIu7kmnWQ9ct9NyU4b2R6u8j/WBDBKxWI4JWI3xyxNt8oZBa7uWV8fDwZhapz99juj9tHIB6mUPYSCPC8zt091sqKpW9Q4YoS2doqejfni/DIUDeaJSvFO6ZFJu+0IUHKQGBCV0BEHZ2ZjCEE/XPkW0tbM1HiSY52hzWJkW4W9ppoHdkws1xPzWqsdhtRt5uiP8gw6qUadJD1QPaQ8oL7vXRWLhbfwL/x1qGBtubGZ9vFSZ5OHPN1aW7qVVidHrrxoUh3nrtZkI2sl2I9Tncr1+JaDunHa4emv7/xy9X9H9SJd3LNZ+eJgfgmkUuQ/1H8XqdXhCUJInglQiHf7Wd77S5G4IylkMmtaPQePOEVJuu1AO51fuAlTsBZJmsXHt+C9hKbmMRYWUVYWCzJpk2wrx8PJcjHxbSysnaIC/eHlx6NKj0cWTASmrZFGFFPZyZhiBy/p+ufPn3ax89He/VLFqrLILWVum6s8NVuJeruFthczaF81iA5Eu6yV2gzUwZO1gUd7Hhw/0LscvEHEVH94RCSUDOVA2iGF9LwxSwXEHyGh6zvfTfF4KDE4UYFd/p0/b2+hMMS+60s4/Z/zRPDwCugMr9ConwERYF82EoECF7+2ZJCpqmdQw7t359p77ADhzvDYL4jEH6anvFdQeFnkZFv8PjjdMYOf1yOo6PA2DjSwmLp9agH2rtaiRGo8FpaxlZRyeHIgamiYze6+94sbL2UXnQgHLJ5cTHRO9Dh9gxFmSnu2iv99FfRTdeC4MXWslLqkKwPMI3PxHl9OpD16NVdt7ckjce4b6b+s2BOsK1qVcnzTaO+oEhLltJNZXFM6UzlgC0s4zq6Nd1kbaKLbJ6YFqLeEMtkb6DVsXCX0UCLbWzjXqpBAxw4WpNvtZ5Bl3ddCkW10yEoCkTwSoRCOtAqZBa7OaS/ra3Rw/MgifxGoOD7uPjptvbpVy9OD235PDJqissbJZIaPDyZ+gaxVlYff/yxond27gmLCwrI9I1rY+ePhPRezxu/N3jz0cXPHl3c+2V9xYnonF3BUQ0MUpS7VJroZSLrGS6xVYXcVOqy0W3TCqG1Si5aswkvk9yl+uBH9y9MP34w/dnRs/HoLUzjZoJukfcmEHxazCLuviArL6GzKsRO1uheO1M5oIdmTJHVl/3nPDGtRL0eqsEAw6ifYdRFkQ01LPHZFO+8wW7jcvmXjlbUUBoERYEIXolABP8CtOTnN3l6nqTR3wwMvF1WPn3j4+knT6b/7/++T069zg88TqU1e6K5hoZMS0tF7+m8wBATOBk+SZv5xQcjeicLP7v74eMnsurlJ74drDubmLdXEtvKhgwePVO1LX5mZF3hTF0X0kylF5Bcnb/2ENv0TDz62+7Y6bd23N2ZdSLMqZ9mAKqbnfBUyGEulmb43yRCwObM9LObrRzQRtLL8tDEG8q61sPhQx5f56/TiNdtwOnUYLXh5MCaAiddaWKi/AWvqGIYCIoCEbwSoZAO7QqZpnYO6aiqavDwOEKmQAZ/Nz7hSf/A9PsfTG/b/l18wjUuDzJ7yOB5RkaN5eWK3tN5obg6n5Puk9DJKRgN7biSefROx6PpL7+Zvrbtk9Lq8bjcPZKoRoaVsQrXYj1k7YUzU8i3EPW7KAbhDmp007WpKPUqP+1Osv5WtunxcJcLhaxQRy1v3VXOGsst1ZY5aSz31F6JM1iN1l7pormiMCNF0Yf7Ity+fRvvYBpgvm42vin33VSN1aYYryEbrw22VU1wkdWdhfw+y0MjxU0dTkuwq97oyAhEvfKf3RERvLKBCF6JUEh/t8Uu+Dt37uQ4Ou4lEC+xOR+Kg25FRP5QUnonKvo9gfACi70HTyh0dg6iUJZqz+TR0RFCOAosnrMruOJETOvltB0fVPa9m1//SmLp4ciMYREtHu1vsDrCQW22zEsPxWC3wOZ4lHsPzYhivDbMTg3S9NkycBkemh6bVoD2MDor7dWXU03WCmdK38Q4bYBkV2yjAnkw0VJrMXbJhE8/LyGcZrJWYqsKCXoySh1++Fbr3TatJBuvYZuvE1qrBFis5zvqZsaFz/6rKETwiqpXjaAoEMErEQrp76aQC9ncUi4SdXphDlOolzkBbwUK3heJ3+QHXmRzxsiUDgwmyRU1MT6u6H2cL2SVXqIJgnxcYjcX8vXSI5HVp+OqTsUWH4rI3hkU28pGUS1BYEmu6hW+2psZxsejPN4pYj7alXujil9HtZit6ZaPhvxV00tnFdNMNpTcZ2ZMebTjhgwPDdB/sbdWvpdWtodGsqu6wFoFb7h6kY5HGOjvj2ThWfbacNRiF71ELnFzezOcQMjXhwcHpqb+f3WcFBL4KmrGKQRFgQheiVBIc7hC5qGfW+C6nIxCtXthRgjEkzT6aTrjBJUGzztmStxUl5QoegfnF9AthmcvKMDHtbPTtwiztovhJ3UgMLqJycnw1TeW5aZZsrZ2nc00w4ki5ncXOu9/9uGTy13nU/yENmoMU9mdavdNK/mW68Md1Dw2reRZyurggtprsDoNeN1WoqxIe62/Tqn3phSUOqxMdDJV9EH/Kf7I7ZzZednlsDPPsgS+jAjPBSJ4JUJRgl8CScO1qakcGr3YxaUVje729m5Be5W6uCS6uHa2tCh61+TBmbNnuHEkhtQrqJQYWk0JqaQIC/H0BHRokiA6TMK1WJ/uLhP8MNfiXLzX9+dbpr+59GRy6Eo+bYhpBLm73caX/Q1WQ8oOjvfTWxXpICvsWjNT2LWXarCDZzHAMOqZGThX6rMpCaVOM1m7KCrc/RlAtPL/MsI7IoJXKhDBLynef//9qampX838ePXq1X379r3xxhu5ubkKuSuoo6NDWxL8P3/7u9by5d6amuZr16156SUbGxtF75FcWb5mmYmzNopmZeNtpG2+Qd9ADxbCSWCbrUt1k1V66abo7wm0nMom/nKw6It60ajAqp9m0IjXxeqvhqwdsnPI5iEaSHJVr/TV7qAYjAQ7TuXRbnVGX0zzPxzmDC9vnB0cb6OKtjFW9OHOL/ClUIjgF3t7GcJzgQh+ScHhcOAL/NNPP83++uOPP1IolH/84x8rVqz461//6uDgkJCQIOddgpCCNtO5D2GpgtZZCUl5EUYLUvA+utE2tsnozPzxYPcOsl6Vn7ar1oowe1nNWpzBarGNyuxk8310w9Oxnp/vKnpw9fD9/QWXMvDDLJM2ol6x96ZYpw2O6svBRoo+snkEvhTyj7YXe49XhOcFEfxSAER+/vz5lJSUl156KTY29qng8/Pz169fPzExATn97t27ly1b5unp+eDBA3nuG22Rl6pF+K9s3zLAs1ifjFIv9dkEju8k62+mGfZQDFqJejVYnVqCgbfuqlA71UKMlo/eKpG1CpgeMvVBpskr2eT7d05PP/z+yednp0rYOwJMO0h6Fb7aMU4bMLorU6JDFX1k8wh8KeRfVG6xF6VAeF4QwS8FQN6amprr1q37+9///lTwIHU9PT2pVPrU9ygUSkVF5e7du3LbsdnSmIu6jAnCHyFGyOHJ7r1vLPDSqvTTrsZqQ+Je4r0JkvV2soFs/Jidah5ai2G6DjL42fq1/Qzjk9Hun9YIpqf6ft6dfyrSdXimTjtk8FGOapDr0220FX1Y8wh8Nf7yl7/IeXTlYq8bjfC8IIJfUtja2sbHx88a/b333luxYgW4/+HDh7N/lUgk//M//3Pnzp0X2/jk5GTfc1JQUIAU1lASSrNTwd8hdrLSLpDNJ7pshEQcsvZmgi7BaA3PUtbTHh7ppmtTZqZm6SDrb+WYjknsrxcxT4Y7b+eYbKbqN+Jk5e0gCPDTW000XLNUqwvMAl8NOReeQm6nKRuI4JcUzwoerh3Lly9/9dVXn/a5y8vLg6Th5s2bT548eYGNz46xeS7gEoZ06lEeIAR01lxBMJSVdpHYqqa5a0BCn4/WAuvjDGQD4sHxJKM1YXZqs5XbO8n6/XTDYbbJENOoh6LfQpD1oof4gGqyVmStAoJf2vd+5D9SDhG8soEIfknxrOAPHz788ssvT01NPX78ePavdXV1IPh33nnn6ZL5BrmgKBtnJ8bFXlZci/WQrNNM1+INVrtvWumrt8pKbRkskbpuZJqtna1+A5l6NVa7cWYcPGT59TidYu9NkPoHWq4XWKkkumzkO+oq+mjmF/k3wyukWDWCAkEEv6R4VvCnTp2CDP7SpUtPM/iGhgYQ/Oeff/5iGfzzgjTAKyegEAvVZZ7aK7GyeWPX4Q3XoLVXehqra678f0D8EQ5q1movM0zXwpNUN3XQfBFGCxL9THeNBOeNQmsVruV6yOMhAkiWcBV9KPOL/JvhFTLdFIICQQS/pHhW8JCpr1ixYmRk5GkbfHFx8V//+tcXboN/XpCZLZSQ8uJCL92VnJlb9KDwBJeN0Y4bQu1URdayCrWqL/8Dq78apbWCaLQafmWZrRPbqIbaqQXZqPAtVRim68DrVX7a6W4afMv1HS1LvNbNtNyb4XV0dJCAW6lABL+keFbwjx8/1tfXz8rK+vnnn2f/SqFQIGOQWy96pKqGstHU2IAzWB1otR68nu2pme+lVeK9qRCjleOpme6uIatBa7QGtH1o/yjDVhv0D2oXWMlSdtA5rFPppw0/8EJYXpcereijkQdyboZHBK9sIIJfUjwreCAnJ0dLS+utt94C2Z88eXL58uXyvCWINMArFZOTkz5mGpCLS2cGy8kmQSfotZP0Z9vXK3w3geNB6pC4Q846fvo03nA1iDxl5i59sfcm+IEnKSj1EDvVEILb0u4//5R98p39Rf4D8xAUCyL4JcWvBA9PiETiihUrDAwM/ud//icsLOyll16S2zccaYBXKuoriinGa+KcNhRhtOpwul1k/T6awa5Aq0GGUS/VADRfDo530+BarI8TcaZnAoLc+HC6iWwqmjA7yOZV4UmAvU5/R7PySEjOzfDwXvJ5I4QFAvJ5L3GePHly6dKlHTt2XL169dGjR3K7R7eUGuDh+tva1BQvEEbhcIlCYVZKChK4/DuJQQFCKxVI06ux2t00owMhzteLWLd64y9lEI5GoHoo+s14Xcjsw+3V6LbaT18FKey2oYGmyuL68uKzE+NK2AVMbs3w8E8r/9p5CIoFEbxyIbdutEugAR68DvoBtTPRaF9NrVQ7uwoUKsfBMdHahqWvnyyVKnoHFxb+5pog71y0ZgNed4BudCbR+4udxQ+ujv18qOhKNmkbx6yDpCebLM5VnbDUB7g/F3JrhodzDvG9HN4IYeGACF65kNtA2MXeAD8xPh5PIISZmyfb2qbb20dbWgqNTerc3bdh/ft8fEpcXINNTbuUY67YPwIEQ3jjNWH2silnmol6W9imF2uED38Yf/Lo3vRX59+oEe7mW3SS9SG5l7psRAT/LHJrhl9KN9UQ/iCI4JULuQl+UffX3bFlS4yzcyXKrcMLM+jnt8UP24Xxrnf3iLWyGvLDnqDR4LHazY1lYICUDXlKBMk91F41DzJ4nM4Wjtl4nOdXrWHTrw/d319yNt5zG8cUBF/msyneeSPXAckj/z9my0XI4Y3gfxURvLKBCF65gFxBDrNNLOpcAeKSNDe3eg+PXXj8UQp1gsE8w2Aeo9L24gktaHSuo+PVAO5xKm3QD5tqZ5ckEil6fxcKuenJ/JmC8zX+Ol0Ug61skxMRLu9W8s8noHfzzPtoBk0E3UKMVoSDWjDNX9E7u7CAaFgOkSK8BcT38/0uCAsKRPDKRVBQkBzmi4S3gDea73eZJ0oTEstcXXfjCeD165yA9wRC+LnO48OvIwRio4fnLgLxMidglEiqRKGC7OwUvb8LBYjqcAarZyeYacDpdlP0BxmGwyzjLUyjzTSDNpJepa92Kko9wGK9mZ2mEnam+w/IZxZXiOzlOSQPYSGACF65kM+lZFE3wOfjcJ0Y71N0xptC0S1p0o/9Az83Nd/KzXudyxunM/p9fevQXm8IhJDcd2G8g03NEFc9JW8miU9y3VjsrVWH02kh6nWQ9NpJek143Qpf7SwPzRA7VSbZlBLnkZKzuDtgzi3yaYafnSxqvt8FYUGBCH5J8c033+zatWvbMzw7mxxQMMN878ZiaYCHnbx9+3ZJUSmDxLU39kTZ+Qi4Yg91re3+uPMs1g1JyC919dMXL01/9NHt5uabIaEXWOxdOHyFm/vbgYLTdHo3xjvc3GJk0YYy8wHfz5VrIatkBzov8d5U7rup1GdTPloz1U1dYquGtd0Y08IW5ON8ua6K3tMFhHya4ZfAwBaE5wUR/JIC7L5s2bK/PINQKPzxxx+friAHwS/8BviJ8QlfT4KdsYeZprPhRhsrbXejjXbaKqZ6apYuRkQHPV9zNaMqlNvnIaFX0zPiQ2JxnhQnQ08jdTvrjcZEPdM0O/vX+YGQwbd7YWKsbRZFKCM34NO3cNQiGK4RWatEOKjFOm+MctwAiTvfUYcjdi4YCc3YKgqtproxrBW9pwsLOTTDI4JXQhDBLykqKyutra2/+OKLu//i/v37z64gh9bxhdwAD6lSYnSqqxHRw5SGMWfDj48l199GhLEIcDehOhpgwfG2uhgXI4L+BqsAY3M3Q3hO9DRj+FrxvczZbsYUWMdwgw3PyHgfgVju6ir29VX0MS0s4Ax7ce34OVhWrDs7yEnEtE6J4/S01bxy9ejwRyXlx6Mzt4sl5SRyCFrRe7qwkEPbmXzu3iEsKBDBLykiIiJoNNq9e/d+bwU5dLSRT0f9FwDcI2SGg8iJ9qEM51i6Uww8clBJPPc0tmsi3SkaZyMG95toOLqb0kw1ncDlWGsB2SEcVgtAJbNc4qmOkQQ7CQQH5loobx2LdDf3sxMTij6sBQcrHC8swCf18YoPRjS9mnzg/5q/uX9h7P/a4HnJWETqoEBcTIjPilT0bi4s5NAML58OtggLCkTwSwosFhsfHz82Ntbc3Lxt27Zbt279aup3OVxHFmwDfGVZDcacA8Lmu6cHYfKFnlnwGOpTEuFXLvEuEnvlcVDSWX+rrtrkaUrH2Yo5rlLBv1YLxhQI0dk8t1TYgpc5y3KTW0RIiKKPaSFS21RFifWIamRkbReXHY2qO5cIaq8+E1t2LCp3d3BMC5Ma71lWWaro3VxYyKEZHgS/MCNvhPkDEfySwtDQ8OWXX16zZo2FhcX//u//qqurX7x48dlOdiD4PzgWFq44Qc8PRA8LswEeYg4PK5LM7h7pYOto/5pwv/Jo/9p4QmMiqSWe0BCNqwGFQ6aONmNZ63gSbIPB97Akyr86jlCfSGqOxddF+VdJvIt57qmQyrsZk8107ZRnWpTnQpTI4udi49o5mdvFBaOhxWMRhQfCsnYEJXQGBOb5JxfGKHoHFyIQGc/riIxFPbYF4cVABL90+Pnnn11dXaVS6Q8//AC/3rx509raGpY8OwH8H+8BB+rqe37gIrIwG+C3DG1FmzPZrokhPsWx+PqCwOFEcnOJaMe2wte2FrxWEz6aTGmPwlYFeeW7GBHcTWkM59gZu1el0joqQ/d2SE/m87dkMHshDpB4F3Ldkv2sAiEOQCrZ/SYQTjEjcNwsv/BaWnwnR9rLS+gKCK+j8XOwQckcJCr6Tea7GR4RvBKCCH4pMzg4uGzZsnfffffpjfr5nnBiwTbA11TUE+wkfPf0SGxVNqevJmx/TsBAc8yx8b5PPn3l8cTmz6rDRqTkFtC/ra6Xv42Q65YCKX4Gq6cyZGR3yRvvHnhypOFGd8oEpPIQBwR6ZJDsw1yMiI0NjYo+soVLUWWef4gLPRHNSfOhxXvSo3z6tnQjdv895rv5TG5lqhEWDojglzKnTp1avnz5+fPnn96ln++mvgXbAB8RlIC3DRJ75cbgajKZmw/VX8tm95/vvfHd2z89fjj97c17rbHHkyltYb5ljgZYCAUEnlkz6Xvn1vxzkwdufv/lo6/fezCYeTGb0x/tXwOJPqT4rkYkIS9Y0Ue20JmamjxwaP/k5CSi9v+MHL6bSFEmZQMR/NJhYmICgvQPPvjg8ePHs0s6OjpWrFhx8+bNpxn8vF5E4PKxYOejLMopx9mIQdsxuNoczgBk8LkBgy2xx97d9/NnV365MPphU/RRKbkVBO9uQoFQQIjOBpFnsfu6kk58c/bh958+/vH2oz2VU+mMnlhcHQie6hjlakTMSs9V9JEhLB3m1cELNvhGmD8QwS8dbt26paGhQSaTv/rqKzD622+/bWpqyuVyny10A/zlL/P1odfX1y/YYtcjI6M+ljy+e1qEX0UCoTkvYEsSuT2fO9yVNHG8+WZ9+FgarTsWXxfiXeRk4A+hAN89PQJbmURuKxHuHM698t7ok5PdH1VJ9qdQOqL8q4We2VTHCBA80qiJMIfMazM8RPaI4JUNRPBLisOHD6urq7/00kuqqqp/+9vfiETi119//auRcvA9n6ebpQu2AX565tYFyYMPabfYKw9ScympNRZfDyl7CqUznd6TTO6IJzSG+5YHemR4mjHcTChs14QQn5I4fAOIP5s12Bx7FKIBWBlWC/Mt5bqlYq0FZprOyBUTYQ6Z12b4+YvsERYsyEe+1Lh79+7Ro0d37dp17dq1ZwfIPWX+BL/A7wGePXPO15LHdk0M8sqHPD7Mtwxy9FhcHVgclA/ahryc7hw7O8adYCvhe6TDQkjrIRpIoXZANAAxAbxQ6JlDc4ryMKXnZCB1wRDmknltQUMEr4QgH7nSMU/tfLBNOUyY8SepqWjAWHAYzrF893RI1uEREvogTL4IncN1S6E6RkL6bqrp7GaJ87Qmk+xDee5pEu+icN+ySGxluF95iHcxvIruFAMbIfsgw70Q5p55ipLne/gMwsIEEbzSYWNjMx+CX8gN8M8yNDhMRYv8rAIJdhJ/GxHRLoTiEA7PfSx53nYM0HZCdApcDU+fPk31EuNsgiAaAPdDNs9zS2W6xJPsQr0tAoSsiIV8rwJh8TJPzfCI4JUTRPBKxzwNhwW7L6KpLA4dOFxf1RzMiS3MLk8IyyzKLm9pbpuanPrVavlZJa5GRIwF29eK723J9TClQ2bf0tSK5O4I88Q8zRax8Od4RJgPEMErHSD4+ej7vcAb4P8MU1NTw0PbDuw/iAzmRphv5qkZHmL6P1ijGmEpgQhe6ZiPOScWRQM8AsKiYD5iZUTwygkieKVjPhr55DALLQKCkjBP39CFOUkEwryCCF7pmI/LB1w7FlEDPALCQmY+wmVE8MoJInilo2CGud2mjo7Okp/H4vbt20u1kwHCgmI+muEhpofIfm63ibDwQQSvdIDd5/arvrQb4OFqW1pcjvUkOxijzbVc9dQsRbyQ/v5+Re8XwlJmzpvh5/xbj7AoQAS/uLl69eq+ffveeOON3yxa95vM+c26JdwAf/r0aTyG7mpE9DCl+1jysNYCL3MWyphsucndwxWDzM2FME/AN3Ru29HA7kgjmhKCCH6x8uOPP1IolH/84x8rVqz461//Ghwc/KtJZX6POa93vVQb4CGFcrciepoyKA7hDOc4DiqJ657CcomnOUX5WvHs9XxdbTGK3keEpcmcB83zMXYGYeGDCH6xkp+fv379+omJCcjdd+/evWzZsp6engcPHvzXF8654JdkA/zt27e5tCAfSy7NMUrgmRWMKQjzLQ3zLZN4F4rQOUyXeKy10EEfy2EFKHpPEZYgc94MjwheOUEEvygBqevp6Uml0p9++ml2CTjb19f37t27//W1czsiFtLcJdkAPzq639kQT3OKBruH+5XH4GoTiM2JpJY4QkMktlKEzmW5JGDMOYYbbZGedwjzwdw2w8P1AZnaWAlBBL8oee+991asWAGJ+8OHD2eXVFdXq6io3Llz57++9veKVva9EAUFBUuyAb6ustnHksd1S4HEPZHUXBsxsrd8qi/zXF3UAdnEsn7lAs9Mgl2wk4E/khghzAdz2ww/TwWqERY4iOAXJfBdXb58+auvvvq0b93WrVuXLVt28+bNX83+/u/83rQTQS/E/9ve/cZWdd4HHHeACGRsEUTCC/5ILIA6NFbDki2ifzY3S0wzh4SyhpAltE4ixppQG1LWTggFR5vWsZB1HcqCpmiojAYxQ0v6AoQmjNxoFlgTNlpEIKBFsgYFXlgRBkxI7ewZV7Ws69i+9r3X997nfD7KC+canCM5537POb97nhN+VJQD+JdeeGXFg+vC6ftLy3e89tw7//qD9079/Or//uev/+PN/3l1zZ5wHv/t6ldXPbThy19Y8b1XNhd6Y4lQbsfweXrEFEVO4EvSkSNHpk6d2tHR0dvbm3rl4MGDIfBnz57tf2UouR3vhcBHeenvqcfqHn9g3fNfa/zuYz/6m7X7/vvff3X94id9v/7szHu/2v7Czxpq/+mwBdyfAAAPaklEQVTFh//6Tx+q/9IXHt/yg1cLvbFEKOf7qVlSAgl8SWpubg5n8G1tbf1n8Hv37g2Bv3jx4ohn8Dl840j9qCifv/K3296ofeDFb/3R1u8+9o+vrvm3txqaz7/7yflfXv/ZP/zXa8/uq/+TH4f2r/yDl77y20/+5Cd7Cr2xxCnsXLmqssAnk8CXpHCmXllZeejQof4Z/I4dO2bMmJHJDD4oK8vN7z3nH8gvHu8eevfRLz737Ff/6i9qtm96/M1tz/z0rYZje7aceO2Z/a88/s/fqfn70P4VD65b+lvV3jfJkxyO4WM9EGd4Al+Sent758+fv2XLlp6entQrq1atqqmpyeRT9J/lbm+P9Q74z+5cnHj0wdXhHL2uetvLy9/YWPvmXz75L99b8VaI/ctff+OFh1/75rKGP1685s++8WKht5Ro5XAMn6tjekqL33qp2rp169y5c8+cORNif+zYsYqKivB2cPv27Uz+bq4CH+sAPuWXLe89/LtPh5B/u/rVP3/0hy8t3/HS8jfWP/p3z3+tcc2XN399ad1Xv1jr9J38ydU0LfwcgU8mv/VSdfPmzdra2srKygULFkyaNGndunX998SPKCcfqY14AN/v9R/+qHrxU0/+/nee/tIrz/3hlvDPM1/5/jce2rB8ybce/r1VER/cUCRyMoYf6sYZoifwJayvr6+trW3//v2nTp3KfC36z3IU+JC3HC6YU7Q6OjpefLq++neeqql6dvmSteGc/pEHvrnx5e/HfWRDkcjJGD7s7AKfTAKfRDlZ9SIfj50tZr949xd79/w09F7aGTdhF8v+0VBDrW1F9AQ+iXKybmU4SnCNGvIqJ2P43K5OTQkR+CTK/skTSRjAQzHIfgyfkGkagwl8Em3cuDHLwZ63DBgfYUfL8nA8/PXsr/NTigQ+ibIPfGNjY/ghudoeYCjZj+HDzi7wySTwSZT95+MM4GF8tLe3ZzmGD4F3OJ5MAp9EWe7wqXUzDOBhfGQ5hk/aDS/0E/gkynImF87d3XUD4ybLMXz2IzlKlMAnUZYPiTGAh/GU5Rg++7tmKFECn0RZBj4nt9EDGQq7WzZjeDtsYgl8Cbh69WpTU9O+AU6cODGqtWnTZLPwReoOeA9ZgXGT5adeBD6xBL4EhLqXl5eXDbB27dobN26M+Qdms3SlATyMv2zG8DlZmppSJPAlYPv27VVVVZcuXer+jVu3bmXzA7N5upQBPIy/bMbwOXm4FKVI4EvA+vXrV65cef369Vz9wGwWuHa5D8ZfNmP4cDRvppZMAl8Campq6uvrDx8+vHPnzn379nV1dfX19WXzA8ObRVlZ2Y/GxAAexl82Y3iBTyyBLwELFy6cOnXq9OnTFy9ePGXKlFmzZp08eTKbD9m1t7eHN4uNoxdO3w3goSDGPIa3LFViCXyx6+npWbZs2aZNm65duxb+tbOzs6qqKrzS3d2dzY8d27PgDOChUMKuN7YF6ULgc74xlAS/+KLT0tIybdq0iXc0NDTcvHkz7Q/s2bOnvLz83Llz2VyoH9tVOwN4KJSxjeFz8kR5SpTAF51Q9BDvD+64cuXK4Io3NzdXVFS0trZmc5V+DB+sdQc8FNDYxvDZ3DJDqRP4YhdO6Kurqy9cuNDb25t6ZdeuXZWVlZ2dndmcwYfAj/bW2PDnDeChgMaw22az6AWlTuCLXVdX1+zZs1esWHH58uVQ9HBav2jRojVr1mSz0M1nY1r7wkMnobDGMIZ3XJ5kAl8Cjhw5MmvWrMmTJ8+cOXPChAm1tbWfe+l+VMYwTTeAh8Iawxg+m3WpKXUCXxq6u7uPHj3a1NR0+vTpbEbv/erq6kb7BEkDeCisMYzhs3yyFCVN4BNqtI+INsmDYjDaMfzu3buzedQsJU3gE2q0wzwDeCgG9lwyJ/AJ1XhH5n/eAB6KwWgvuQt8kgl8QoXdflQX7gzgoRiMdgw/2kN5YiLwCbV79+7MzwMM4KF4zJs3L/Mx/Bg+Tks0BD6hRnWhz1U+KB6jGsOHwI/tETVEQOATKgQ+87tjDeCheIzq6NzOm2QCn1CjWt/K86SheIzq+TECn2QCn1Dt7e0ZPoLCAB6KTeZj+DEsSk00BD6hwhl5hicBo/28PZBvmS9UFQ4FRvvcSKIh8AmV+VU+l/ig2GQ+hjdfSzKBL5jz5893dHQMXlj+1KlTYe99//33c7Lm/DDKyjL67XuDgGKT+QG6FSySTOALZvXq1Rs3brx582b/Kzdu3HjiiSfuvvvuysrKu+666/nnn8/ymbDDC3v+iMtlGMBDccrw2nuGx/FEye9+vIVmt7a2bt68efLkyRs2bBgY+G3btt17770tLS3h3P3AgQPl5eVvv/32J598kqctySTwBvBQnDIcwwt8kvndj7dQ7jlz5syYMWPixIkDAx+ifv/992/atKn/lZUrVz7yyCPd3d152pJMzgDCNlglA4pQJmP4jz76KMObZYiSwBfM0qVL6+vr+3P+4YcfVlZWhvx/+umnqVdef/31++677+OPP87TBixZsmTEwBvAQ3HKZAwv8Akn8AWTFvjjx49XVFScOHGi/7N177zzTnl5eWdnZ19f35j/K+HHrhxCeHeorq4e6rtB+K4BPBStES/C+QxNwgl8waQF/siRI1OnTu3o6Ojt7U29cvDgwRD4s2fP9r8yBuEQ/udDCHt+Y2PjUN8N6urqRvVgSmA8jTiGD8f3ma9ITXwEPr9aWlqmTZs28Y6GhoaBH6lLC3xzc3M4g29ra+s/g9+7d28I/MWLF7M5gx/GiE+hMICHYjbiGF7gE07g8yv0+9y5cx/cceXKlYGpTgt8OFOvrKw8dOhQ/wx+x44dM2bMyN8MfsTDfwN4KGYjjuHDAbq7YJJM4AsmLfC9vb3z58/fsmVLT09P6pVVq1bV1NTk71P0wwc+88XqgUIZfgwv8Akn8AWTFvhg69atc+fOPXPmTIj9sWPHKioqwv55+/btPG1A4x1DfTe03wAeitzwh+nhW+EPjOf2UFQEvmAGBz58XVtbW1lZuWDBgkmTJq1bt27gd3Mu1H2Ynd8AHorf8GP44fdxoifwxaWvr6+trW3//v2nTp3K91r0w1++M4CH4jf8GD7UfZirdERP4JNrmGP/9vb2DB9lARTWMMfiI94pQ9wEPrmGCXx4UzCAh5IwzBhe4BNO4JNrmHtkQ91d2YOSMMzheHg9HMeP8/ZQPAQ+uYZZxtIAHkrFMGP4cAQv8Ekm8Mk11IMoDOChtAx1RB6O4I8fPz7eW0PREPjkGurA3wAeSstQY3iX4hJO4JNrqMDX1dUZwEMJGeqgXOATTuATrazsc/4HCG8KLutBCRnqYD28GL41/ttDkRD4RBu8/xvAQyn63JP1zz2CJzn8+hNtcOAN4KEU1dXVpY3hw64t8Ann159oS5YsSXsUlQE8lKLBh+ZD3SZDcgh8og0OvAE8lKLBY3hPfEbgE626unpgzsMhvwE8lKi0MfwwK1mREAKfaGkrWQ7/6EmgmKWN4YdZi5qEEPj8On/+fEdHx8AHv169erWpqWnfACdOnMj3k2GHkvYsCgN4KF1pY/hwvC7wCSfw+bV69eqNGzfevHmz/5VQ9/Ly8rIB1q5de+PGjYJsXtoCWPPmzbNyNZSotDF86H04ZC/g9lBwAp8XIditra2bN2+ePHnyhg0bBgZ++/btVVVVly5d6v6NW7duFWo7BwY+9e5gWQwoXWEX7h/Dh11b4BNO4PPiwIEDc+bMmTFjxsSJE9MCv379+pUrV16/fr2Am9ev8Y7U1wbwUOoGjuHDF+EIvrDbQ2EJfH4tXbq0vr5+YOBramrCK4cPH965c+e+ffu6urr6+voKtXkD3wLCFwbwUNLCLtx/mD7w8J1kEvj8Ghz4hQsXTp06dfr06YsXL54yZcqsWbNOnjyZkw/ZhR27epSWLFlyzz33pL4OXxjAQ0kbOIYf6hFzJIfA51da4Ht6epYtW7Zp06Zr166Ff+3s7KyqqgqvdHd3Z//fam9vPz5K4QA/dSt8SLsBPESgfwyfdo8MCSTwOdDS0jJt2rSJdzQ0NAw8Xx98Bp9mz5495eXl586dK8iF+v65uztqIA79Y/iwawt8wgl8DoR+h0J/cMeVK1cGpnrEwDc3N1dUVLS2thbkVvj+pTDCqbzP40AEwr6c+vB82jJWJJDA51da4MO5fgjqhQsXent7U6/s2rWrsrKys7OzIGfw/YtZhq3yXgAR6B/Dpy1ETQIJfH6lBb6rq2v27NkrVqy4fPlyKHo441+0aNGaNWsKtdBN6nlT7oCHmKTG8IMfJUXSCHx+Db5Ef+TIkVmzZk2ePHnmzJkTJkyora1Nu6o/nlJpN4CHmITdeffu3WnPniGBBL4Auru7jx492tTUdPr06UKtQp+SCrwBPMQkNYYXeAQ+6crKygzgISapu17N3RD4pAvvAqHx3gggJqn9utBbQYH5PyDpwhtB6oP0QDRSa1MWeisoMIFPulB3A3iITGNj47x58wq9FRSYwCddXV1dONKfB8TFs2IReP7/bnggMj5Yg8ADQIQEHgAiJPAAECGBB4AICTwAREjgASBCAg8AERJ4AIiQwANAhAQeACIk8AAQIYEHgAgJPABESOABIEICDwAREngAiJDAA0CEBB4AIiTwABAhgQeACAk8AERI4AEgQgIPABESeACIkMADQIQEHgAiJPAAECGBB4AICTwAREjgASBCAg8AERJ4AIiQwANAhAQeACIk8AAQIYEHgAgJPABESOABIEICDwAREngAiJDAA0CEBB4AIiTwABAhgQeACAk8AERI4AEgQgIPABESeACIkMADQIQEHgAiJPAAECGBB4AICTwAREjgASBCAg8AERJ4AIiQwANAhAQeACIk8AAQIYEHgAgJPABESOABIEICDwAREngAiJDAA0CEBB4AIiTwABAhgQeACAk8AERI4AEgQgIPABESeACIkMADQIQEHgAiJPAAECGBB4AICTwAREjgASBCAg8AERJ4AIiQwANAhAQeACIk8AAQIYEHgAgJPABESOABIEICDwAREngAiJDAA0CEBB4AIiTwABAhgQeACAk8AERI4AEgQgIPABESeACIkMADQIQEHgAiJPAAECGBB4AICTwAREjgASBCAg8AERJ4AIiQwANAhAQeACIk8AAQIYEHgAgJPABESOABIEICDwAREngAiJDAA0CEBB4AIiTwABAhgQeACAk8AERI4AEgQgIPABESeACIkMADQIQEHgAiJPAAECGBB4AI/R9zFVHXp+XdLQAAAABJRU5ErkJggg==","width":673,"height":673,"sphereVerts":{"vb":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1],[0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1950903,-0.3826834,-0.5555702,-0.7071068,-0.8314696,-0.9238795,-0.9807853,-1,-0.9807853,-0.9238795,-0.8314696,-0.7071068,-0.5555702,-0.3826834,-0.1950903,-0,-0,-0.18024,-0.3535534,-0.51328,-0.6532815,-0.7681778,-0.8535534,-0.9061274,-0.9238795,-0.9061274,-0.8535534,-0.7681778,-0.6532815,-0.51328,-0.3535534,-0.18024,-0,-0,-0.1379497,-0.2705981,-0.3928475,-0.5,-0.5879378,-0.6532815,-0.6935199,-0.7071068,-0.6935199,-0.6532815,-0.5879378,-0.5,-0.3928475,-0.2705981,-0.1379497,-0,-0,-0.07465783,-0.1464466,-0.2126075,-0.2705981,-0.3181896,-0.3535534,-0.3753303,-0.3826834,-0.3753303,-0.3535534,-0.3181896,-0.2705981,-0.2126075,-0.1464466,-0.07465783,-0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.07465783,0.1464466,0.2126075,0.2705981,0.3181896,0.3535534,0.3753303,0.3826834,0.3753303,0.3535534,0.3181896,0.2705981,0.2126075,0.1464466,0.07465783,0,0,0.1379497,0.2705981,0.3928475,0.5,0.5879378,0.6532815,0.6935199,0.7071068,0.6935199,0.6532815,0.5879378,0.5,0.3928475,0.2705981,0.1379497,0,0,0.18024,0.3535534,0.51328,0.6532815,0.7681778,0.8535534,0.9061274,0.9238795,0.9061274,0.8535534,0.7681778,0.6532815,0.51328,0.3535534,0.18024,0,0,0.1950903,0.3826834,0.5555702,0.7071068,0.8314696,0.9238795,0.9807853,1,0.9807853,0.9238795,0.8314696,0.7071068,0.5555702,0.3826834,0.1950903,0]],"it":[[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270],[17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288],[18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271]],"material":[],"normals":null,"texcoords":[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.0625,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.125,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.1875,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.25,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.3125,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.4375,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.5625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.625,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.6875,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.75,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.8125,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.875,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,0.9375,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],[0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1,0,0.0625,0.125,0.1875,0.25,0.3125,0.375,0.4375,0.5,0.5625,0.625,0.6875,0.75,0.8125,0.875,0.9375,1]],"meshColor":"vertices"},"context":{"shiny":false,"rmarkdown":"rmarkdown::html_vignette"},"crosstalk":{"key":[],"group":[],"id":[],"options":[]}});
plotgroves_3Drgl.prefix = "plotgroves_3D";
</script><p id="plotgroves_3Ddebug">
You must enable Javascript to view this page properly.
</p>
<script>plotgroves_3Drgl.start();</script>
</div>
<div id="treespaceserver-a-web-application-for-treespace" class="section level2">
<h2 class="hasAnchor">
<a href="#treespaceserver-a-web-application-for-treespace" class="anchor"></a><code>treespaceServer</code>: a web application for <em>treespace</em>
</h2>
<p>The functionalities of <code>treespace</code> are also available via a user-friendly web interface, running locally on the default web browser. It can be started by simply typing <code><a href="../reference/treespaceServer.html">treespaceServer()</a></code>. The interface allows you to import trees and run <code>treespace</code> to view and explore the tree space in 2 or 3 dimensions. It is then straightforward to analyse the tree space by varying <span class="math inline">\(\lambda\)</span>, looking for clusters using <code>findGroves</code> and saving results in various formats. Individual trees can be easily viewed, including median trees per cluster (see below). Pairs of trees can be viewed together with their tip-differences highlighted using the function <code>plotTreeDiff</code>, and collections of trees can be seen together using <code>densiTree</code> from the package <em>phangorn</em>. It is fully documented in the <em>help</em> tab.</p>
</div>
<div id="finding-median-trees" class="section level2">
<h2 class="hasAnchor">
<a href="#finding-median-trees" class="anchor"></a>Finding median trees</h2>
<p>When a set of trees have very similar structures, it makes sense to summarize them into a single â€˜consensusâ€™ tree. In <code>treespace</code>, this is achieved by finding the <em>median tree</em> for a set of trees according to the Kendall and Colijn metric. That is, we find the tree which is closest to the centre of the set of trees in the tree landscape defined in <code>treespace</code>. This procedure is implemented by the function <code>medTree</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit">
<span class="co"># get first median tree</span>
<span class="va">tre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medTree.html">medTree</a></span><span class="op">(</span><span class="va">woodmiceTrees</span><span class="op">)</span><span class="op">$</span><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="co"># plot tree</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tre</span>,type<span class="op">=</span><span class="st">"cladogram"</span>,edge.width<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/woodmiceMedian-1.png" width="672"></p>
<p>However, a more complete and accurate summary of the data can be given by finding a summary tree from each cluster. This is achieved using the <code>groups</code> argument of <code>medTree</code>:</p>
<div class="sourceCode" id="cb28"><pre class="downlit">
<span class="co"># find median trees for the 6 clusters identified earlier:</span>
<span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medTree.html">medTree</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>, <span class="va">wm.groves</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span>

<span class="co"># there is one output per cluster</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></pre></div>
<pre><code>## [1] "1" "2" "3" "4" "5" "6"</code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit">
<span class="co"># get the first median of each</span>
<span class="va">med.trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu">ladderize</span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>

<span class="co"># plot trees</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"cluster"</span>,<span class="va">i</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/woodmiceCluster1-1.png" width="600px"></p>
<p>These trees exhibit a number of topological differences, e.g.Â in the placement of the <strong>(1007S,1208S,0909S)</strong> clade. To examine the differences between the trees in a pairwise manner, we can use the function <code>plotTreeDiff</code>, for example:</p>
<div class="sourceCode" id="cb31"><pre class="downlit">
<span class="co"># Compare median trees from clusters 1 and 2:</span>
<span class="fu"><a href="../reference/plotTreeDiff.html">plotTreeDiff</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">med.trees</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, use.edge.length<span class="op">=</span><span class="cn">FALSE</span>, 
             treesFacing <span class="op">=</span> <span class="cn">TRUE</span>, colourMethod <span class="op">=</span> <span class="st">"palette"</span>, palette <span class="op">=</span> <span class="va">funky</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/woodmice_plotTreeDiff-1.png" width="672"></p>
<div class="sourceCode" id="cb32"><pre class="downlit">
<span class="co"># Compare median trees from clusters 1 and 4, and change aesthetics:</span>
<span class="fu"><a href="../reference/plotTreeDiff.html">plotTreeDiff</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">med.trees</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, use.edge.length<span class="op">=</span><span class="cn">FALSE</span>, 
             treesFacing <span class="op">=</span> <span class="cn">TRUE</span>, edge.width<span class="op">=</span><span class="fl">2</span>, colourMethod<span class="op">=</span><span class="st">"palette"</span>, palette<span class="op">=</span><span class="va">spectral</span><span class="op">)</span></pre></div>
<p><img src="introduction_files/figure-html/woodmice_plotTreeDiff-2.png" width="672"></p>
<p>Performing this analysis enables the detection of distinct representative trees supported by data.</p>
<p>Note that in this example we supplied the function <code>medTree</code> with the multiPhylo list of trees. A more computationally efficient process (at the expense of using more memory) is to use the option <code>return.tree.vectors</code> in the initial <code>treespace</code> call, and then supply these vectors directly to <code>medTree</code>. In this case, the tree indices are returned by <code>medTree</code> but the trees are not (since they were not supplied).</p>
</div>
<div id="emphasising-the-placement-of-certain-tips-or-clades" class="section level2">
<h2 class="hasAnchor">
<a href="#emphasising-the-placement-of-certain-tips-or-clades" class="anchor"></a>Emphasising the placement of certain tips or clades</h2>
<p>In some analyses it may be informative to emphasise the placement of particular tips or clades within a set of trees. This can be particularly useful in large trees where the study is focused on a smaller clade. Priority can be given to a list of tips using the argument <code>emphasise.tips</code>, whose corresponding values in the vector comparison will be given a weight of <code>emphasise.weight</code> times the others (the default is 2, i.e.Â twice the weight).</p>
<p>For example, if we wanted to emphasise where the woodmice trees agree and disagree on the placement of the <strong>(1007S,1208S,0909S)</strong> clade, we can simply emphasise that clade as follows:</p>
<div class="sourceCode" id="cb33"><pre class="downlit">
<span class="va">wm3.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">2</span>,emphasise.tips<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"No1007S"</span>,<span class="st">"No1208S"</span>,<span class="st">"No0909S"</span><span class="op">)</span>,emphasise.weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span>

<span class="co"># plot results</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm3.res</span><span class="op">$</span><span class="va">pco</span><span class="op">)</span></pre></div>
<div id="htmlwidget-7bcd558c0caf8662370c" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-7bcd558c0caf8662370c">{"x":{"data":{"x":[-0.594073207581344,-0.520474217124273,-4.29273420692203,-31.0045463450458,-4.43479335528005,8.36252332403474,2.52302297744348,-0.507192211060358,-0.594073207581332,-0.507192211060358,-0.518144836408109,24.5535073746063,-12.6258405735551,-0.480551349713738,8.35119300406132,-0.767202711076171,-0.794647388046402,-4.31673290260613,36.0482473263572,2.3268784850388,8.34249638256188,33.7608531371047,8.61021351082144,-0.612332976228712,-0.731983542203646,12.9714308625021,-36.3316176456048,-0.731983542203646,-30.5407301168131,-30.9935937196981,-0.716542187466501,-4.36866257809523,-4.55843227190198,-31.4273984847072,19.5561987231973,-0.603620504130765,39.5571292486383,-0.289742424318367,-0.784220596013744,8.62822138901471,-0.603147523706446,-4.55990988986583,-4.28178158157426,-4.34533149930737,-0.530511460875731,-4.1471369175182,15.6227358210212,8.40343005787143,8.96791268578615,-0.786172282104231,-36.2820754435815,-4.29273420692201,-8.63758532818177,-0.518144836408109,35.4137402734384,-0.167500914288921,-0.775597351382145,-0.594073207581331,-4.3913468046768,-31.0345126770898,-31.3104572104081,-0.571163815224868,-27.0890118748448,8.56798125384036,2.59559406137029,16.5152817747333,41.2775342138679,-4.06244846227619,-4.56076165261813,-0.516355241782132,-4.33480056039102,-3.83746769406352,-0.594073207581332,37.9152143789498,-0.784293972881595,8.46918827047282,-0.155509655184713,-0.645115072026804,-4.55758050914968,-36.3881015376164,2.1489131793321,-0.613050951321483,-4.12629837765864,-0.619672323581266,-31.6429023868571,-0.594073207581332,12.9714308625021,-8.71101458114734,-0.624003576669234,-0.614573129478515,-0.480551349713738,-4.43046029429519,-0.731983542203646,-31.1944417846473,-0.372547547004299,-10.0930965005012,-0.634992164973024,-4.37099195881138,-0.74879545874732,-0.266781235022075,39.5790704622898,-3.90016322904071,-14.3761734791298,7.7149130299002,29.5850088655751,8.34924131797085,8.47451279404926,2.29694811595089,-0.785320519351925,12.9447997396773,-4.36866257809523,-36.2038176916921,12.8845498659812,8.61254289153758,-7.43265445172999,-4.54662788380193,-0.0716325279184738,-0.594073207581332,-0.603147523706445,-4.13618429217045,-0.361558958700509,-0.636491827395203,-0.592194898358697,8.5113740604498,-0.784293972881594,-4.35770995274748,-0.518144836408109,2.27345654338569,-4.50478331809157,-31.6652587090461,12.967516256608,-36.2152213885334,22.2687400193834,-0.585449962949731,-0.78384290138808,8.64390962501358,-0.594073207581333,-0.747662039680772,-0.58312058223358,8.54088932100023,-0.518144836408109,-3.9065414817612,-0.624003576669234,16.2221659585759,-0.536327371325657,-0.529548533249375,-4.39862891013917,-0.372547547004299,-3.77362549784451,19.3634668242404,-0.624003576669234,15.9254323515291,8.60816054487453,-0.785320519351926,-4.40958153548693,-0.792917217513197,-0.563770027971237,8.35111962719348,-0.58312058223358,-0.522870708537485,-0.533823333885237,-4.5675065880271,8.54134039249374,-0.59983594954683,-8.63275682925797,-4.39156585759196,2.43648573701222,8.34690811737008,-0.786172282104231,-31.5350380598431,8.54134039249374,-0.772890276040329,29.5850088655751,2.33783111038655,-4.26695266256198,-4.42986207476841,-4.36866257809523,21.223829695481,12.9714308625021,16.5152817747332,-4.36866257809523,-0.58544996294973,-8.62180420391022,-0.266817197978116,3.24256321764543,2.29694811595089,-31.2875478180517,-0.522258528810864,12.9823932263716,-0.520474217124261,-0.511106816954525,-0.573493195941021,-4.35770995274748,-0.51814483640811,-0.703270518606352,8.50042143510205,-28.1148433430924,39.5790704622899,16.9396901303175,-4.55758050914968,-4.46179622178293],"y":[-1.72911765565166,-1.41880545767786,7.46976853091071,-9.64971835940001,7.24748083780663,12.786993228693,-26.7577795915697,-1.37152288046733,-1.72911765565166,-1.37152288046733,-1.42132647267178,9.21594919886199,-9.4256252401974,-1.38544839851517,12.3571155847349,0.216748688922747,0.234207859015643,7.53384797280857,-13.5341580762267,-5.61567022544702,12.7386235988224,-12.6714780374248,12.2733478194283,-1.5707409822477,-1.43261115658472,-6.94686176812822,1.84051739066511,-1.43261115658473,-12.4248208095063,-9.59991476719557,1.48570841557827,7.16197734793081,7.88006833010211,-11.060572257318,-19.0273050910954,-1.45423563224369,-11.1294949871588,-0.08943029366876,-1.39110072523403,12.3766934295016,-1.72768369331779,7.49522806223245,7.51957212311513,8.93440235796825,-1.0871902913294,7.82123784134429,-24.5812336577776,12.3156051533842,14.3732746356485,-1.00850565848639,0.987766590385381,7.46976853091069,-16.1694682201147,-1.42132647267178,-4.81698292506776,0.625058325679565,-1.33877611803562,-1.72911765565166,7.44146533562554,-8.69483935971744,-11.8063119162972,-1.707528640786,-16.8494491460317,12.0051731362694,-4.80110337323161,-0.624899871647588,-10.4956481011375,8.48281732685399,7.88258934509607,-1.40129114283317,7.23336995500091,9.44242626503209,-1.72911765565166,-13.289400856053,-0.95726810394808,13.9618195831139,0.0686278026590046,-0.328443033818441,7.49270704723849,2.30810597794257,-5.23513693393488,-0.697344144629337,8.65352608267998,-0.260383048023944,-11.1217229223389,-1.72911765565166,-6.94686176812822,-16.3154109480922,-0.747147736833783,-1.50403922444814,-1.38544839851517,5.56605474099131,-1.43261115658473,-11.7932483980031,-1.06985716223818,-5.51264866125334,-0.824042248173541,7.16449836292476,-0.0159235635684229,-0.298284676593001,-11.0027968836146,9.90076553041406,14.0269588702326,-8.88756732944367,-7.01650971395467,12.7397106514825,13.4804233162466,-4.63370030662914,-1.39586694135001,-7.10253198539991,7.16197734793081,1.29303675837131,-7.30445654331254,12.2708268044343,5.73882016922194,7.54251063944294,0.337872187141206,-1.72911765565166,-1.72768369331779,7.87104143354873,-0.992962650898425,-0.276118426620035,-1.67788010111335,12.9739776539998,-0.957268103948079,7.21178094013525,-1.42132647267178,-5.38431698439451,7.47851917683634,-11.1675715372155,-7.02532024355504,1.29699173569914,-17.7086574753799,-1.67679304845325,-1.01102667348035,12.3129643192493,-1.72911765565166,-1.53847778165197,-1.67931406344721,12.0728572238495,-1.42132647267178,12.9030318431475,-0.747147736833783,-1.58305630373169,-0.955221886665792,-1.41737149534395,8.11685634761337,-1.06985716223818,5.78377185997549,-13.7162382805173,-0.747147736833783,-10.7773272353263,12.7915604609692,-1.39586694135001,8.06705275540892,-1.00959271114648,-1.64791680247765,12.7909482060208,-1.67931406344721,-1.47738950553458,-1.52719309773903,7.88150229243598,12.0190986543172,-1.73170547574518,-16.0101407801063,7.34414334133916,-5.35045944373734,12.3058214933052,-1.00850565848639,-11.2151045183192,12.0190986543172,-0.961223081275907,-7.01650971395468,-5.56586663324257,7.5475950823008,9.15450186893188,7.1619773479308,-13.5787816477448,-6.94686176812822,-0.624899871647573,7.1619773479308,-1.67679304845325,-15.9603371879018,-0.32537559572831,19.8839779384189,-4.63370030662914,-11.7847229014315,-0.0304593223040423,-7.0666539112433,-1.41880545767782,-1.44998135589415,-1.70500762579204,7.21178094013525,-1.42132647267178,-0.943760026490077,12.9241740617954,-13.4549187688844,-11.0027968836146,24.8972253746784,7.49270704723849,8.96487176674167],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-UGWMIZTM","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>It can be seen from the scale of the plot and the density of clustering that the trees are now separated into more distinct clusters.</p>
<div class="sourceCode" id="cb34"><pre class="downlit">
<span class="va">wm3.groves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGroves.html">findGroves</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">3</span>,nclust<span class="op">=</span><span class="fl">6</span>,emphasise.tips<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"No1007S"</span>,<span class="st">"No1208S"</span>,<span class="st">"No0909S"</span><span class="op">)</span>,emphasise.weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm3.groves</span><span class="op">)</span></pre></div>
<div id="htmlwidget-56875cfd0b12ad299417" style="width:672px;height:672px;" class="scatterD3 html-widget"></div>
<script type="application/json" data-for="htmlwidget-56875cfd0b12ad299417">{"x":{"data":{"x":[-0.594073207581344,-0.520474217124273,-4.29273420692203,-31.0045463450458,-4.43479335528005,8.36252332403474,2.52302297744348,-0.507192211060358,-0.594073207581332,-0.507192211060358,-0.518144836408109,24.5535073746063,-12.6258405735551,-0.480551349713738,8.35119300406132,-0.767202711076171,-0.794647388046402,-4.31673290260613,36.0482473263572,2.3268784850388,8.34249638256188,33.7608531371047,8.61021351082144,-0.612332976228712,-0.731983542203646,12.9714308625021,-36.3316176456048,-0.731983542203646,-30.5407301168131,-30.9935937196981,-0.716542187466501,-4.36866257809523,-4.55843227190198,-31.4273984847072,19.5561987231973,-0.603620504130765,39.5571292486383,-0.289742424318367,-0.784220596013744,8.62822138901471,-0.603147523706446,-4.55990988986583,-4.28178158157426,-4.34533149930737,-0.530511460875731,-4.1471369175182,15.6227358210212,8.40343005787143,8.96791268578615,-0.786172282104231,-36.2820754435815,-4.29273420692201,-8.63758532818177,-0.518144836408109,35.4137402734384,-0.167500914288921,-0.775597351382145,-0.594073207581331,-4.3913468046768,-31.0345126770898,-31.3104572104081,-0.571163815224868,-27.0890118748448,8.56798125384036,2.59559406137029,16.5152817747333,41.2775342138679,-4.06244846227619,-4.56076165261813,-0.516355241782132,-4.33480056039102,-3.83746769406352,-0.594073207581332,37.9152143789498,-0.784293972881595,8.46918827047282,-0.155509655184713,-0.645115072026804,-4.55758050914968,-36.3881015376164,2.1489131793321,-0.613050951321483,-4.12629837765864,-0.619672323581266,-31.6429023868571,-0.594073207581332,12.9714308625021,-8.71101458114734,-0.624003576669234,-0.614573129478515,-0.480551349713738,-4.43046029429519,-0.731983542203646,-31.1944417846473,-0.372547547004299,-10.0930965005012,-0.634992164973024,-4.37099195881138,-0.74879545874732,-0.266781235022075,39.5790704622898,-3.90016322904071,-14.3761734791298,7.7149130299002,29.5850088655751,8.34924131797085,8.47451279404926,2.29694811595089,-0.785320519351925,12.9447997396773,-4.36866257809523,-36.2038176916921,12.8845498659812,8.61254289153758,-7.43265445172999,-4.54662788380193,-0.0716325279184738,-0.594073207581332,-0.603147523706445,-4.13618429217045,-0.361558958700509,-0.636491827395203,-0.592194898358697,8.5113740604498,-0.784293972881594,-4.35770995274748,-0.518144836408109,2.27345654338569,-4.50478331809157,-31.6652587090461,12.967516256608,-36.2152213885334,22.2687400193834,-0.585449962949731,-0.78384290138808,8.64390962501358,-0.594073207581333,-0.747662039680772,-0.58312058223358,8.54088932100023,-0.518144836408109,-3.9065414817612,-0.624003576669234,16.2221659585759,-0.536327371325657,-0.529548533249375,-4.39862891013917,-0.372547547004299,-3.77362549784451,19.3634668242404,-0.624003576669234,15.9254323515291,8.60816054487453,-0.785320519351926,-4.40958153548693,-0.792917217513197,-0.563770027971237,8.35111962719348,-0.58312058223358,-0.522870708537485,-0.533823333885237,-4.5675065880271,8.54134039249374,-0.59983594954683,-8.63275682925797,-4.39156585759196,2.43648573701222,8.34690811737008,-0.786172282104231,-31.5350380598431,8.54134039249374,-0.772890276040329,29.5850088655751,2.33783111038655,-4.26695266256198,-4.42986207476841,-4.36866257809523,21.223829695481,12.9714308625021,16.5152817747332,-4.36866257809523,-0.58544996294973,-8.62180420391022,-0.266817197978116,3.24256321764543,2.29694811595089,-31.2875478180517,-0.522258528810864,12.9823932263716,-0.520474217124261,-0.511106816954525,-0.573493195941021,-4.35770995274748,-0.51814483640811,-0.703270518606352,8.50042143510205,-28.1148433430924,39.5790704622899,16.9396901303175,-4.55758050914968,-4.46179622178293],"y":[-1.72911765565166,-1.41880545767786,7.46976853091071,-9.64971835940001,7.24748083780663,12.786993228693,-26.7577795915697,-1.37152288046733,-1.72911765565166,-1.37152288046733,-1.42132647267178,9.21594919886199,-9.4256252401974,-1.38544839851517,12.3571155847349,0.216748688922747,0.234207859015643,7.53384797280857,-13.5341580762267,-5.61567022544702,12.7386235988224,-12.6714780374248,12.2733478194283,-1.5707409822477,-1.43261115658472,-6.94686176812822,1.84051739066511,-1.43261115658473,-12.4248208095063,-9.59991476719557,1.48570841557827,7.16197734793081,7.88006833010211,-11.060572257318,-19.0273050910954,-1.45423563224369,-11.1294949871588,-0.08943029366876,-1.39110072523403,12.3766934295016,-1.72768369331779,7.49522806223245,7.51957212311513,8.93440235796825,-1.0871902913294,7.82123784134429,-24.5812336577776,12.3156051533842,14.3732746356485,-1.00850565848639,0.987766590385381,7.46976853091069,-16.1694682201147,-1.42132647267178,-4.81698292506776,0.625058325679565,-1.33877611803562,-1.72911765565166,7.44146533562554,-8.69483935971744,-11.8063119162972,-1.707528640786,-16.8494491460317,12.0051731362694,-4.80110337323161,-0.624899871647588,-10.4956481011375,8.48281732685399,7.88258934509607,-1.40129114283317,7.23336995500091,9.44242626503209,-1.72911765565166,-13.289400856053,-0.95726810394808,13.9618195831139,0.0686278026590046,-0.328443033818441,7.49270704723849,2.30810597794257,-5.23513693393488,-0.697344144629337,8.65352608267998,-0.260383048023944,-11.1217229223389,-1.72911765565166,-6.94686176812822,-16.3154109480922,-0.747147736833783,-1.50403922444814,-1.38544839851517,5.56605474099131,-1.43261115658473,-11.7932483980031,-1.06985716223818,-5.51264866125334,-0.824042248173541,7.16449836292476,-0.0159235635684229,-0.298284676593001,-11.0027968836146,9.90076553041406,14.0269588702326,-8.88756732944367,-7.01650971395467,12.7397106514825,13.4804233162466,-4.63370030662914,-1.39586694135001,-7.10253198539991,7.16197734793081,1.29303675837131,-7.30445654331254,12.2708268044343,5.73882016922194,7.54251063944294,0.337872187141206,-1.72911765565166,-1.72768369331779,7.87104143354873,-0.992962650898425,-0.276118426620035,-1.67788010111335,12.9739776539998,-0.957268103948079,7.21178094013525,-1.42132647267178,-5.38431698439451,7.47851917683634,-11.1675715372155,-7.02532024355504,1.29699173569914,-17.7086574753799,-1.67679304845325,-1.01102667348035,12.3129643192493,-1.72911765565166,-1.53847778165197,-1.67931406344721,12.0728572238495,-1.42132647267178,12.9030318431475,-0.747147736833783,-1.58305630373169,-0.955221886665792,-1.41737149534395,8.11685634761337,-1.06985716223818,5.78377185997549,-13.7162382805173,-0.747147736833783,-10.7773272353263,12.7915604609692,-1.39586694135001,8.06705275540892,-1.00959271114648,-1.64791680247765,12.7909482060208,-1.67931406344721,-1.47738950553458,-1.52719309773903,7.88150229243598,12.0190986543172,-1.73170547574518,-16.0101407801063,7.34414334133916,-5.35045944373734,12.3058214933052,-1.00850565848639,-11.2151045183192,12.0190986543172,-0.961223081275907,-7.01650971395468,-5.56586663324257,7.5475950823008,9.15450186893188,7.1619773479308,-13.5787816477448,-6.94686176812822,-0.624899871647573,7.1619773479308,-1.67679304845325,-15.9603371879018,-0.32537559572831,19.8839779384189,-4.63370030662914,-11.7847229014315,-0.0304593223040423,-7.0666539112433,-1.41880545767782,-1.44998135589415,-1.70500762579204,7.21178094013525,-1.42132647267178,-0.943760026490077,12.9241740617954,-13.4549187688844,-11.0027968836146,24.8972253746784,7.49270704723849,8.96487176674167],"col_var":["1","1","2","3","2","4","1","1","1","1","1","5","1","1","4","1","1","2","6","1","4","6","4","1","1","5","3","1","3","3","1","2","2","3","5","1","6","1","1","4","1","2","2","2","1","2","5","4","4","1","3","2","1","1","6","1","1","1","2","3","3","1","3","4","1","5","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","5","1","1","1","1","2","1","3","1","1","1","2","1","1","6","2","4","1","6","4","4","1","1","5","2","3","5","4","4","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","5","3","5","1","1","4","1","1","1","4","1","4","1","5","1","1","2","1","2","5","1","5","4","1","2","1","1","4","1","1","1","2","4","1","1","2","1","4","1","3","4","1","6","1","2","2","2","5","5","5","2","1","1","1","4","1","3","1","5","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-GJHTLRGH","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>Conversely, where the structure of a particular clade is not of interest (for example, lineages within an outgroup which was only included for rooting purposes), those tips can be given a weight less than 1 so as to give them less emphasis in the comparison. We note that although it is possible to give tips a weighting of 0, we advise caution with this as the underlying function will no longer be guaranteed to be a metric. That is, a distance of 0 between two trees will no longer necessarily imply that the trees are identical. In most cases it would be wiser to assign a very small weighting to tips which are not of interest.</p>
</div>
<div id="method-characterising-a-tree-by-a-vector" class="section level2">
<h2 class="hasAnchor">
<a href="#method-characterising-a-tree-by-a-vector" class="anchor"></a>Method: characterising a tree by a vector</h2>
<p>Kendall and Colijn proposed a <a href="http://dx.doi.org/10.1093/molbev/msw124">metric</a> for comparing rooted phylogenetic trees (Kendall and COlijn, 2016). Each tree is characterised by a vector which notes the placement of the most recent common ancestor (MRCA) of each pair of tips, as demonstrated in this example:</p>
<p><img src="construction.png" width="2741"></p>
<p>Specifically, it records the distance between the MRCA of a pair of tips <span class="math inline">\((i,j)\)</span> and the root in two ways: the number of edges <span class="math inline">\(m_{i,j}\)</span>, and the path length <span class="math inline">\(M_{i,j}\)</span>. It also records the length <span class="math inline">\(p_i\)</span> of each â€˜pendantâ€™ edge between a tip <span class="math inline">\(i\)</span> and its immediate ancestor. This procedure results in two vectors for a tree <span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[
m(T) = (m_{1,2}, m_{1,3},...,m_{k-1,k},1,...,1)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
M(T) = (M_{1,2}, M_{1,3},...,M_{k-1,k},p_1,...,p_k).
\]</span></p>
<p>In <span class="math inline">\(m(T)\)</span> we record the pendant lengths as 1, as each tip is 1 step from its immediate ancestor. We combine <span class="math inline">\(m\)</span> and <span class="math inline">\(M\)</span> with a parameter <span class="math inline">\(\lambda\)</span> between zero and one to weight the contribution of branch lengths, characterising each tree with a vector</p>
<p><span class="math display">\[
v_\lambda(T) = (1-\lambda)m(T) + \lambda M(T).
\]</span></p>
<p>This is implemented as the function <strong><code>treeVec</code></strong>. For example,</p>
<div class="sourceCode" id="cb35"><pre class="downlit">
<span class="co"># generate a random tree:</span>
<span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="co"># topological vector of mrca distances from root:</span>
<span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></pre></div>
<pre><code>##  [1] 2 2 0 1 3 3 0 1 2 0 1 2 0 0 1 1 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit">
<span class="co"># vector of mrca distances from root when lambda=0.5:</span>
<span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span>,<span class="fl">0.5</span><span class="op">)</span></pre></div>
<pre><code>##  [1] 1.2173 1.2173 0.0000 0.6927 2.2131 1.8866 0.0000 0.6927 1.2173 0.0000
## [11] 0.6927 1.2173 0.0000 0.0000 0.6927 0.5232 0.7638 0.6800 0.8382 0.6090
## [21] 0.5360</code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit">
<span class="co"># vector of mrca distances as a function of lambda:</span>
<span class="va">vecAsFunction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span>,return.lambda.function<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># evaluate the vector at lambda=0.5:</span>
<span class="fu">vecAsFunction</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></pre></div>
<pre><code>##  [1] 1.2173 1.2173 0.0000 0.6927 2.2131 1.8866 0.0000 0.6927 1.2173 0.0000
## [11] 0.6927 1.2173 0.0000 0.0000 0.6927 0.5232 0.7638 0.6800 0.8382 0.6090
## [21] 0.5360</code></pre>
<p>The metric â€“ the distance between two trees â€“ is the Euclidean distance between these vectors:</p>
<p><span class="math display">\[
d_\lambda(T_a, T_b) = || v_\lambda(T_a) - v_\lambda(T_b) ||.
\]</span></p>
<p>This can be found using <strong><code>treeDist</code></strong>:</p>
<div class="sourceCode" id="cb41"><pre class="downlit">
<span class="co"># generate random trees</span>
<span class="va">tree_a</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>
<span class="va">tree_b</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fl">6</span><span class="op">)</span>

<span class="co"># topological (lambda=0) distance:</span>
<span class="fu"><a href="../reference/treeDist.html">treeDist</a></span><span class="op">(</span><span class="va">tree_a</span>,<span class="va">tree_b</span><span class="op">)</span> </pre></div>
<pre><code>## [1] 4.123</code></pre>
<div class="sourceCode" id="cb43"><pre class="downlit">
<span class="co"># branch-length focused (lambda=1) distance:</span>
<span class="fu"><a href="../reference/treeDist.html">treeDist</a></span><span class="op">(</span><span class="va">tree_a</span>,<span class="va">tree_b</span>,<span class="fl">1</span><span class="op">)</span></pre></div>
<pre><code>## [1] 2.873</code></pre>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<ul>
<li><p>Dray, S. and Dufour, A. B. (2007) The ade4 package: implementing the duality diagram for ecologists. Journal of Statistical Software 22(4): 1-20.</p></li>
<li><p>Drummond, A. J. and Rambaut, A. (2007) BEAST: Bayesian evolutionary analysis by sampling trees. BMC Evolutionary Biology, 7(1), 214.</p></li>
<li><p>Jombart, T., Balloux, F. and Dray, S. (2010) adephylo: new tools for investigating the phylogenetic signal in biological traits. Bioinformatics 26: 1907-1909. DOI: 10.1093/bioinformatics/btq292</p></li>
<li><p>Kendall, M. and Colijn, C. (2016) Mapping phylogenetic trees to reveal distinct patterns of evolution. Molecular Biology and Evolution, first published online: June 24, 2016. DOI: 10.1093/molbev/msw124</p></li>
<li><p>Lanciotti, R. S., Gubler, D. J. and Trent, D. W. (1997) Molecular evolution and phylogeny of dengue-4 viruses. Journal of General Virology, 78(9), 2279-2286.</p></li>
<li><p>Schliep, K. P. (2011) phangorn: phylogenetic analysis in R. Bioinformatics 27(4): 592-593.</p></li>
</ul>
</div>
<div id="authors-contributors" class="section level2">
<h2 class="hasAnchor">
<a href="#authors-contributors" class="anchor"></a>Authors / Contributors</h2>
<p>Authors:</p>
<ul>
<li><p><a href="https://sites.google.com/site/thibautjombart/">Thibaut Jombart</a></p></li>
<li><p><a href="https://michellekendall.github.io/">Michelle Kendall</a></p></li>
</ul>
<p>Contributors:</p>
<ul>
<li><p><a href="http://www.well.ox.ac.uk/jacob-almagro-garcia">Jacob Almagro-Garcia</a></p></li>
<li><p><a href="http://www.imperial.ac.uk/people/c.colijn">Caroline Colijn</a></p></li>
</ul>
<p>Maintainer of the CRAN version:</p>
<ul>
<li><a href="https://michellekendall.github.io/">Michelle Kendall</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thibaut Jombart, Michelle Kendall, Jacob Almagro-Garcia, Caroline Colijn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
