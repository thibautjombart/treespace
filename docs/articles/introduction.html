<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exploration of landscapes of phylogenetic trees • treespace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Exploration of landscapes of phylogenetic trees">
<meta property="og:description" content="treespace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treespace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.4.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DengueVignette.html">treespace worked example: Dengue trees</a>
    </li>
    <li>
      <a href="../articles/TransmissionTreesVignette.html">treespace worked example: Transmission trees</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Exploration of landscapes of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/tipCategories.html">Comparing trees by tip label categories</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thibautjombart/treespace/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="introduction_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="introduction_files/scatterD3-binding-1.0.1/scatterD3.js"></script><script src="introduction_files/rglWebGL-binding-1.1.3/rglWebGL.js"></script><link href="introduction_files/rglwidgetClass-1.1.3/rgl.css" rel="stylesheet">
<script src="introduction_files/rglwidgetClass-1.1.3/rglClass.min.js"></script><script src="introduction_files/CanvasMatrix4-1.1.3/CanvasMatrix.min.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Exploration of landscapes of phylogenetic
trees</h1>
                        <h4 data-toc-skip class="author">Thibaut
Jombart, Michelle Kendall</h4>
            
            <h4 data-toc-skip class="date">2023-04-03</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thibautjombart/treespace/blob/HEAD/vignettes/introduction.Rmd" class="external-link"><code>vignettes/introduction.Rmd</code></a></small>
      <div class="hidden name"><code>introduction.Rmd</code></div>

    </div>

    
    
<p><em>treespace</em> implements new methods for the exploration and
analysis of distributions of phylogenetic trees for a given set of
taxa.</p>
<div class="section level2">
<h2 id="installing-treespace">Installing <em>treespace</em><a class="anchor" aria-label="anchor" href="#installing-treespace"></a>
</h2>
<p>To install the development version from github:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"thibautjombart/treespace"</span><span class="op">)</span></span></code></pre></div>
<p>The stable version can be installed from CRAN using:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"treespace"</span><span class="op">)</span></span></code></pre></div>
<p>Then, to load the package, use:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=treespace" class="external-link">"treespace"</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ape</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: ade4</span></span></code></pre>
<pre><code><span><span class="co">## Registered S3 methods overwritten by 'adegraphics':</span></span>
<span><span class="co">##   method         from</span></span>
<span><span class="co">##   biplot.dudi    ade4</span></span>
<span><span class="co">##   kplot.foucart  ade4</span></span>
<span><span class="co">##   kplot.mcoa     ade4</span></span>
<span><span class="co">##   kplot.mfa      ade4</span></span>
<span><span class="co">##   kplot.pta      ade4</span></span>
<span><span class="co">##   kplot.sepan    ade4</span></span>
<span><span class="co">##   kplot.statis   ade4</span></span>
<span><span class="co">##   scatter.coa    ade4</span></span>
<span><span class="co">##   scatter.dudi   ade4</span></span>
<span><span class="co">##   scatter.nipals ade4</span></span>
<span><span class="co">##   scatter.pco    ade4</span></span>
<span><span class="co">##   score.acm      ade4</span></span>
<span><span class="co">##   score.mix      ade4</span></span>
<span><span class="co">##   score.pca      ade4</span></span>
<span><span class="co">##   screeplot.dudi ade4</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="content-overview">Content overview<a class="anchor" aria-label="anchor" href="#content-overview"></a>
</h2>
<p>The main functions implemented in <em>treespace</em> are:</p>
<ul>
<li><p><strong><code>treespace</code></strong>: explore landscapes of
phylogenetic trees</p></li>
<li><p><strong><code>treespaceServer</code></strong>: open up an
application in a web browser for an interactive exploration of the
diversity in a set of trees</p></li>
<li><p><strong><code>findGroves</code></strong>: identify clusters of
similar trees</p></li>
<li><p><strong><code>plotGroves</code></strong>: scatterplot of groups
of trees, and <strong><code>plotGrovesD3</code></strong> which enables
interactive plotting based on d3.js</p></li>
<li><p><strong><code>medTree</code></strong>: find geometric median
tree(s) to summarise a group of trees</p></li>
</ul>
<p>Other functions are central to the computations of distances between
trees:</p>
<ul>
<li><p><strong><code>treeVec</code></strong>: characterise a tree by a
vector</p></li>
<li><p><strong><code>treeDist</code></strong>: find the distance between
two tree vectors</p></li>
<li><p><strong><code>multiDist</code></strong>: find the pairwise
distances of a list of trees</p></li>
<li><p><strong><code>refTreeDist</code></strong>: find the distances of
a list of trees from a reference tree</p></li>
<li><p><strong><code>tipDiff</code></strong>: for a pair of trees, list
the tips with differing ancestry</p></li>
<li><p><strong><code>plotTreeDiff</code></strong>: plot a pair of trees,
highlighting the tips with differing ancestry</p></li>
</ul>
<p>Distributed datasets include:</p>
<ul>
<li><p><strong><code>woodmiceTrees</code></strong>: illustrative set of
201 trees built using the neighbour-joining and bootstrapping example
from the woodmice dataset in the ape documentation.</p></li>
<li><p><strong><code>DengueTrees</code></strong>: 500 trees sampled from
a BEAST posterior set of trees from (Drummond and Rambaut,
2007)</p></li>
<li><p><strong><code>DengueSeqs</code></strong>: 17 dengue virus
serotype 4 sequences from (Lanciotti <em>et al</em>., 1997), from which
the <code>DengueTrees</code> were inferred.</p></li>
<li><p><strong><code>DengueBEASTMCC</code></strong>: the maximum clade
credibility (MCC) tree from the <code>DengueTrees</code>.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="exploring-trees-with-treespace">Exploring trees with <em>treespace</em><a class="anchor" aria-label="anchor" href="#exploring-trees-with-treespace"></a>
</h2>
<p>We first load <em>treespace</em>, and the packages required for
graphics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://cran.r-project.org/package=treespace" class="external-link">"treespace"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/thibautjombart/adegenet" class="external-link">"adegenet"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="http://pbil.univ-lyon1.fr/ADE-4/" class="external-link">"adegraphics"</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st"><a href="https://github.com/dmurdoch/rgl" class="external-link">"rgl"</a></span><span class="op">)</span></span></code></pre></div>
<p>The function <code>treespace</code> defines typologies of
phylogenetic trees using a two-step approach:</p>
<ol style="list-style-type: decimal">
<li><p>perform pairwise comparisons of trees using various (Euclidean)
metrics; by default, the comparison uses the Kendall and Colijn metric
(Kendall and Colijn, 2016) which is described in more detail below;
other metrics rely on tip distances implemented in <em>adephylo</em>
(Jombart <em>et al.</em>, 2010) and <em>phangorn</em> (Schliep
2011).</p></li>
<li><p>use Metric Multidimensional Scaling (MDS, aka Principal
Coordinates Analysis, PCoA) to summarise pairwise distances between the
trees as well as possible into a few dimensions; the output of the MDS
is typically visualised using scatterplots of the first few Principal
Components (PCs); this step relies on the PCoA implemented in
<em>ade4</em> (Dray and Dufour, 2007).</p></li>
</ol>
<p>The function <code>treespace</code> performs both tasks, returning
both the matrix of pairwise tree comparisons (<code>$D</code>), and the
PCoA (<code>$pco</code>). This can be illustrated using randomly
generated trees:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate list of trees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rmtree</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">20</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tree"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># use treespace</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">x</span>, nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "D"   "pco"</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span></span></code></pre></div>
<pre><code><span><span class="co">## $D</span></span>
<span><span class="co">##        tree1 tree2 tree3 tree4 tree5 tree6 tree7 tree8 tree9</span></span>
<span><span class="co">## tree2  26.00                                                </span></span>
<span><span class="co">## tree3  31.06 26.74                                          </span></span>
<span><span class="co">## tree4  42.85 42.12 44.44                                    </span></span>
<span><span class="co">## tree5  30.66 27.71 27.37 44.79                              </span></span>
<span><span class="co">## tree6  36.50 31.18 30.18 41.81 31.59                        </span></span>
<span><span class="co">## tree7  34.64 28.71 29.48 40.35 31.11 32.37                  </span></span>
<span><span class="co">## tree8  28.97 26.29 24.45 43.74 23.47 30.41 29.00            </span></span>
<span><span class="co">## tree9  29.63 27.42 27.48 45.61 26.31 30.89 29.77 24.60      </span></span>
<span><span class="co">## tree10 34.87 30.00 29.44 44.97 34.06 31.05 34.41 31.54 32.59</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $pco</span></span>
<span><span class="co">## Duality diagramm</span></span>
<span><span class="co">## class: pco dudi</span></span>
<span><span class="co">## $call: dudi.pco(d = D, scannf = is.null(nf), nf = nf)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $nf: 3 axis-components saved</span></span>
<span><span class="co">## $rank: 9</span></span>
<span><span class="co">## eigen values: 142.1 76.52 62.69 49.88 41.07 ...</span></span>
<span><span class="co">##   vector length mode    content       </span></span>
<span><span class="co">## 1 $cw    9      numeric column weights</span></span>
<span><span class="co">## 2 $lw    10     numeric row weights   </span></span>
<span><span class="co">## 3 $eig   9      numeric eigen values  </span></span>
<span><span class="co">## </span></span>
<span><span class="co">##   data.frame nrow ncol content             </span></span>
<span><span class="co">## 1 $tab       10   9    modified array      </span></span>
<span><span class="co">## 2 $li        10   3    row coordinates     </span></span>
<span><span class="co">## 3 $l1        10   3    row normed scores   </span></span>
<span><span class="co">## 4 $co        9    3    column coordinates  </span></span>
<span><span class="co">## 5 $c1        9    3    column normed scores</span></span>
<span><span class="co">## other elements: NULL</span></span></code></pre>
<p>Pairwise tree distances can be visualised using
<em>adegraphics</em>:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># table.image</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.image.html" class="external-link">table.image</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">D</span>, nclass<span class="op">=</span><span class="fl">30</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/distances-1.png" width="672"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># table.value with some customization</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/table.value.html" class="external-link">table.value</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">D</span>, nclass<span class="op">=</span><span class="fl">5</span>, method<span class="op">=</span><span class="st">"color"</span>, </span>
<span>            symbol<span class="op">=</span><span class="st">"circle"</span>, col<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/auxil.html" class="external-link">redpal</a></span><span class="op">(</span><span class="fl">5</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/distances-2.png" width="672"></p>
<p>The best representation of these distances in a 2-dimensional space
is given by the first 2 PCs of the MDS. These can be visualised using
any scatter plotting tool; here we use the <em>treespace</em> function
<code>plotGroves</code>, based on the <em>adegraphics</em> function
<code>scatter</code>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGroves.html">plotGroves</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pco</span>, lab.show<span class="op">=</span><span class="cn">TRUE</span>, lab.cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/plotgroves-1.png" width="672"></p>
<p>Alternatively, <code>plotGrovesD3</code> creates interactive plots
based on d3.js:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">res</span><span class="op">$</span><span class="va">pco</span>, treeNames<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-9c0ebce7b393905d8ee5" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-9c0ebce7b393905d8ee5">{"x":{"data":{"x":[2.13035259412571,3.31143165077361,6.68261423648124,-34.2627208913964,7.25843567957564,-1.08828681782319,-2.41764971191633,6.88799030499781,8.36065794480431,3.13717501037757],"y":[-15.1746612118386,-4.3359528090973,2.8576050061263,-2.52929101464511,-5.13714617827929,14.9963546470384,0.889403081968251,-3.36078022712547,-3.2861444217133,15.0806131275662],"lab":[1,2,3,4,5,6,7,8,9,10],"key_var":[1,2,3,4,5,6,7,8,9,10]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":true,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-WKQKITSX","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>Tree labels can be dragged into new positions to avoid problems such
as overlapping.</p>
<p>The functionality of <code>treespace</code> can be further
illustrated using <em>ape</em>’s dataset <em>woodmouse</em>, from which
we built the 201 trees supplied in <code>woodmiceTrees</code> using the
neighbour-joining and bootstrapping example from the <em>ape</em>
documentation.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">woodmiceTrees</span><span class="op">)</span></span>
<span><span class="va">wm.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># PCs are stored in:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">wm.res</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         A1     A2      A3</span></span>
<span><span class="co">## 1  -0.9949 -1.363 -0.7918</span></span>
<span><span class="co">## 2  -0.6137 -1.014 -0.6798</span></span>
<span><span class="co">## 3   2.6667  4.219 -2.9293</span></span>
<span><span class="co">## 4 -13.6081  1.854  1.0947</span></span>
<span><span class="co">## 5   2.1980  4.176 -3.1960</span></span>
<span><span class="co">## 6   3.6013  4.865  2.9853</span></span></code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot results</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.res</span><span class="op">$</span><span class="va">pco</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-45d3ade64b62e7c78a9d" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-45d3ade64b62e7c78a9d">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-PBTXSPOJ","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>Packages such as <em>adegraphics</em> and <em>ggplot2</em> can be
used to make alternative plots, for example visualising the density of
points within the space.</p>
<p>The <em>treespace</em> function <code>multiDist</code> simply
performs the pairwise comparison of trees and outputs a distance matrix.
This function may be preferable for large datasets, and when principal
co-ordinate analysis is not required. It includes an option to save
memory at the expense of computation time.</p>
</div>
<div class="section level2">
<h2 id="identifying-clusters-of-trees">Identifying clusters of trees<a class="anchor" aria-label="anchor" href="#identifying-clusters-of-trees"></a>
</h2>
<p>Once a typology of trees has been derived using the approach
described above, one may want to formally identify clusters of similar
trees. One simple approach is:</p>
<ol style="list-style-type: decimal">
<li><p>select a few first PCs of the MDS (retaining signal but getting
rid of random noise)</p></li>
<li><p>derive pairwise Euclidean distances between trees based on these
PCs</p></li>
<li><p>use hierarchical clustering to obtain a dendrogram of these
trees</p></li>
<li><p>cut the dendrogram to obtain clusters</p></li>
</ol>
<p>In <em>treespace</em>, the function <code>findGroves</code>
implements this approach, offering various clustering options (see
<code><a href="../reference/findGroves.html">?findGroves</a></code>). Here we supply the function with our
<code>treespace</code> output <code>wm.res</code> since we have already
calculated it, but it is also possible to skip the steps above and
directly supply <code>findGroves</code> with a multiPhylo list of
trees.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wm.groves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGroves.html">findGroves</a></span><span class="op">(</span><span class="va">wm.res</span>, nclust<span class="op">=</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "groups"    "treespace"</span></span></code></pre>
<p>Note that when the number of clusters (<code>nclust</code>) is not
provided, the function will display a dendrogram and ask for a cut-off
height.</p>
<p>The results can be plotted directly using <code>plotGrovesD3</code>
(see <code><a href="../reference/plotGrovesD3.html">?plotGrovesD3</a></code> for options):</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># basic plot</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-ec4d5cf56b90cc7adfb3" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-ec4d5cf56b90cc7adfb3">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-OXHVRXHK","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># alternative with improved legend and tooltip text, giving the tree numbers:</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span>, tooltip_text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Tree "</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">201</span><span class="op">)</span>, legend_width<span class="op">=</span><span class="fl">50</span>, col_lab<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-20a6cc3ddd7a54fec278" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-20a6cc3ddd7a54fec278">{"x":{"data":{"x":[-0.994915614079129,-0.613678626917784,2.6667063130703,-13.6081153840016,2.19796507262781,3.60128203945996,-7.93464330242989,-0.601509902833136,-0.994915614079123,-0.601509902833136,-0.607150138418815,10.3943189332891,-8.22061660863031,-0.542706411478826,3.33541847941513,-0.043828098018826,-0.164629339023312,2.79080622437025,10.5466992537476,-0.611741178555835,3.57629422667165,9.6450605977335,3.87015775914438,-0.926024164827251,-1.2190898967413,2.4723857807866,-8.86243680646928,-1.21908989674129,-14.5730155701834,-13.602475148416,0.917863183050823,2.27894083741,2.28568544942178,-15.7748658745841,2.1492025394282,-0.790924629423665,12.7908135541976,0.944271832856846,-1.24839432652649,3.98230290310848,-1.01426319128175,2.01968513715778,2.67234654865598,3.60013557723756,-0.360155109563769,3.37184987522406,0.252595301625625,3.36472290920032,6.40461224612179,-0.994699490566318,-9.42122752144957,2.66670631307031,-9.45007781913339,-0.607150138418815,13.1790840072057,1.82079944018017,-1.24928257943979,-0.994915614079122,2.43713839500106,-13.044572686349,-15.9705489873276,-0.913373605366738,-13.6310955663375,3.64770068321681,0.668865915945599,8.14682718932421,13.4934309468058,4.04346690730909,2.2791569609228,-0.580632735597668,2.36612308170806,5.33313046919023,-0.994915614079123,11.0665629950681,-1.00840683218326,4.76538085706121,1.4438114263851,-0.171393662122702,2.02621362565675,-8.75385363504267,-0.858828154723405,-0.330268540830038,3.90067192022295,-0.0730717036886937,-16.5286674300406,-0.994915614079122,2.4723857807866,-9.65081856527717,-0.335908776415717,-0.796564865009345,-0.542706411478826,1.0492923610008,-1.21908989674129,-15.6745883154345,0.0979934237349428,-9.34792446440201,-0.437013152012128,2.27241234891102,-0.17689227089257,0.955121246501657,12.8975581653797,5.51089790555852,-10.4680320213257,-0.0399993481969869,9.52808714143766,3.5891133153753,4.42342442747862,0.04726565910757,-1.25417131433135,2.3611288897358,2.27894083741,-9.02693355729029,2.07898006954062,3.87668624764336,-6.4615827644661,2.03185386124243,1.82035414418588,-0.994915614079123,-1.01426319128175,3.37749011080974,0.199097799331354,-0.172281915035997,-1.00862295569607,4.15243988951517,-1.00840683218326,2.28458107299568,-0.607150138418815,-0.519052641259981,2.08128395756897,-16.5601837313279,2.46688265557635,-9.05280962299188,3.48076661737389,-0.995803866992419,-0.988171002067342,4.03546615887711,-0.994915614079123,-1.32470655220642,-0.989275378493443,3.56866136174658,-0.607150138418815,-7.66836564572728,-0.335908776415717,6.72470221778202,-0.27737989822945,-0.633026204120414,2.84248353506267,0.0979934237349427,2.92888779742133,3.20320883731573,-0.335908776415717,2.87234652407254,4.32578048491479,-1.25417131433135,2.83684329947699,-1.00751857926997,-0.915013358974152,3.57540597375836,-0.989275378493444,-0.707126558298265,-0.712766793883944,2.26633787221915,3.5888971918625,-1.01180587891182,-9.25652460111788,2.33076992578286,-0.165035101165791,3.30290284183795,-0.994699490566318,-16.2186567440298,3.5888971918625,-0.982530766481663,9.52808714143766,-0.606100942970156,2.73656237720091,3.46106473819439,2.27894083741,3.63680350037365,2.4723857807866,8.14682718932421,2.27894083741,-0.995803866992419,-9.25088436553221,0.859657106490925,0.774749830581254,0.04726565910757,-15.8890069786153,0.404970591334759,2.42557261667579,-0.613678626917791,-0.607013028043388,-0.919902093865714,2.28458107299568,-0.607150138418815,-0.765676710838193,4.14679965392949,-13.1809002016393,12.8975581653797,4.26288720150493,2.02621362565675,3.36367420397476],"y":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"Cluster","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"],"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":true,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":50,"left_margin":30,"html_id":"scatterD3-XUOQYHJY","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot axes 2 and 3. This helps to show why, for example, clusters 2 and 4 have been identified as separate, despite them appearing to overlap when viewing axes 1 and 2.</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm.groves</span>, xax<span class="op">=</span><span class="fl">2</span>, yax<span class="op">=</span><span class="fl">3</span>, tooltip_text<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Tree "</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">201</span><span class="op">)</span>, legend_width<span class="op">=</span><span class="fl">50</span>, col_lab<span class="op">=</span><span class="st">"Cluster"</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-41624cc46ea73e4bee23" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-41624cc46ea73e4bee23">{"x":{"data":{"x":[-1.36296405257431,-1.0143380748759,4.21882824322934,1.85395115102287,4.17637909087138,4.86461034763142,-16.009575686826,-1.02771387775047,-1.36296405257431,-1.02771387775047,-1.02766987185401,-0.50552388611458,-10.0515267421666,-1.07229905286387,4.15752547173998,2.76392139550187,2.59796872098458,4.93883384448699,-10.7625404554933,-2.21247979854658,4.87226502578944,-9.5088708745062,3.32153776588015,-0.842513536381463,-0.716141175163109,-7.16104731132083,5.75437287564331,-0.716141175163109,-1.7069313395939,1.85390714512642,4.8987315359459,3.88353406250903,5.61969323330277,0.344365695407378,-14.4171273048538,-0.501442487250261,-9.6000449103967,1.03726886777004,-0.33393376356846,3.46374535755798,-1.35535338031275,4.91950411344246,4.21878423733287,7.13159940553585,-0.00302341316305915,5.01212399682195,-13.0610240652768,3.77531806014533,7.01232473326826,0.386526915197534,3.75962479695718,4.21882824322933,-11.8666109777134,-1.02766987185401,-8.32290371040569,2.52086549795982,-0.320645972486814,-1.36296405257431,4.62733018857611,3.8619430148942,-1.58401124473219,-1.37092740080123,-1.87858215341395,3.08391000762073,-1.19130284875386,-0.939160305549965,-9.99053252948651,5.96476384086601,5.63302503028087,-1.03141128116272,3.87552670838565,7.5655093012157,-1.36296405257431,-11.1843323318248,0.394093581562641,6.98752111471012,1.37775884921857,1.22975877872164,4.90617231646436,6.55363566239471,-1.1898855504877,0.868592373260222,6.09901634763347,1.2290930557728,0.146376109093674,-1.36296405257431,-7.16104731132083,-11.8099177019773,0.868636379156678,-0.501398481353804,-1.07229905286387,1.43585335420713,-0.716141175163109,-1.76388587914128,-0.23437411826138,-3.78957669060228,0.645071817193465,3.89686585948713,2.27313496228741,1.1554629700066,-9.37652435432995,8.34207063093772,4.70275523659972,-5.51421132484612,-8.2299588005646,4.87798615050598,6.18643823118439,0.0191206331844139,-0.326994001640874,-7.3165426940803,3.88353406250902,4.08158718069937,-7.49629748614467,3.30820596890205,1.9385779426291,4.9061283105679,1.76288229528141,-1.36296405257431,-1.35535338031275,5.0120799909255,-0.0108095562981677,1.24304656980329,-1.3553973862092,5.13648704660545,0.394093581562642,3.88349005661257,-1.02766987185401,-1.36622147874601,4.52661553061152,0.167362584229802,-7.16806857752342,4.10252964993904,-10.8783948870456,-1.34967626149266,0.373195118219431,3.41920418834103,-1.36296405257431,-0.871680563819035,-1.36300805847077,3.14939364607734,-1.02766987185401,-1.0051396096495,0.868636379156678,-2.10228430818339,0.0359583960557165,-1.00672740261434,5.89152592638034,-0.23437411826138,0.461240469186375,-9.87333975241742,0.868636379156678,-8.00759724325873,4.51980695910259,-0.326994001640875,5.8915699322768,0.380805790480995,-1.35124757466906,4.88555281687109,-1.36300805847077,-1.18325326640639,-1.18320926050994,5.62730390556433,3.12849518273413,-1.36839184423488,-11.4879553182351,4.29529384801837,-1.92883606503872,4.00946413995936,0.386526915197535,-0.0288756124843536,3.12849518273413,0.373151112322974,-8.2299588005646,-2.21252380444303,4.19946765707951,7.74251598858856,3.88353406250902,-10.4582816896664,-7.16104731132083,-0.939160305549963,3.88353406250902,-1.34967626149266,-11.4879993241316,0.931854402146931,10.0778445455006,0.0191206331844133,-1.59197459295911,1.73932530176124,-7.36117187509016,-1.01433807487591,-1.03473514395306,-1.35759560382312,3.88349005661257,-1.02766987185401,0.202085100647231,5.13653105250191,1.52547532730244,-9.37652435432995,8.19604761262773,4.90617231646436,7.45847251006686],"y":[-0.791807120249666,-0.679832427223742,-2.92925942555435,1.09465428278252,-3.19598990128449,2.98532664792082,-0.00778405606618283,-0.7772226997152,-0.79180712024967,-0.777222699715199,-0.760072357367479,3.3038947003599,-3.40748488325369,-0.69781326696592,2.40355762496095,0.865577600628614,0.136458887783133,-2.09231261460812,0.819616564951839,-0.215862843943144,2.95932040786593,1.6471221906073,2.05426452985354,-0.108448694706785,-0.763403010869589,-0.761464865832367,-4.61368594406494,-0.763403010869588,-1.2995156179144,1.0775039404348,1.35907283698071,-2.96099418843654,-2.1620882075821,3.90255872054314,0.378657883293157,0.103872863482392,2.13706456182689,-0.686396318956685,-0.59182050470279,2.21815542994855,-0.834963702652257,-2.65512617193849,-2.94640976790208,-3.01147184043474,0.418953289588122,-1.8602554675923,2.07502372864851,2.23197511879416,3.77070934301328,0.0873387907485269,-6.0251767697577,-2.92925942555436,-1.37480474565574,-0.760072357367478,0.866351115881724,0.775331213349539,-0.528730916906763,-0.791807120249666,-2.85434601246157,2.55208435392359,1.22146763124848,-1.08744389302262,-0.750767849712733,2.28298044216336,-0.140546000705087,1.97487375669685,1.5228832413366,-2.24587395467828,-2.08184827743835,-1.06401908089937,-3.27378130355721,-1.23247839126816,-0.791807120249667,1.00141041356008,0.0270318659982166,3.53603222375692,0.312934867134759,-0.346942499687587,-2.73536610208223,-4.70660604131172,-0.00738509993655636,0.83284635685646,-2.62594687235201,-0.956153798970743,3.18874338840916,-0.791807120249667,-0.761464865832364,-1.39346524940518,0.84999669920418,0.121023205830115,-0.69781326696592,-3.25528843806406,-0.763403010869588,1.57169358842431,0.308931600594576,5.88590039862656,0.682773293239123,-2.8807542582928,0.751477363813679,0.560154064569638,2.28713762544423,-2.30106966976248,11.1825410524607,0.650480470413352,0.560003228024782,3.08271692041227,3.84588992955306,1.4259409755107,-0.48593910375161,-0.988445353723404,-2.96099418843654,-6.07368193701926,-0.776049286366833,1.97402459970979,7.47301570685624,-2.75251644442995,0.244791925035197,-0.791807120249667,-0.834963702652258,-1.87740580994002,0.476155006559635,-0.283852911891559,-0.852114044999977,3.66100108055515,0.027031865998216,-2.97814453078426,-0.760072357367479,0.424741034702748,-3.23653680258836,3.24297707849804,-0.749456829559982,-6.0365985892781,0.0595083268667454,-0.72871753245364,0.00709886060477673,2.31471520504555,-0.791807120249667,-1.00753384110834,-0.808957462597387,2.22350401480751,-0.760072357367479,8.06587365367529,0.84999669920418,1.88710542540638,-0.280344395842815,-0.72298900962632,-1.50356411729547,0.308931600594576,-5.00217330963617,-0.27230511920102,0.84999669920418,-0.223004170947065,2.75819031622352,-0.485939103751611,-1.48641377494775,-0.0360577217978117,-1.04999577603402,3.02240999566196,-0.808957462597387,-1.02135352995395,-1.00420318760624,-2.20524478998469,2.20357100941408,-0.814541392460031,-1.44197041666674,-3.07583163197834,-0.109860954387011,2.17816196207245,0.0873387907485262,3.322195522521,2.20357100941408,-0.0100514817429415,0.560003228024789,-0.233013186290863,-3.35508908945222,-1.64568331644142,-2.96099418843654,-0.29148551842895,-0.761464865832366,1.97487375669685,-2.96099418843654,-0.728717532453639,-1.45912075901446,0.375780316256859,12.8748186262961,1.4259409755107,0.925830858475525,0.199932192387692,-0.926186263321842,-0.679832427223731,-0.765214663442814,-1.00720396287887,-2.97814453078426,-0.760072357367479,-1.01084386327632,3.67815142290287,2.32280843850173,2.28713762544423,12.9064005040783,-2.73536610208224,-2.63985283305162],"col_var":["1","1","2","3","2","4","5","1","1","1","1","4","5","1","4","1","1","2","6","1","4","6","4","1","1","6","3","1","3","3","1","2","2","3","6","1","6","1","1","4","1","2","2","2","1","2","6","4","4","1","3","2","5","1","6","1","1","1","2","3","3","1","3","4","1","4","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","6","5","1","1","1","2","1","3","1","3","1","2","1","1","6","2","3","6","6","4","4","1","1","6","2","3","6","4","3","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","6","3","6","1","1","4","1","1","1","4","1","3","1","4","1","1","2","1","2","6","1","6","4","1","2","1","1","4","1","1","1","2","4","1","5","2","1","4","1","3","4","1","6","1","2","2","2","6","6","4","2","1","5","1","4","1","3","1","6","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201],"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 2","ylab":"Axis 3","has_labels":false,"col_lab":"Cluster","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":["Tree 1","Tree 2","Tree 3","Tree 4","Tree 5","Tree 6","Tree 7","Tree 8","Tree 9","Tree 10","Tree 11","Tree 12","Tree 13","Tree 14","Tree 15","Tree 16","Tree 17","Tree 18","Tree 19","Tree 20","Tree 21","Tree 22","Tree 23","Tree 24","Tree 25","Tree 26","Tree 27","Tree 28","Tree 29","Tree 30","Tree 31","Tree 32","Tree 33","Tree 34","Tree 35","Tree 36","Tree 37","Tree 38","Tree 39","Tree 40","Tree 41","Tree 42","Tree 43","Tree 44","Tree 45","Tree 46","Tree 47","Tree 48","Tree 49","Tree 50","Tree 51","Tree 52","Tree 53","Tree 54","Tree 55","Tree 56","Tree 57","Tree 58","Tree 59","Tree 60","Tree 61","Tree 62","Tree 63","Tree 64","Tree 65","Tree 66","Tree 67","Tree 68","Tree 69","Tree 70","Tree 71","Tree 72","Tree 73","Tree 74","Tree 75","Tree 76","Tree 77","Tree 78","Tree 79","Tree 80","Tree 81","Tree 82","Tree 83","Tree 84","Tree 85","Tree 86","Tree 87","Tree 88","Tree 89","Tree 90","Tree 91","Tree 92","Tree 93","Tree 94","Tree 95","Tree 96","Tree 97","Tree 98","Tree 99","Tree 100","Tree 101","Tree 102","Tree 103","Tree 104","Tree 105","Tree 106","Tree 107","Tree 108","Tree 109","Tree 110","Tree 111","Tree 112","Tree 113","Tree 114","Tree 115","Tree 116","Tree 117","Tree 118","Tree 119","Tree 120","Tree 121","Tree 122","Tree 123","Tree 124","Tree 125","Tree 126","Tree 127","Tree 128","Tree 129","Tree 130","Tree 131","Tree 132","Tree 133","Tree 134","Tree 135","Tree 136","Tree 137","Tree 138","Tree 139","Tree 140","Tree 141","Tree 142","Tree 143","Tree 144","Tree 145","Tree 146","Tree 147","Tree 148","Tree 149","Tree 150","Tree 151","Tree 152","Tree 153","Tree 154","Tree 155","Tree 156","Tree 157","Tree 158","Tree 159","Tree 160","Tree 161","Tree 162","Tree 163","Tree 164","Tree 165","Tree 166","Tree 167","Tree 168","Tree 169","Tree 170","Tree 171","Tree 172","Tree 173","Tree 174","Tree 175","Tree 176","Tree 177","Tree 178","Tree 179","Tree 180","Tree 181","Tree 182","Tree 183","Tree 184","Tree 185","Tree 186","Tree 187","Tree 188","Tree 189","Tree 190","Tree 191","Tree 192","Tree 193","Tree 194","Tree 195","Tree 196","Tree 197","Tree 198","Tree 199","Tree 200","Tree 201"],"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":true,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":50,"left_margin":30,"html_id":"scatterD3-KOUMWSDQ","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>We can also plot in 3D:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare a colour palette:</span></span>
<span><span class="va">colours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/adegenet/man/auxil.html" class="external-link">fac2col</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">$</span><span class="va">groups</span>, col.pal<span class="op">=</span><span class="va">funky</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/plot3d.html" class="external-link">plot3d</a></span><span class="op">(</span><span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>,</span>
<span>       <span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>,</span>
<span>       <span class="va">wm.groves</span><span class="op">$</span><span class="va">treespace</span><span class="op">$</span><span class="va">pco</span><span class="op">$</span><span class="va">li</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span>,</span>
<span>       col<span class="op">=</span><span class="va">colours</span>, type<span class="op">=</span><span class="st">"s"</span>, size<span class="op">=</span><span class="fl">1.5</span>,</span>
<span>       xlab<span class="op">=</span><span class="st">""</span>, ylab<span class="op">=</span><span class="st">""</span>, zlab<span class="op">=</span><span class="st">""</span><span class="op">)</span></span></code></pre></div>
<div id="rgl51568" style="width:672px;height:672px;" class="rglWebGL html-widget "></div>
<script type="application/json" data-for="rgl51568">{"x":{"material":{"color":"#000000","alpha":1,"lit":true,"ambient":"#000000","specular":"#FFFFFF","emission":"#000000","shininess":50,"smooth":true,"front":"filled","back":"filled","size":3,"lwd":1,"fog":true,"point_antialias":false,"line_antialias":false,"texture":null,"textype":"rgb","texmode":"modulate","texmipmap":false,"texminfilter":"linear","texmagfilter":"linear","texenvmap":false,"depth_mask":true,"depth_test":"less","isTransparent":false,"polygon_offset":[0,0],"margin":"","floating":false,"tag":"","blend":["src_alpha","one_minus_src_alpha"]},"rootSubscene":7,"objects":{"13":{"id":13,"type":"spheres","material":{},"vertices":"0","colors":"1","radii":[[0.63639885187149]],"centers":"2","ignoreExtent":false,"fastTransparency":true,"flags":32771},"15":{"id":15,"type":"text","material":{"lit":false,"margin":0,"floating":true,"edge":[0,1,1]},"vertices":"3","colors":"4","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"5","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"16":{"id":16,"type":"text","material":{"lit":false,"margin":1,"floating":true,"edge":[1,1,1]},"vertices":"6","colors":"7","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"8","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"17":{"id":17,"type":"text","material":{"lit":false,"margin":2,"floating":true,"edge":[1,1,1]},"vertices":"9","colors":"10","texts":[[""]],"cex":[[1]],"adj":[[0.5,0.5,0.5]],"centers":"11","family":[["sans"]],"font":[[1]],"ignoreExtent":true,"flags":33808},"11":{"id":11,"type":"light","vertices":[[0,0,1]],"colors":[[1,1,1,1],[1,1,1,1],[1,1,1,1]],"viewpoint":true,"finite":false},"10":{"id":10,"type":"background","material":{},"colors":"12","centers":"13","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"12":{"id":12,"type":"background","material":{"lit":false,"back":"lines"},"colors":"14","centers":"15","sphere":false,"fogtype":"none","fogscale":1,"flags":32768},"14":{"id":14,"type":"bboxdeco","material":{"front":"lines","back":"lines"},"vertices":"16","colors":"17","axes":{"mode":["pretty","pretty","pretty"],"step":[5,5,5],"nticks":[5,5,5],"marklen":[15,15,15],"expand":[1.02999997138977,1.02999997138977,1.02999997138977]},"draw_front":true,"flags":32769},"7":{"id":7,"type":"subscene","par3d":{"antialias":8,"FOV":30,"ignoreExtent":false,"listeners":7,"mouseMode":{"none":"none","left":"trackball","right":"zoom","middle":"fov","wheel":"pull"},"observer":[0,0,113.285781860352],"modelMatrix":[[0.84701806306839,0,0,1.29879772663116],[0,0.333741307258606,1.26030898094177,-3.31583666801453],[0,-0.916946649551392,0.458714991807938,-117.572456359863],[0,0,0,1]],"projMatrix":[[3.73205089569092,0,0,0],[0,3.73205089569092,0,0],[0,0,-3.86370372772217,-408.382141113281],[0,0,-1,0]],"skipRedraw":false,"userMatrix":[[1,0,0,0],[0,0.342020143325668,0.939692620785909,0],[0,-0.939692620785909,0.342020143325668,0],[0,0,0,1]],"userProjection":[[1,0,0,0],[0,1,0,0],[0,0,1,0],[0,0,0,1]],"scale":[0.84701806306839,0.97579425573349,1.34119284152985],"viewport":{"x":0,"y":0,"width":1,"height":1},"zoom":1,"bbox":[-17.3115253448486,14.2447710037231,-16.6617603302002,10.7300300598145,-6.54818391799927,13.3809032440186],"windowRect":[0,45,256,301],"family":"sans","font":1,"cex":1,"useFreeType":true,"fontname":"/Library/Frameworks/R.framework/Versions/4.2/Resources/library/rgl/fonts/FreeSans.ttf","maxClipPlanes":6,"glVersion":2.1,"activeSubscene":0},"embeddings":{"viewport":"replace","projection":"replace","model":"replace","mouse":"replace"},"objects":[12,14,13,15,16,17,11],"subscenes":[],"flags":34067}},"crosstalk":{"key":[],"group":[],"id":[],"options":[]},"width":672,"height":672,"buffer":{"accessors":[{"bufferView":0,"componentType":5126,"count":201,"type":"VEC3"},{"bufferView":1,"componentType":5121,"count":201,"type":"VEC4","normalized":true},{"bufferView":2,"componentType":5126,"count":201,"type":"VEC3"},{"bufferView":3,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":4,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":5,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":6,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":7,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":8,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":9,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":10,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":11,"componentType":5126,"count":1,"type":"VEC3"},{"bufferView":12,"componentType":5126,"count":1,"type":"VEC4"},{"bufferView":13,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":14,"componentType":5121,"count":1,"type":"VEC4"},{"bufferView":15,"componentType":5121,"count":1,"type":"VEC3"},{"bufferView":16,"componentType":5126,"count":16,"type":"VEC3"},{"bufferView":17,"componentType":5121,"count":1,"type":"VEC4"}],"bufferViews":[{"buffer":0,"byteLength":2412,"byteOffset":0},{"buffer":0,"byteLength":804,"byteOffset":2412},{"buffer":0,"byteLength":2412,"byteOffset":3216},{"buffer":0,"byteLength":12,"byteOffset":5628},{"buffer":0,"byteLength":4,"byteOffset":5640},{"buffer":0,"byteLength":12,"byteOffset":5644},{"buffer":0,"byteLength":12,"byteOffset":5656},{"buffer":0,"byteLength":4,"byteOffset":5668},{"buffer":0,"byteLength":12,"byteOffset":5672},{"buffer":0,"byteLength":12,"byteOffset":5684},{"buffer":0,"byteLength":4,"byteOffset":5696},{"buffer":0,"byteLength":12,"byteOffset":5700},{"buffer":0,"byteLength":16,"byteOffset":5712},{"buffer":0,"byteLength":3,"byteOffset":5728},{"buffer":0,"byteLength":4,"byteOffset":5731},{"buffer":0,"byteLength":3,"byteOffset":5735},{"buffer":0,"byteLength":192,"byteOffset":5740},{"buffer":0,"byteLength":4,"byteOffset":5932}],"buffers":[{"byteLength":5936,"bytes":"yrJ+v5t1rr/fs0q/Cxodv9TVgb9/CS6/UasqQKQAh0D9eDvA17pZwUVO7T+iHYw/dqsMQOak\nhUAZi0zAaHtmQOOqm0CYDz9Amej9wJwTgMFlEf+7jvwZvyGMg78R+Ea/yrJ+v5t1rr/fs0q/\njvwZvyGMg78R+Ea/MW4bv7CKg78alEK/IU8mQQNqAb8Dc1NApYcDwQ7TIME7FFrAz+4KvxhB\nib/kozK/f3dVQHMKhUDj0xlAF4UzvRfkMEB+ll0/mJQovh9FJkDhuws+kpwyQO0KnkBz6AXA\nSL8oQV4zLMFk0lE/Epscv0WZDcAmC12+AeJkQJjpm0CBZT1AK1IaQVYkGMHm1NI/qrB3QBOU\nVEASeQNA6w9tv/iuV79ZGt69IwucvwdVN79hbkO/kjseQE0n5cBd70K/i8wNwdMjuEBRo5PA\nIwucvwdVN79hbkO/Eitpwbp82r+HVqa/vaNZwdRM7T+m64k/FflqP2nCnEAZ9q0/K9oRQNKL\neEDugD3ArEgSQIfUs0CnXwrA2mV8wbNQsD6Gw3lAiYwJQI6sZsFy38E+CXpKv4leAL9Mu9Q9\nLKdMQcmZGcGqxQhAzbtxPzrFhD+rty+/Y8ufv175qr6MgRe/Dd5+QAGuXUBC9g1AYNOBvzh8\nrb8uwFW/hUIBQJRsnUCW7SnAugcrQEgAh0D6kTzAn2hmQBA25ED0u0DAQGa4vnUkRrsMgdY+\nY8xXQFJjoEDaHO6/LFSBPvT5UMEwzQRAn1dXQNCecUCu2A5AlfLMQPdk4EBNU3FAoKR+v9vm\nxT6u3rI9Wb0WwbGdcEBAzsDAUasqQKQAh0D9eDvAhTMXwaPdPcGa+a+/MW4bv7CKg78alEK/\nh91SQZ0qBcEwyV0/9Q/pP9xVIUAbfEY/fuifv7UrpL7pWge/yrJ+v5t1rr/fs0q/E/obQBcT\nlECbrTbAkrZQwRMqd0BaVSNAXod/weHAyr8NWZw/2tJpv416r79dMYu/+BhawWF18L9SMkC/\n7nNpQMheRUBaHBJAzDorP518mL9K6w++Z1kCQc9scL+qyPw/GOVXQTnZH8HX7cI/FWSBQFjf\nvkBmvA/Atd0RQL5BtEABPQXAWaQUv0kFhL/HMYi/kG4XQKEIeECihVHAAamqQKcY8kDawZ2/\nyrJ+v5t1rr/fs0q/pBAxQQbzMsE3LoA/ehOBv6LGyT7vcd08AH6YQMaZ30BaTmJA0M64P2da\nsD8AOaA+0oEvvrxonT9zorG+fK0BQF3/nEA9EC/AyQ8MwWK30UCEnJbAKdxbvytOmL+1/vG7\n9RipvhJcXj9rNVU/nKR5QCQrw0CDDyjAnqaVvexSnT9/xnS/tjqEwZ7jFT5fFExAyrJ+v5t1\nrr/fs0q/kjseQE0n5cBd70K/wWkawWz1PMESXbK/PPyrvvReXj9imVk/retLv6dbAL8E2/c9\nz+4KvxhBib/kozK/Nk+GPwvKtz+lVlDAIwucvwdVN79hbkO/Hct6wQPH4b9BLck/x7DIPcX/\nb75ILJ4+GZEVwW2IcsBMWbxAMMDfvm0jJT87yi4/NG8RQEBmeUBHXjjAPyM1vgt7EUDSYEA/\n04J0Pzbmkz9CZg8/ZlxOQT4GFsF2YBJAR1mwQB95BUG6RBPAD30nwfl8lkCw6zJBW9YjvWt0\nsMDjhSY/DHMYQemtA8FfXA8/CLRlQHYYnEA8S0VAsYyNQE33xUAQI3ZAo5lBPeCinDw8hbY/\nsIigv8Jrp74Dzfi+vBwXQB4h6sDBCn2/K9oRQNKLeEDugD3AUm4QwV2cgkCaW8LAAg4FQKvh\n78Arq0a/oRt4QKa5U0DXrPw/ScXOwFIj+D/yIu9A5QkCQAH/nEA7KTDAXQHpPyGm4T+8qno+\nyrJ+v5t1rr/fs0q/YNOBvzh8rb8uwFW/zChYQPZioEDVTvC/S+BLPpEaMbyXyvM+rGowviYc\nnz8rVZG+jxqBv6l9rb8lJFq/yuCEQBpepEDXTWpAehOBv6LGyT7vcd08lDYSQBqLeEDsmT7A\nMW4bv7CKg78alEK/ouAEv1jgrr+od9k+wjMFQAnakEBrI0/AQnuEwRlhKz7wjE9AaOEdQNFg\n5cBn3D+/T9gQwexHg0DRK8HA4cReQOgNLsEBv3M9Ae1+vzHCrL87jTq/xvh8v24Tvz6Pneg7\niiKBQD7UWkBLJBRAyrJ+v5t1rr/fs0q//I+pv3UmX7/e9oC/J0F9vwx3rr/WF0+/82RkQKqP\nSUDkTQ5AMW4bv7CKg78alEK/QGP1wGqogL/SDQFBPPyrvvReXj9imVk/wzDXQNOLBsCsjPE/\nvQSOvhxJEz1NiY++AQ4iv3LcgL/PFTm/QOs1QGGHvEDKdMC/x7DIPcX/b75ILJ4+5nI7QLYn\n7D7OEaDAYAFNQDP5HcGUa4u+PPyrvvReXj9imVk/h9Q3QB4fAME1W2S+y2yKQEKikEAxhjBA\nsIigv8Jrp74Dzfi+1441QL6HvEDOQr6/XvaAv/r4wj5DsRO9UT5qv671rL9DZoa/dNNkQHNW\nnEAqb0FAJ0F9vwx3rr/WF0+/PwY1v9h0l7+2u4K/4nc2v2dzl7+7iYC/rgsRQOAStEC7Ig3A\nfrBlQEQ5SEBPBw1A24KBv3cnr7/JhVC/uhoUwarON8F9kri/VisVQAxziUBt2kTA9v4ovhrk\n9r/I/uC9w2JTQIhNgEABZwtAoKR+v9vmxT6u3rI9z7+BwYyM7LzanlRAfrBlQEQ5SEBPBw1A\nI4d7v6oNvz74riS8DHMYQemtA8FfXA8/bikbv/2ZDcACm26+1yMvQApihkDIuVbAFoJdQLHC\n90DApdK/K9oRQNKLeEDugD3AY8FoQB9VJ8GXPZW+kjseQE0n5cBd70K/Z1kCQc9scL+qyPw/\nK9oRQNKLeEDugD3AAe1+vzHCrL87jTq/nwMUwdjON8F4xLq/fRJcPwOObj9HZsA+AVZGP9o+\nIUFC/01Bo5lBPeCinDw8hbY/Xzl+wdPFy79AA20/TljPPjai3j8Gu0w+lTwbQLiO68CLGm2/\nCxodv9TVgb9/CS6/NWUbvzRyhL8c5UO/tH5rv7HFrb8P7IC/lDYSQBqLeEDsmT7AMW4bv7CK\ng78alEK/ZANEv2bvTj5VY4G/lbKEQHZepEDVZmtA+ORSwcdCwz/lqBRAZlxOQT4GFsF2YBJA\nkmmIQAMjA0GegE5BfK0BQF3/nEA9EC/AcEZXQM+r7kBZ8yjAps7j/6bO4/+Y0nf/8WZn/5jS\nd//+mCz/fVSl/6bO4/+mzuP/ps7j/6bO4//+mCz/fVSl/6bO4//+mCz/ps7j/6bO4/+Y0nf/\nsVko/6bO4//+mCz/sVko//6YLP+mzuP/ps7j/7FZKP/xZmf/ps7j//FmZ//xZmf/ps7j/5jS\nd/+Y0nf/8WZn/7FZKP+mzuP/sVko/6bO4/+mzuP//pgs/6bO4/+Y0nf/mNJ3/5jSd/+mzuP/\nmNJ3/7FZKP/+mCz//pgs/6bO4//xZmf/mNJ3/31Upf+mzuP/sVko/6bO4/+mzuP/ps7j/5jS\nd//xZmf/8WZn/6bO4//xZmf//pgs/6bO4//+mCz/sVko/5jSd/+Y0nf/ps7j/5jSd/+Y0nf/\nps7j/7FZKP+mzuP//pgs/6bO4/+mzuP/mNJ3//FmZ/+mzuP/ps7j/5jSd/+mzuP/8WZn/6bO\n4/+xWSj/fVSl/6bO4/+mzuP/ps7j/5jSd/+mzuP/8WZn/6bO4//xZmf/ps7j/5jSd/+mzuP/\nps7j/7FZKP+Y0nf/8WZn/7FZKP+xWSj//pgs//6YLP+mzuP/ps7j/7FZKP+Y0nf/8WZn/7FZ\nKP/+mCz/8WZn/5jSd/+mzuP/ps7j/6bO4/+Y0nf/ps7j/6bO4/+mzuP//pgs/6bO4/+Y0nf/\nps7j/6bO4/+Y0nf/8WZn/7FZKP/xZmf/sVko/6bO4/+mzuP//pgs/6bO4/+mzuP/ps7j//6Y\nLP+mzuP/8WZn/6bO4//+mCz/ps7j/6bO4/+Y0nf/ps7j/5jSd/+xWSj/ps7j/7FZKP/+mCz/\nps7j/5jSd/+mzuP/ps7j//6YLP+mzuP/ps7j/6bO4/+Y0nf//pgs/6bO4/99VKX/mNJ3/6bO\n4//+mCz/ps7j//FmZ//+mCz/ps7j/7FZKP+mzuP/mNJ3/5jSd/+Y0nf/sVko/7FZKP/+mCz/\nmNJ3/6bO4/99VKX/ps7j//6YLP+mzuP/8WZn/6bO4/+xWSj/ps7j/6bO4/+mzuP/mNJ3/6bO\n4/+mzuP//pgs//FmZ/+xWSj//pgs/5jSd/+Y0nf/yrJ+v5t1rr/fs0q/Cxodv9TVgb9/CS6/\nUasqQKQAh0D9eDvA17pZwUVO7T+iHYw/dqsMQOakhUAZi0zAaHtmQOOqm0CYDz9Amej9wJwT\ngMFlEf+7jvwZvyGMg78R+Ea/yrJ+v5t1rr/fs0q/jvwZvyGMg78R+Ea/MW4bv7CKg78alEK/\nIU8mQQNqAb8Dc1NApYcDwQ7TIME7FFrAz+4KvxhBib/kozK/f3dVQHMKhUDj0xlAF4UzvRfk\nMEB+ll0/mJQovh9FJkDhuws+kpwyQO0KnkBz6AXASL8oQV4zLMFk0lE/Epscv0WZDcAmC12+\nAeJkQJjpm0CBZT1AK1IaQVYkGMHm1NI/qrB3QBOUVEASeQNA6w9tv/iuV79ZGt69IwucvwdV\nN79hbkO/kjseQE0n5cBd70K/i8wNwdMjuEBRo5PAIwucvwdVN79hbkO/Eitpwbp82r+HVqa/\nvaNZwdRM7T+m64k/FflqP2nCnEAZ9q0/K9oRQNKLeEDugD3ArEgSQIfUs0CnXwrA2mV8wbNQ\nsD6Gw3lAiYwJQI6sZsFy38E+CXpKv4leAL9Mu9Q9LKdMQcmZGcGqxQhAzbtxPzrFhD+rty+/\nY8ufv175qr6MgRe/Dd5+QAGuXUBC9g1AYNOBvzh8rb8uwFW/hUIBQJRsnUCW7SnAugcrQEgA\nh0D6kTzAn2hmQBA25ED0u0DAQGa4vnUkRrsMgdY+Y8xXQFJjoEDaHO6/LFSBPvT5UMEwzQRA\nn1dXQNCecUCu2A5AlfLMQPdk4EBNU3FAoKR+v9vmxT6u3rI9Wb0WwbGdcEBAzsDAUasqQKQA\nh0D9eDvAhTMXwaPdPcGa+a+/MW4bv7CKg78alEK/h91SQZ0qBcEwyV0/9Q/pP9xVIUAbfEY/\nfuifv7UrpL7pWge/yrJ+v5t1rr/fs0q/E/obQBcTlECbrTbAkrZQwRMqd0BaVSNAXod/weHA\nyr8NWZw/2tJpv416r79dMYu/+BhawWF18L9SMkC/7nNpQMheRUBaHBJAzDorP518mL9K6w++\nZ1kCQc9scL+qyPw/GOVXQTnZH8HX7cI/FWSBQFjfvkBmvA/Atd0RQL5BtEABPQXAWaQUv0kF\nhL/HMYi/kG4XQKEIeECihVHAAamqQKcY8kDawZ2/yrJ+v5t1rr/fs0q/pBAxQQbzMsE3LoA/\nehOBv6LGyT7vcd08AH6YQMaZ30BaTmJA0M64P2dasD8AOaA+0oEvvrxonT9zorG+fK0BQF3/\nnEA9EC/AyQ8MwWK30UCEnJbAKdxbvytOmL+1/vG79RipvhJcXj9rNVU/nKR5QCQrw0CDDyjA\nnqaVvexSnT9/xnS/tjqEwZ7jFT5fFExAyrJ+v5t1rr/fs0q/kjseQE0n5cBd70K/wWkawWz1\nPMESXbK/PPyrvvReXj9imVk/retLv6dbAL8E2/c9z+4KvxhBib/kozK/Nk+GPwvKtz+lVlDA\nIwucvwdVN79hbkO/Hct6wQPH4b9BLck/x7DIPcX/b75ILJ4+GZEVwW2IcsBMWbxAMMDfvm0j\nJT87yi4/NG8RQEBmeUBHXjjAPyM1vgt7EUDSYEA/04J0Pzbmkz9CZg8/ZlxOQT4GFsF2YBJA\nR1mwQB95BUG6RBPAD30nwfl8lkCw6zJBW9YjvWt0sMDjhSY/DHMYQemtA8FfXA8/CLRlQHYY\nnEA8S0VAsYyNQE33xUAQI3ZAo5lBPeCinDw8hbY/sIigv8Jrp74Dzfi+vBwXQB4h6sDBCn2/\nK9oRQNKLeEDugD3AUm4QwV2cgkCaW8LAAg4FQKvh78Arq0a/oRt4QKa5U0DXrPw/ScXOwFIj\n+D/yIu9A5QkCQAH/nEA7KTDAXQHpPyGm4T+8qno+yrJ+v5t1rr/fs0q/YNOBvzh8rb8uwFW/\nzChYQPZioEDVTvC/S+BLPpEaMbyXyvM+rGowviYcnz8rVZG+jxqBv6l9rb8lJFq/yuCEQBpe\npEDXTWpAehOBv6LGyT7vcd08lDYSQBqLeEDsmT7AMW4bv7CKg78alEK/ouAEv1jgrr+od9k+\nwjMFQAnakEBrI0/AQnuEwRlhKz7wjE9AaOEdQNFg5cBn3D+/T9gQwexHg0DRK8HA4cReQOgN\nLsEBv3M9Ae1+vzHCrL87jTq/xvh8v24Tvz6Pneg7iiKBQD7UWkBLJBRAyrJ+v5t1rr/fs0q/\n/I+pv3UmX7/e9oC/J0F9vwx3rr/WF0+/82RkQKqPSUDkTQ5AMW4bv7CKg78alEK/QGP1wGqo\ngL/SDQFBPPyrvvReXj9imVk/wzDXQNOLBsCsjPE/vQSOvhxJEz1NiY++AQ4iv3LcgL/PFTm/\nQOs1QGGHvEDKdMC/x7DIPcX/b75ILJ4+5nI7QLYn7D7OEaDAYAFNQDP5HcGUa4u+PPyrvvRe\nXj9imVk/h9Q3QB4fAME1W2S+y2yKQEKikEAxhjBAsIigv8Jrp74Dzfi+1441QL6HvEDOQr6/\nXvaAv/r4wj5DsRO9UT5qv671rL9DZoa/dNNkQHNWnEAqb0FAJ0F9vwx3rr/WF0+/PwY1v9h0\nl7+2u4K/4nc2v2dzl7+7iYC/rgsRQOAStEC7Ig3AfrBlQEQ5SEBPBw1A24KBv3cnr7/JhVC/\nuhoUwarON8F9kri/VisVQAxziUBt2kTA9v4ovhrk9r/I/uC9w2JTQIhNgEABZwtAoKR+v9vm\nxT6u3rI9z7+BwYyM7LzanlRAfrBlQEQ5SEBPBw1AI4d7v6oNvz74riS8DHMYQemtA8FfXA8/\nbikbv/2ZDcACm26+1yMvQApihkDIuVbAFoJdQLHC90DApdK/K9oRQNKLeEDugD3AY8FoQB9V\nJ8GXPZW+kjseQE0n5cBd70K/Z1kCQc9scL+qyPw/K9oRQNKLeEDugD3AAe1+vzHCrL87jTq/\nnwMUwdjON8F4xLq/fRJcPwOObj9HZsA+AVZGP9o+IUFC/01Bo5lBPeCinDw8hbY/Xzl+wdPF\ny79AA20/TljPPjai3j8Gu0w+lTwbQLiO68CLGm2/Cxodv9TVgb9/CS6/NWUbvzRyhL8c5UO/\ntH5rv7HFrb8P7IC/lDYSQBqLeEDsmT7AMW4bv7CKg78alEK/ZANEv2bvTj5VY4G/lbKEQHZe\npEDVZmtA+ORSwcdCwz/lqBRAZlxOQT4GFsF2YBJAkmmIQAMjA0GegE5BfK0BQF3/nEA9EC/A\ncEZXQM+r7kBZ8yjAAADAfwAAgEAAAIA/AAAAAQAAwH8AAIBAAACAPwAAwH8AAIBAAACAPwAA\nAAEAAMB/AACAQAAAgD8AAMB/AACAQAAAgD8AAAABAADAfwAAgEAAAIA/mZiYPpmYmD6ZmJg+\nAACAPwAAAAEBAQEAAAAAAAAAcMEAAMB/AADAfwAAIMEAAMB/AADAfwAAoMAAAMB/AADAfwAA\nAAAAAMB/AADAfwAAoEAAAMB/AADAfwAAIEEAAMB/AADAfwAAwH8AAHDBAADAfwAAwH8AACDB\nAADAfwAAwH8AAKDAAADAfwAAwH8AAAAAAADAfwAAwH8AAKBAAADAfwAAwH8AACBBAADAfwAA\nwH8AAMB/AACgwAAAwH8AAMB/AAAAAAAAwH8AAMB/AACgQAAAwH8AAMB/AAAgQQAAAAE="}]},"context":{"shiny":false,"rmarkdown":"rmarkdown::html_vignette"},"vertexShader":"#line 2 1\n// File 1 is the vertex shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\n\nattribute vec3 aPos;\nattribute vec4 aCol;\nuniform mat4 mvMatrix;\nuniform mat4 prMatrix;\nvarying vec4 vCol;\nvarying vec4 vPosition;\n\n#ifdef NEEDS_VNORMAL\nattribute vec3 aNorm;\nuniform mat4 normMatrix;\nvarying vec4 vNormal;\n#endif\n\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nattribute vec2 aTexcoord;\nvarying vec2 vTexcoord;\n#endif\n\n#ifdef FIXED_SIZE\nuniform vec3 textScale;\n#endif\n\n#ifdef FIXED_QUADS\nattribute vec3 aOfs;\n#endif\n\n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\nvarying float normz;\nuniform mat4 invPrMatrix;\n#else\nattribute vec3 aPos1;\nattribute vec3 aPos2;\nvarying float normz;\n#endif\n#endif // IS_TWOSIDED\n\n#ifdef FAT_LINES\nattribute vec3 aNext;\nattribute vec2 aPoint;\nvarying vec2 vPoint;\nvarying float vLength;\nuniform float uAspect;\nuniform float uLwd;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  \n#ifndef IS_BRUSH\n#if defined(NCLIPPLANES) || !defined(FIXED_QUADS) || defined(HAS_FOG) || defined(USE_ENVMAP)\n  vPosition = mvMatrix * vec4(aPos, 1.);\n#endif\n  \n#ifndef FIXED_QUADS\n  gl_Position = prMatrix * vPosition;\n#endif\n#endif // !IS_BRUSH\n  \n#ifdef IS_POINTS\n  gl_PointSize = POINTSIZE;\n#endif\n  \n  vCol = aCol;\n  \n// USE_ENVMAP implies NEEDS_VNORMAL\n\n#ifdef NEEDS_VNORMAL\n  vNormal = normMatrix * vec4(-aNorm, dot(aNorm, aPos));\n#endif\n\n#ifdef USE_ENVMAP\n  vReflection = normalize(reflect(vPosition.xyz/vPosition.w, \n                        normalize(vNormal.xyz/vNormal.w)));\n#endif\n  \n#ifdef IS_TWOSIDED\n#ifdef HAS_NORMALS\n  /* normz should be calculated *after* projection */\n  normz = (invPrMatrix*vNormal).z;\n#else\n  vec4 pos1 = prMatrix*(mvMatrix*vec4(aPos1, 1.));\n  pos1 = pos1/pos1.w - gl_Position/gl_Position.w;\n  vec4 pos2 = prMatrix*(mvMatrix*vec4(aPos2, 1.));\n  pos2 = pos2/pos2.w - gl_Position/gl_Position.w;\n  normz = pos1.x*pos2.y - pos1.y*pos2.x;\n#endif\n#endif // IS_TWOSIDED\n  \n#ifdef NEEDS_VNORMAL\n  vNormal = vec4(normalize(vNormal.xyz/vNormal.w), 1);\n#endif\n  \n#if defined(HAS_TEXTURE) || defined(IS_TEXT)\n  vTexcoord = aTexcoord;\n#endif\n  \n#if defined(FIXED_SIZE) && !defined(ROTATING)\n  vec4 pos = prMatrix * mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w;\n  gl_Position = pos + vec4(aOfs*textScale, 0.);\n#endif\n  \n#if defined(IS_SPRITES) && !defined(FIXED_SIZE)\n  vec4 pos = mvMatrix * vec4(aPos, 1.);\n  pos = pos/pos.w + vec4(aOfs,  0.);\n  gl_Position = prMatrix*pos;\n#endif\n  \n#ifdef FAT_LINES\n  /* This code was inspired by Matt Deslauriers' code in \n   https://mattdesl.svbtle.com/drawing-lines-is-hard */\n  vec2 aspectVec = vec2(uAspect, 1.0);\n  mat4 projViewModel = prMatrix * mvMatrix;\n  vec4 currentProjected = projViewModel * vec4(aPos, 1.0);\n  currentProjected = currentProjected/currentProjected.w;\n  vec4 nextProjected = projViewModel * vec4(aNext, 1.0);\n  vec2 currentScreen = currentProjected.xy * aspectVec;\n  vec2 nextScreen = (nextProjected.xy / nextProjected.w) * aspectVec;\n  float len = uLwd;\n  vec2 dir = vec2(1.0, 0.0);\n  vPoint = aPoint;\n  vLength = length(nextScreen - currentScreen)/2.0;\n  vLength = vLength/(vLength + len);\n  if (vLength > 0.0) {\n    dir = normalize(nextScreen - currentScreen);\n  }\n  vec2 normal = vec2(-dir.y, dir.x);\n  dir.x /= uAspect;\n  normal.x /= uAspect;\n  vec4 offset = vec4(len*(normal*aPoint.x*aPoint.y - dir), 0.0, 0.0);\n  gl_Position = currentProjected + offset;\n#endif\n  \n#ifdef IS_BRUSH\n  gl_Position = vec4(aPos, 1.);\n#endif\n}","fragmentShader":"#line 2 2\n// File 2 is the fragment shader\n#ifdef GL_ES\n#ifdef GL_FRAGMENT_PRECISION_HIGH\nprecision highp float;\n#else\nprecision mediump float;\n#endif\n#endif\nvarying vec4 vCol; // carries alpha\nvarying vec4 vPosition;\n#if defined(HAS_TEXTURE) || defined (IS_TEXT)\nvarying vec2 vTexcoord;\nuniform sampler2D uSampler;\n#endif\n\n#ifdef HAS_FOG\nuniform int uFogMode;\nuniform vec3 uFogColor;\nuniform vec4 uFogParms;\n#endif\n\n#if defined(IS_LIT) && !defined(FIXED_QUADS)\nvarying vec4 vNormal;\n#endif\n\n#if NCLIPPLANES > 0\nuniform vec4 vClipplane[NCLIPPLANES];\n#endif\n\n#if NLIGHTS > 0\nuniform mat4 mvMatrix;\n#endif\n\n#ifdef IS_LIT\nuniform vec3 emission;\nuniform float shininess;\n#if NLIGHTS > 0\nuniform vec3 ambient[NLIGHTS];\nuniform vec3 specular[NLIGHTS]; // light*material\nuniform vec3 diffuse[NLIGHTS];\nuniform vec3 lightDir[NLIGHTS];\nuniform bool viewpoint[NLIGHTS];\nuniform bool finite[NLIGHTS];\n#endif\n#endif // IS_LIT\n\n#ifdef IS_TWOSIDED\nuniform bool front;\nvarying float normz;\n#endif\n\n#ifdef FAT_LINES\nvarying vec2 vPoint;\nvarying float vLength;\n#endif\n\n#ifdef USE_ENVMAP\nvarying vec3 vReflection;\n#endif\n\nvoid main(void) {\n  vec4 fragColor;\n#ifdef FAT_LINES\n  vec2 point = vPoint;\n  bool neg = point.y < 0.0;\n  point.y = neg ? (point.y + vLength)/(1.0 - vLength) :\n                 -(point.y - vLength)/(1.0 - vLength);\n#if defined(IS_TRANSPARENT) && defined(IS_LINESTRIP)\n  if (neg && length(point) <= 1.0) discard;\n#endif\n  point.y = min(point.y, 0.0);\n  if (length(point) > 1.0) discard;\n#endif // FAT_LINES\n  \n#ifdef ROUND_POINTS\n  vec2 coord = gl_PointCoord - vec2(0.5);\n  if (length(coord) > 0.5) discard;\n#endif\n  \n#if NCLIPPLANES > 0\n  for (int i = 0; i < NCLIPPLANES; i++)\n    if (dot(vPosition, vClipplane[i]) < 0.0) discard;\n#endif\n    \n#ifdef FIXED_QUADS\n    vec3 n = vec3(0., 0., 1.);\n#elif defined(IS_LIT)\n    vec3 n = normalize(vNormal.xyz);\n#endif\n    \n#ifdef IS_TWOSIDED\n    if ((normz <= 0.) != front) discard;\n#endif\n\n#ifdef IS_LIT\n    vec3 eye = normalize(-vPosition.xyz/vPosition.w);\n    vec3 lightdir;\n    vec4 colDiff;\n    vec3 halfVec;\n    vec4 lighteffect = vec4(emission, 0.);\n    vec3 col;\n    float nDotL;\n#ifdef FIXED_QUADS\n    n = -faceforward(n, n, eye);\n#endif\n    \n#if NLIGHTS > 0\n    for (int i=0;i<NLIGHTS;i++) {\n      colDiff = vec4(vCol.rgb * diffuse[i], vCol.a);\n      lightdir = lightDir[i];\n      if (!viewpoint[i])\n        lightdir = (mvMatrix * vec4(lightdir, 1.)).xyz;\n      if (!finite[i]) {\n        halfVec = normalize(lightdir + eye);\n      } else {\n        lightdir = normalize(lightdir - vPosition.xyz/vPosition.w);\n        halfVec = normalize(lightdir + eye);\n      }\n      col = ambient[i];\n      nDotL = dot(n, lightdir);\n      col = col + max(nDotL, 0.) * colDiff.rgb;\n      col = col + pow(max(dot(halfVec, n), 0.), shininess) * specular[i];\n      lighteffect = lighteffect + vec4(col, colDiff.a);\n    }\n#endif\n    \n#else // not IS_LIT\n    vec4 colDiff = vCol;\n    vec4 lighteffect = colDiff;\n#endif\n    \n#ifdef IS_TEXT\n    vec4 textureColor = lighteffect*texture2D(uSampler, vTexcoord);\n#endif\n    \n#ifdef HAS_TEXTURE\n\n// These calculations use the definitions from \n// https://docs.gl/gl3/glTexEnv\n\n#ifdef USE_ENVMAP\n    float m = 2.0 * sqrt(dot(vReflection, vReflection) + 2.0*vReflection.z + 1.0);\n    vec4 textureColor = texture2D(uSampler, vReflection.xy / m + vec2(0.5, 0.5));\n#else\n    vec4 textureColor = texture2D(uSampler, vTexcoord);\n#endif\n\n#ifdef TEXTURE_rgb\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(textureColor.rgb, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*vec4(textureColor.rgb, 1.);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb, lighteffect.a);\n#endif\n\n#endif //TEXTURE_rgb\n        \n#ifdef TEXTURE_rgba\n\n#ifdef TEXMODE_replace\n// already done\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = lighteffect*textureColor;\n#endif\n\n#ifdef TEXMODE_decal\n    textureColor = vec4((1. - textureColor.a)*lighteffect.rgb) +\n                     textureColor.a*textureColor.rgb, \n                     lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - textureColor.rgb) * lighteffect.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(lighteffect.rgb + textureColor.rgb,\n                    lighteffect.a*textureColor.a);\n#endif\n    \n#endif //TEXTURE_rgba\n    \n#ifdef TEXTURE_alpha\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(lighteffect.rgb, textureColor.a);\n#endif \n\n#if defined(TEXMODE_modulate) || defined(TEXMODE_blend) || defined(TEXMODE_add)\n    textureColor = vec4(lighteffect.rgb, lighteffect.a*textureColor.a);\n#endif\n \n#endif\n    \n// The TEXTURE_luminance values are not from that reference    \n#ifdef TEXTURE_luminance\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, lighteffect.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, lighteffect.a);\n#endif\n\n#endif // TEXTURE_luminance\n \n    \n#ifdef TEXTURE_luminance_alpha\n    float luminance = dot(vec3(1.,1.,1.),textureColor.rgb)/3.;\n\n#if defined(TEXMODE_replace) || defined(TEXMODE_decal)\n    textureColor = vec4(luminance, luminance, luminance, textureColor.a);\n#endif \n\n#ifdef TEXMODE_modulate\n    textureColor = vec4(luminance*lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_blend\n    textureColor = vec4((1. - luminance)*lighteffect.rgb,\n                        textureColor.a*lighteffect.a);\n#endif\n\n#ifdef TEXMODE_add\n    textureColor = vec4(luminance + lighteffect.rgb, \n                        textureColor.a*lighteffect.a);\n\n#endif\n\n#endif // TEXTURE_luminance_alpha\n    \n    fragColor = textureColor;\n\n#elif defined(IS_TEXT)\n    if (textureColor.a < 0.1)\n      discard;\n    else\n      fragColor = textureColor;\n#else\n    fragColor = lighteffect;\n#endif // HAS_TEXTURE\n    \n#ifdef HAS_FOG\n    // uFogParms elements: x = near, y = far, z = fogscale, w = (1-sin(FOV/2))/(1+sin(FOV/2))\n    // In Exp and Exp2: use density = density/far\n    // fogF will be the proportion of fog\n    // Initialize it to the linear value\n    float fogF;\n    if (uFogMode > 0) {\n      fogF = (uFogParms.y - vPosition.z/vPosition.w)/(uFogParms.y - uFogParms.x);\n      if (uFogMode > 1)\n        fogF = mix(uFogParms.w, 1.0, fogF);\n      fogF = fogF*uFogParms.z;\n      if (uFogMode == 2)\n        fogF = 1.0 - exp(-fogF);\n      // Docs are wrong: use (density*c)^2, not density*c^2\n      // https://gitlab.freedesktop.org/mesa/mesa/-/blob/master/src/mesa/swrast/s_fog.c#L58\n      else if (uFogMode == 3)\n        fogF = 1.0 - exp(-fogF*fogF);\n      fogF = clamp(fogF, 0.0, 1.0);\n      gl_FragColor = vec4(mix(fragColor.rgb, uFogColor, fogF), fragColor.a);\n    } else gl_FragColor = fragColor;\n#else\n    gl_FragColor = fragColor;\n#endif // HAS_FOG\n    \n}","players":[],"webGLoptions":{"preserveDrawingBuffer":true}},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="treespaceserver-a-web-application-for-treespace">
<code>treespaceServer</code>: a web application for
<em>treespace</em><a class="anchor" aria-label="anchor" href="#treespaceserver-a-web-application-for-treespace"></a>
</h2>
<p>The functionalities of <code>treespace</code> are also available via
a user-friendly web interface, running locally on the default web
browser. It can be started by simply typing
<code><a href="../reference/treespaceServer.html">treespaceServer()</a></code>. The interface allows you to import trees
and run <code>treespace</code> to view and explore the tree space in 2
or 3 dimensions. It is then straightforward to analyse the tree space by
varying <span class="math inline">\(\lambda\)</span>, looking for
clusters using <code>findGroves</code> and saving results in various
formats. Individual trees can be easily viewed, including median trees
per cluster (see below). Pairs of trees can be viewed together with
their tip-differences highlighted using the function
<code>plotTreeDiff</code>, and collections of trees can be seen together
using <code>densiTree</code> from the package <em>phangorn</em>. It is
fully documented in the <em>help</em> tab.</p>
</div>
<div class="section level2">
<h2 id="finding-median-trees">Finding median trees<a class="anchor" aria-label="anchor" href="#finding-median-trees"></a>
</h2>
<p>When a set of trees have very similar structures, it makes sense to
summarize them into a single ‘consensus’ tree. In
<code>treespace</code>, this is achieved by finding the <em>median
tree</em> for a set of trees according to the Kendall and Colijn metric.
That is, we find the tree which is closest to the centre of the set of
trees in the tree landscape defined in <code>treespace</code>. This
procedure is implemented by the function <code>medTree</code>:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get first median tree</span></span>
<span><span class="va">tre</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medTree.html">medTree</a></span><span class="op">(</span><span class="va">woodmiceTrees</span><span class="op">)</span><span class="op">$</span><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># plot tree</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">tre</span>,type<span class="op">=</span><span class="st">"cladogram"</span>,edge.width<span class="op">=</span><span class="fl">3</span>, cex<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/woodmiceMedian-1.png" width="672"></p>
<p>However, a more complete and accurate summary of the data can be
given by finding a summary tree from each cluster. This is achieved
using the <code>groups</code> argument of <code>medTree</code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># find median trees for the 6 clusters identified earlier:</span></span>
<span><span class="va">res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/medTree.html">medTree</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>, <span class="va">wm.groves</span><span class="op">$</span><span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># there is one output per cluster</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "1" "2" "3" "4" "5" "6"</span></span></code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get the first median of each</span></span>
<span><span class="va">med.trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span>, <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/ladderize.html" class="external-link">ladderize</a></span><span class="op">(</span><span class="va">e</span><span class="op">$</span><span class="va">trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot trees</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">)</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"cluster"</span>,<span class="va">i</span><span class="op">)</span>,cex<span class="op">=</span><span class="fl">1.5</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/woodmiceCluster1-1.png" width="600px"></p>
<p>These trees exhibit a number of topological differences, e.g. in the
placement of the <strong>(1007S,1208S,0909S)</strong> clade. To examine
the differences between the trees in a pairwise manner, we can use the
function <code>plotTreeDiff</code>, for example:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare median trees from clusters 1 and 2:</span></span>
<span><span class="fu"><a href="../reference/plotTreeDiff.html">plotTreeDiff</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">med.trees</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, use.edge.length<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>             treesFacing <span class="op">=</span> <span class="cn">TRUE</span>, colourMethod <span class="op">=</span> <span class="st">"palette"</span>, palette <span class="op">=</span> <span class="va">funky</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/woodmice_plotTreeDiff-1.png" width="672"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare median trees from clusters 1 and 4, and change aesthetics:</span></span>
<span><span class="fu"><a href="../reference/plotTreeDiff.html">plotTreeDiff</a></span><span class="op">(</span><span class="va">med.trees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">med.trees</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, use.edge.length<span class="op">=</span><span class="cn">FALSE</span>, </span>
<span>             treesFacing <span class="op">=</span> <span class="cn">TRUE</span>, edge.width<span class="op">=</span><span class="fl">2</span>, colourMethod<span class="op">=</span><span class="st">"palette"</span>, palette<span class="op">=</span><span class="va">spectral</span><span class="op">)</span></span></code></pre></div>
<p><img src="introduction_files/figure-html/woodmice_plotTreeDiff-2.png" width="672"></p>
<p>Performing this analysis enables the detection of distinct
representative trees supported by data.</p>
<p>Note that in this example we supplied the function
<code>medTree</code> with the multiPhylo list of trees. A more
computationally efficient process (at the expense of using more memory)
is to use the option <code>return.tree.vectors</code> in the initial
<code>treespace</code> call, and then supply these vectors directly to
<code>medTree</code>. In this case, the tree indices are returned by
<code>medTree</code> but the trees are not (since they were not
supplied).</p>
</div>
<div class="section level2">
<h2 id="emphasising-the-placement-of-certain-tips-or-clades">Emphasising the placement of certain tips or clades<a class="anchor" aria-label="anchor" href="#emphasising-the-placement-of-certain-tips-or-clades"></a>
</h2>
<p>In some analyses it may be informative to emphasise the placement of
particular tips or clades within a set of trees. This can be
particularly useful in large trees where the study is focused on a
smaller clade. Priority can be given to a list of tips using the
argument <code>emphasise.tips</code>, whose corresponding values in the
vector comparison will be given a weight of
<code>emphasise.weight</code> times the others (the default is 2,
i.e. twice the weight).</p>
<p>For example, if we wanted to emphasise where the woodmice trees agree
and disagree on the placement of the
<strong>(1007S,1208S,0909S)</strong> clade, we can simply emphasise that
clade as follows:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wm3.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treespace.html">treespace</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">2</span>,emphasise.tips<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No1007S"</span>,<span class="st">"No1208S"</span>,<span class="st">"No0909S"</span><span class="op">)</span>,emphasise.weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># plot results</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm3.res</span><span class="op">$</span><span class="va">pco</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-7bcd558c0caf8662370c" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-7bcd558c0caf8662370c">{"x":{"data":{"x":[-0.594073207581344,-0.520474217124273,-4.29273420692203,-31.0045463450458,-4.43479335528005,8.36252332403474,2.52302297744348,-0.507192211060358,-0.594073207581332,-0.507192211060358,-0.518144836408109,24.5535073746063,-12.6258405735551,-0.480551349713738,8.35119300406132,-0.767202711076171,-0.794647388046402,-4.31673290260613,36.0482473263572,2.3268784850388,8.34249638256188,33.7608531371047,8.61021351082144,-0.612332976228712,-0.731983542203646,12.9714308625021,-36.3316176456048,-0.731983542203646,-30.5407301168131,-30.9935937196981,-0.716542187466501,-4.36866257809523,-4.55843227190198,-31.4273984847072,19.5561987231973,-0.603620504130765,39.5571292486383,-0.289742424318367,-0.784220596013744,8.62822138901471,-0.603147523706446,-4.55990988986583,-4.28178158157426,-4.34533149930737,-0.530511460875731,-4.1471369175182,15.6227358210212,8.40343005787143,8.96791268578615,-0.786172282104231,-36.2820754435815,-4.29273420692201,-8.63758532818177,-0.518144836408109,35.4137402734384,-0.167500914288921,-0.775597351382145,-0.594073207581331,-4.3913468046768,-31.0345126770898,-31.3104572104081,-0.571163815224868,-27.0890118748448,8.56798125384036,2.59559406137029,16.5152817747333,41.2775342138679,-4.06244846227619,-4.56076165261813,-0.516355241782132,-4.33480056039102,-3.83746769406352,-0.594073207581332,37.9152143789498,-0.784293972881595,8.46918827047282,-0.155509655184713,-0.645115072026804,-4.55758050914968,-36.3881015376164,2.1489131793321,-0.613050951321483,-4.12629837765864,-0.619672323581266,-31.6429023868571,-0.594073207581332,12.9714308625021,-8.71101458114734,-0.624003576669234,-0.614573129478515,-0.480551349713738,-4.43046029429519,-0.731983542203646,-31.1944417846473,-0.372547547004299,-10.0930965005012,-0.634992164973024,-4.37099195881138,-0.74879545874732,-0.266781235022075,39.5790704622898,-3.90016322904071,-14.3761734791298,7.7149130299002,29.5850088655751,8.34924131797085,8.47451279404926,2.29694811595089,-0.785320519351925,12.9447997396773,-4.36866257809523,-36.2038176916921,12.8845498659812,8.61254289153758,-7.43265445172999,-4.54662788380193,-0.0716325279184738,-0.594073207581332,-0.603147523706445,-4.13618429217045,-0.361558958700509,-0.636491827395203,-0.592194898358697,8.5113740604498,-0.784293972881594,-4.35770995274748,-0.518144836408109,2.27345654338569,-4.50478331809157,-31.6652587090461,12.967516256608,-36.2152213885334,22.2687400193834,-0.585449962949731,-0.78384290138808,8.64390962501358,-0.594073207581333,-0.747662039680772,-0.58312058223358,8.54088932100023,-0.518144836408109,-3.9065414817612,-0.624003576669234,16.2221659585759,-0.536327371325657,-0.529548533249375,-4.39862891013917,-0.372547547004299,-3.77362549784451,19.3634668242404,-0.624003576669234,15.9254323515291,8.60816054487453,-0.785320519351926,-4.40958153548693,-0.792917217513197,-0.563770027971237,8.35111962719348,-0.58312058223358,-0.522870708537485,-0.533823333885237,-4.5675065880271,8.54134039249374,-0.59983594954683,-8.63275682925797,-4.39156585759196,2.43648573701222,8.34690811737008,-0.786172282104231,-31.5350380598431,8.54134039249374,-0.772890276040329,29.5850088655751,2.33783111038655,-4.26695266256198,-4.42986207476841,-4.36866257809523,21.223829695481,12.9714308625021,16.5152817747332,-4.36866257809523,-0.58544996294973,-8.62180420391022,-0.266817197978116,3.24256321764543,2.29694811595089,-31.2875478180517,-0.522258528810864,12.9823932263716,-0.520474217124261,-0.511106816954525,-0.573493195941021,-4.35770995274748,-0.51814483640811,-0.703270518606352,8.50042143510205,-28.1148433430924,39.5790704622899,16.9396901303175,-4.55758050914968,-4.46179622178293],"y":[-1.72911765565166,-1.41880545767786,7.46976853091071,-9.64971835940001,7.24748083780663,12.786993228693,-26.7577795915697,-1.37152288046733,-1.72911765565166,-1.37152288046733,-1.42132647267178,9.21594919886199,-9.4256252401974,-1.38544839851517,12.3571155847349,0.216748688922747,0.234207859015643,7.53384797280857,-13.5341580762267,-5.61567022544702,12.7386235988224,-12.6714780374248,12.2733478194283,-1.5707409822477,-1.43261115658472,-6.94686176812822,1.84051739066511,-1.43261115658473,-12.4248208095063,-9.59991476719557,1.48570841557827,7.16197734793081,7.88006833010211,-11.060572257318,-19.0273050910954,-1.45423563224369,-11.1294949871588,-0.08943029366876,-1.39110072523403,12.3766934295016,-1.72768369331779,7.49522806223245,7.51957212311513,8.93440235796825,-1.0871902913294,7.82123784134429,-24.5812336577776,12.3156051533842,14.3732746356485,-1.00850565848639,0.987766590385381,7.46976853091069,-16.1694682201147,-1.42132647267178,-4.81698292506776,0.625058325679565,-1.33877611803562,-1.72911765565166,7.44146533562554,-8.69483935971744,-11.8063119162972,-1.707528640786,-16.8494491460317,12.0051731362694,-4.80110337323161,-0.624899871647588,-10.4956481011375,8.48281732685399,7.88258934509607,-1.40129114283317,7.23336995500091,9.44242626503209,-1.72911765565166,-13.289400856053,-0.95726810394808,13.9618195831139,0.0686278026590046,-0.328443033818441,7.49270704723849,2.30810597794257,-5.23513693393488,-0.697344144629337,8.65352608267998,-0.260383048023944,-11.1217229223389,-1.72911765565166,-6.94686176812822,-16.3154109480922,-0.747147736833783,-1.50403922444814,-1.38544839851517,5.56605474099131,-1.43261115658473,-11.7932483980031,-1.06985716223818,-5.51264866125334,-0.824042248173541,7.16449836292476,-0.0159235635684229,-0.298284676593001,-11.0027968836146,9.90076553041406,14.0269588702326,-8.88756732944367,-7.01650971395467,12.7397106514825,13.4804233162466,-4.63370030662914,-1.39586694135001,-7.10253198539991,7.16197734793081,1.29303675837131,-7.30445654331254,12.2708268044343,5.73882016922194,7.54251063944294,0.337872187141206,-1.72911765565166,-1.72768369331779,7.87104143354873,-0.992962650898425,-0.276118426620035,-1.67788010111335,12.9739776539998,-0.957268103948079,7.21178094013525,-1.42132647267178,-5.38431698439451,7.47851917683634,-11.1675715372155,-7.02532024355504,1.29699173569914,-17.7086574753799,-1.67679304845325,-1.01102667348035,12.3129643192493,-1.72911765565166,-1.53847778165197,-1.67931406344721,12.0728572238495,-1.42132647267178,12.9030318431475,-0.747147736833783,-1.58305630373169,-0.955221886665792,-1.41737149534395,8.11685634761337,-1.06985716223818,5.78377185997549,-13.7162382805173,-0.747147736833783,-10.7773272353263,12.7915604609692,-1.39586694135001,8.06705275540892,-1.00959271114648,-1.64791680247765,12.7909482060208,-1.67931406344721,-1.47738950553458,-1.52719309773903,7.88150229243598,12.0190986543172,-1.73170547574518,-16.0101407801063,7.34414334133916,-5.35045944373734,12.3058214933052,-1.00850565848639,-11.2151045183192,12.0190986543172,-0.961223081275907,-7.01650971395468,-5.56586663324257,7.5475950823008,9.15450186893188,7.1619773479308,-13.5787816477448,-6.94686176812822,-0.624899871647573,7.1619773479308,-1.67679304845325,-15.9603371879018,-0.32537559572831,19.8839779384189,-4.63370030662914,-11.7847229014315,-0.0304593223040423,-7.0666539112433,-1.41880545767782,-1.44998135589415,-1.70500762579204,7.21178094013525,-1.42132647267178,-0.943760026490077,12.9241740617954,-13.4549187688844,-11.0027968836146,24.8972253746784,7.49270704723849,8.96487176674167],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":null,"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":false,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":false,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-UGWMIZTM","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>It can be seen from the scale of the plot and the density of
clustering that the trees are now separated into more distinct
clusters.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wm3.groves</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/findGroves.html">findGroves</a></span><span class="op">(</span><span class="va">woodmiceTrees</span>,nf<span class="op">=</span><span class="fl">3</span>,nclust<span class="op">=</span><span class="fl">6</span>,emphasise.tips<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"No1007S"</span>,<span class="st">"No1208S"</span>,<span class="st">"No0909S"</span><span class="op">)</span>,emphasise.weight<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/plotGrovesD3.html">plotGrovesD3</a></span><span class="op">(</span><span class="va">wm3.groves</span><span class="op">)</span></span></code></pre></div>
<div class="scatterD3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-56875cfd0b12ad299417" style="width:672px;height:672px;"></div>
<script type="application/json" data-for="htmlwidget-56875cfd0b12ad299417">{"x":{"data":{"x":[-0.594073207581344,-0.520474217124273,-4.29273420692203,-31.0045463450458,-4.43479335528005,8.36252332403474,2.52302297744348,-0.507192211060358,-0.594073207581332,-0.507192211060358,-0.518144836408109,24.5535073746063,-12.6258405735551,-0.480551349713738,8.35119300406132,-0.767202711076171,-0.794647388046402,-4.31673290260613,36.0482473263572,2.3268784850388,8.34249638256188,33.7608531371047,8.61021351082144,-0.612332976228712,-0.731983542203646,12.9714308625021,-36.3316176456048,-0.731983542203646,-30.5407301168131,-30.9935937196981,-0.716542187466501,-4.36866257809523,-4.55843227190198,-31.4273984847072,19.5561987231973,-0.603620504130765,39.5571292486383,-0.289742424318367,-0.784220596013744,8.62822138901471,-0.603147523706446,-4.55990988986583,-4.28178158157426,-4.34533149930737,-0.530511460875731,-4.1471369175182,15.6227358210212,8.40343005787143,8.96791268578615,-0.786172282104231,-36.2820754435815,-4.29273420692201,-8.63758532818177,-0.518144836408109,35.4137402734384,-0.167500914288921,-0.775597351382145,-0.594073207581331,-4.3913468046768,-31.0345126770898,-31.3104572104081,-0.571163815224868,-27.0890118748448,8.56798125384036,2.59559406137029,16.5152817747333,41.2775342138679,-4.06244846227619,-4.56076165261813,-0.516355241782132,-4.33480056039102,-3.83746769406352,-0.594073207581332,37.9152143789498,-0.784293972881595,8.46918827047282,-0.155509655184713,-0.645115072026804,-4.55758050914968,-36.3881015376164,2.1489131793321,-0.613050951321483,-4.12629837765864,-0.619672323581266,-31.6429023868571,-0.594073207581332,12.9714308625021,-8.71101458114734,-0.624003576669234,-0.614573129478515,-0.480551349713738,-4.43046029429519,-0.731983542203646,-31.1944417846473,-0.372547547004299,-10.0930965005012,-0.634992164973024,-4.37099195881138,-0.74879545874732,-0.266781235022075,39.5790704622898,-3.90016322904071,-14.3761734791298,7.7149130299002,29.5850088655751,8.34924131797085,8.47451279404926,2.29694811595089,-0.785320519351925,12.9447997396773,-4.36866257809523,-36.2038176916921,12.8845498659812,8.61254289153758,-7.43265445172999,-4.54662788380193,-0.0716325279184738,-0.594073207581332,-0.603147523706445,-4.13618429217045,-0.361558958700509,-0.636491827395203,-0.592194898358697,8.5113740604498,-0.784293972881594,-4.35770995274748,-0.518144836408109,2.27345654338569,-4.50478331809157,-31.6652587090461,12.967516256608,-36.2152213885334,22.2687400193834,-0.585449962949731,-0.78384290138808,8.64390962501358,-0.594073207581333,-0.747662039680772,-0.58312058223358,8.54088932100023,-0.518144836408109,-3.9065414817612,-0.624003576669234,16.2221659585759,-0.536327371325657,-0.529548533249375,-4.39862891013917,-0.372547547004299,-3.77362549784451,19.3634668242404,-0.624003576669234,15.9254323515291,8.60816054487453,-0.785320519351926,-4.40958153548693,-0.792917217513197,-0.563770027971237,8.35111962719348,-0.58312058223358,-0.522870708537485,-0.533823333885237,-4.5675065880271,8.54134039249374,-0.59983594954683,-8.63275682925797,-4.39156585759196,2.43648573701222,8.34690811737008,-0.786172282104231,-31.5350380598431,8.54134039249374,-0.772890276040329,29.5850088655751,2.33783111038655,-4.26695266256198,-4.42986207476841,-4.36866257809523,21.223829695481,12.9714308625021,16.5152817747332,-4.36866257809523,-0.58544996294973,-8.62180420391022,-0.266817197978116,3.24256321764543,2.29694811595089,-31.2875478180517,-0.522258528810864,12.9823932263716,-0.520474217124261,-0.511106816954525,-0.573493195941021,-4.35770995274748,-0.51814483640811,-0.703270518606352,8.50042143510205,-28.1148433430924,39.5790704622899,16.9396901303175,-4.55758050914968,-4.46179622178293],"y":[-1.72911765565166,-1.41880545767786,7.46976853091071,-9.64971835940001,7.24748083780663,12.786993228693,-26.7577795915697,-1.37152288046733,-1.72911765565166,-1.37152288046733,-1.42132647267178,9.21594919886199,-9.4256252401974,-1.38544839851517,12.3571155847349,0.216748688922747,0.234207859015643,7.53384797280857,-13.5341580762267,-5.61567022544702,12.7386235988224,-12.6714780374248,12.2733478194283,-1.5707409822477,-1.43261115658472,-6.94686176812822,1.84051739066511,-1.43261115658473,-12.4248208095063,-9.59991476719557,1.48570841557827,7.16197734793081,7.88006833010211,-11.060572257318,-19.0273050910954,-1.45423563224369,-11.1294949871588,-0.08943029366876,-1.39110072523403,12.3766934295016,-1.72768369331779,7.49522806223245,7.51957212311513,8.93440235796825,-1.0871902913294,7.82123784134429,-24.5812336577776,12.3156051533842,14.3732746356485,-1.00850565848639,0.987766590385381,7.46976853091069,-16.1694682201147,-1.42132647267178,-4.81698292506776,0.625058325679565,-1.33877611803562,-1.72911765565166,7.44146533562554,-8.69483935971744,-11.8063119162972,-1.707528640786,-16.8494491460317,12.0051731362694,-4.80110337323161,-0.624899871647588,-10.4956481011375,8.48281732685399,7.88258934509607,-1.40129114283317,7.23336995500091,9.44242626503209,-1.72911765565166,-13.289400856053,-0.95726810394808,13.9618195831139,0.0686278026590046,-0.328443033818441,7.49270704723849,2.30810597794257,-5.23513693393488,-0.697344144629337,8.65352608267998,-0.260383048023944,-11.1217229223389,-1.72911765565166,-6.94686176812822,-16.3154109480922,-0.747147736833783,-1.50403922444814,-1.38544839851517,5.56605474099131,-1.43261115658473,-11.7932483980031,-1.06985716223818,-5.51264866125334,-0.824042248173541,7.16449836292476,-0.0159235635684229,-0.298284676593001,-11.0027968836146,9.90076553041406,14.0269588702326,-8.88756732944367,-7.01650971395467,12.7397106514825,13.4804233162466,-4.63370030662914,-1.39586694135001,-7.10253198539991,7.16197734793081,1.29303675837131,-7.30445654331254,12.2708268044343,5.73882016922194,7.54251063944294,0.337872187141206,-1.72911765565166,-1.72768369331779,7.87104143354873,-0.992962650898425,-0.276118426620035,-1.67788010111335,12.9739776539998,-0.957268103948079,7.21178094013525,-1.42132647267178,-5.38431698439451,7.47851917683634,-11.1675715372155,-7.02532024355504,1.29699173569914,-17.7086574753799,-1.67679304845325,-1.01102667348035,12.3129643192493,-1.72911765565166,-1.53847778165197,-1.67931406344721,12.0728572238495,-1.42132647267178,12.9030318431475,-0.747147736833783,-1.58305630373169,-0.955221886665792,-1.41737149534395,8.11685634761337,-1.06985716223818,5.78377185997549,-13.7162382805173,-0.747147736833783,-10.7773272353263,12.7915604609692,-1.39586694135001,8.06705275540892,-1.00959271114648,-1.64791680247765,12.7909482060208,-1.67931406344721,-1.47738950553458,-1.52719309773903,7.88150229243598,12.0190986543172,-1.73170547574518,-16.0101407801063,7.34414334133916,-5.35045944373734,12.3058214933052,-1.00850565848639,-11.2151045183192,12.0190986543172,-0.961223081275907,-7.01650971395468,-5.56586663324257,7.5475950823008,9.15450186893188,7.1619773479308,-13.5787816477448,-6.94686176812822,-0.624899871647573,7.1619773479308,-1.67679304845325,-15.9603371879018,-0.32537559572831,19.8839779384189,-4.63370030662914,-11.7847229014315,-0.0304593223040423,-7.0666539112433,-1.41880545767782,-1.44998135589415,-1.70500762579204,7.21178094013525,-1.42132647267178,-0.943760026490077,12.9241740617954,-13.4549187688844,-11.0027968836146,24.8972253746784,7.49270704723849,8.96487176674167],"col_var":["1","1","2","3","2","4","1","1","1","1","1","5","1","1","4","1","1","2","6","1","4","6","4","1","1","5","3","1","3","3","1","2","2","3","5","1","6","1","1","4","1","2","2","2","1","2","5","4","4","1","3","2","1","1","6","1","1","1","2","3","3","1","3","4","1","5","6","2","2","1","2","2","1","6","1","4","1","1","2","3","1","1","2","1","3","1","5","1","1","1","1","2","1","3","1","1","1","2","1","1","6","2","4","1","6","4","4","1","1","5","2","3","5","4","4","2","1","1","1","2","1","1","1","4","1","2","1","1","2","3","5","3","5","1","1","4","1","1","1","4","1","4","1","5","1","1","2","1","2","5","1","5","4","1","2","1","1","4","1","1","1","2","4","1","1","2","1","4","1","3","4","1","6","1","2","2","2","5","5","5","2","1","1","1","4","1","3","1","5","1","1","1","2","1","1","4","3","6","4","2","2"],"key_var":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201]},"settings":{"x_log":false,"y_log":false,"labels_size":10,"labels_positions":null,"point_size":64,"point_opacity":1,"opacities":null,"hover_size":1,"hover_opacity":null,"xlab":"Axis 1","ylab":"Axis 2","has_labels":false,"col_lab":"groups","col_continuous":false,"col_levels":["1","2","3","4","5","6"],"colors":null,"ellipses":false,"ellipses_data":[],"symbol_lab":"symbol_var","symbol_levels":null,"symbols":null,"size_range":[10,300],"size_lab":"NULL","sizes":null,"opacity_lab":"NULL","opacities.1":null,"unit_circle":false,"has_color_var":true,"has_symbol_var":false,"has_size_var":false,"has_opacity_var":false,"has_url_var":false,"has_legend":true,"has_tooltips":true,"tooltip_text":null,"tooltip_position_x":"right","tooltip_position_y":"bottom","has_custom_tooltips":false,"click_callback":null,"init_callback":null,"zoom_callback":null,"zoom_on":null,"zoom_on_level":null,"disable_wheel":false,"fixed":false,"legend_width":150,"left_margin":30,"html_id":"scatterD3-GJHTLRGH","xlim":null,"ylim":null,"x_categorical":false,"y_categorical":false,"x_levels":null,"y_levels":null,"menu":true,"lasso":false,"lasso_callback":null,"dom_id_reset_zoom":"scatterD3-reset-zoom","dom_id_svg_export":"scatterD3-svg-export","dom_id_lasso_toggle":"scatterD3-lasso-toggle","transitions":false,"axes_font_size":"100%","legend_font_size":"100%","caption":null,"lines":{"slope":[0,null],"intercept":[0,0],"stroke_dasharray":[5,5]},"hashes":[]}},"evals":[],"jsHooks":[]}</script><p>Conversely, where the structure of a particular clade is not of
interest (for example, lineages within an outgroup which was only
included for rooting purposes), those tips can be given a weight less
than 1 so as to give them less emphasis in the comparison. We note that
although it is possible to give tips a weighting of 0, we advise caution
with this as the underlying function will no longer be guaranteed to be
a metric. That is, a distance of 0 between two trees will no longer
necessarily imply that the trees are identical. In most cases it would
be wiser to assign a very small weighting to tips which are not of
interest.</p>
</div>
<div class="section level2">
<h2 id="method-characterising-a-tree-by-a-vector">Method: characterising a tree by a vector<a class="anchor" aria-label="anchor" href="#method-characterising-a-tree-by-a-vector"></a>
</h2>
<p>Kendall and Colijn proposed a <a href="http://dx.doi.org/10.1093/molbev/msw124" class="external-link">metric</a> for comparing
rooted phylogenetic trees (Kendall and Colijn, 2016). Each tree is
characterised by a vector which notes the placement of the most recent
common ancestor (MRCA) of each pair of tips, as demonstrated in this
example:</p>
<p><img src="construction.png" width="2056"></p>
<p>Specifically, it records the distance between the MRCA of a pair of
tips <span class="math inline">\((i,j)\)</span> and the root in two
ways: the number of edges <span class="math inline">\(m_{i,j}\)</span>,
and the path length <span class="math inline">\(M_{i,j}\)</span>. It
also records the length <span class="math inline">\(p_i\)</span> of each
‘pendant’ edge between a tip <span class="math inline">\(i\)</span> and
its immediate ancestor. This procedure results in two vectors for a tree
<span class="math inline">\(T\)</span>:</p>
<p><span class="math display">\[
m(T) = (m_{1,2}, m_{1,3},...,m_{k-1,k},1,...,1)
\]</span></p>
<p>and</p>
<p><span class="math display">\[
M(T) = (M_{1,2}, M_{1,3},...,M_{k-1,k},p_1,...,p_k).
\]</span></p>
<p>In <span class="math inline">\(m(T)\)</span> we record the pendant
lengths as 1, as each tip is 1 step from its immediate ancestor. We
combine <span class="math inline">\(m\)</span> and <span class="math inline">\(M\)</span> with a parameter <span class="math inline">\(\lambda\)</span> between zero and one to weight
the contribution of branch lengths, characterising each tree with a
vector</p>
<p><span class="math display">\[
v_\lambda(T) = (1-\lambda)m(T) + \lambda M(T).
\]</span></p>
<p>This is implemented as the function
<strong><code>treeVec</code></strong>. For example,</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate a random tree:</span></span>
<span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="co"># topological vector of mrca distances from root:</span></span>
<span><span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 2 2 0 1 3 3 0 1 2 0 1 2 0 0 1 1 1 1 1 1 1</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of mrca distances from root when lambda=0.5:</span></span>
<span><span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span>,<span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 1.2173 1.2173 0.0000 0.6927 2.2131 1.8866 0.0000 0.6927 1.2173 0.0000</span></span>
<span><span class="co">## [11] 0.6927 1.2173 0.0000 0.0000 0.6927 0.5232 0.7638 0.6800 0.8382 0.6090</span></span>
<span><span class="co">## [21] 0.5360</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># vector of mrca distances as a function of lambda:</span></span>
<span><span class="va">vecAsFunction</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/treeVec.html">treeVec</a></span><span class="op">(</span><span class="va">tree</span>,return.lambda.function<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co"># evaluate the vector at lambda=0.5:</span></span>
<span><span class="fu">vecAsFunction</span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] 1.2173 1.2173 0.0000 0.6927 2.2131 1.8866 0.0000 0.6927 1.2173 0.0000</span></span>
<span><span class="co">## [11] 0.6927 1.2173 0.0000 0.0000 0.6927 0.5232 0.7638 0.6800 0.8382 0.6090</span></span>
<span><span class="co">## [21] 0.5360</span></span></code></pre>
<p>The metric – the distance between two trees – is the Euclidean
distance between these vectors:</p>
<p><span class="math display">\[
d_\lambda(T_a, T_b) = || v_\lambda(T_a) - v_\lambda(T_b) ||.
\]</span></p>
<p>This can be found using <strong><code>treeDist</code></strong>:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># generate random trees</span></span>
<span><span class="va">tree_a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span><span class="va">tree_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ape/man/rtree.html" class="external-link">rtree</a></span><span class="op">(</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># topological (lambda=0) distance:</span></span>
<span><span class="fu"><a href="../reference/treeDist.html">treeDist</a></span><span class="op">(</span><span class="va">tree_a</span>,<span class="va">tree_b</span><span class="op">)</span> </span></code></pre></div>
<pre><code><span><span class="co">## [1] 4.123</span></span></code></pre>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># branch-length focused (lambda=1) distance:</span></span>
<span><span class="fu"><a href="../reference/treeDist.html">treeDist</a></span><span class="op">(</span><span class="va">tree_a</span>,<span class="va">tree_b</span>,<span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2.873</span></span></code></pre>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ul>
<li><p>Dray, S. and Dufour, A. B. (2007) The ade4 package: implementing
the duality diagram for ecologists. Journal of Statistical Software
22(4): 1-20.</p></li>
<li><p>Drummond, A. J. and Rambaut, A. (2007) BEAST: Bayesian
evolutionary analysis by sampling trees. BMC Evolutionary Biology, 7(1),
214.</p></li>
<li><p>Jombart, T., Balloux, F. and Dray, S. (2010) adephylo: new tools
for investigating the phylogenetic signal in biological traits.
Bioinformatics 26: 1907-1909. DOI:
10.1093/bioinformatics/btq292</p></li>
<li><p>Kendall, M. and Colijn, C. (2016) Mapping phylogenetic trees to
reveal distinct patterns of evolution. Molecular Biology and Evolution,
first published online: June 24, 2016. DOI:
10.1093/molbev/msw124</p></li>
<li><p>Lanciotti, R. S., Gubler, D. J. and Trent, D. W. (1997) Molecular
evolution and phylogeny of dengue-4 viruses. Journal of General
Virology, 78(9), 2279-2286.</p></li>
<li><p>Schliep, K. P. (2011) phangorn: phylogenetic analysis in R.
Bioinformatics 27(4): 592-593.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="authors-contributors">Authors / Contributors<a class="anchor" aria-label="anchor" href="#authors-contributors"></a>
</h2>
<p>Authors:</p>
<ul>
<li><p><a href="https://thibautjombart.netlify.app/" class="external-link">Thibaut
Jombart</a></p></li>
<li><p><a href="https://michellekendall.github.io/" class="external-link">Michelle
Kendall</a></p></li>
</ul>
<p>Contributors:</p>
<ul>
<li><p><a href="http://biotop.co/people/jacob-almagro/" class="external-link">Jacob
Almagro-Garcia</a></p></li>
<li><p><a href="https://www.sfu.ca/math/people/faculty/ccolijn/" class="external-link">Caroline
Colijn</a></p></li>
</ul>
<p>Maintainer of the CRAN version:</p>
<ul>
<li><a href="https://michellekendall.github.io/" class="external-link">Michelle
Kendall</a></li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Thibaut Jombart, Michelle Kendall, Jacob Almagro-Garcia, Caroline Colijn.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
