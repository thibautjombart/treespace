<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing trees by tip label categories • treespace</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Comparing trees by tip label categories">
<meta property="og:description" content="treespace">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treespace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/DengueVignette.html">treespace worked example: Dengue trees</a>
    </li>
    <li>
      <a href="../articles/TransmissionTreesVignette.html">treespace worked example: Transmission trees</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Exploration of landscapes of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/tipCategories.html">Comparing trees by tip label categories</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/thibautjombart/treespace/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="tipCategories_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="tipCategories_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="tipCategories_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Comparing trees by tip label categories</h1>
                        <h4 class="author">Michelle Kendall</h4>
            
            <h4 class="date">2020-11-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thibautjombart/treespace/blob/master/vignettes/tipCategories.Rmd"><code>vignettes/tipCategories.Rmd</code></a></small>
      <div class="hidden name"><code>tipCategories.Rmd</code></div>

    </div>

    
    
<p>We introduce distance measures between trees with ‘related’ tip labels in a recent bioRxiv preprint, <a href="https://doi.org/10.1101/251710"><em>Comparing phylogenetic trees according to tip label categories</em></a>. Here we provide an overview of the measures and present some simple examples.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load treespace and packages for plotting:</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://cran.r-project.org/package=treespace">treespace</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">RColorBrewer</span><span class="op">)</span> 
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/reshape">reshape2</a></span><span class="op">)</span>
<span class="co"># set colour scheme</span>
<span class="va">pal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">3</span>,<span class="st">"Dark2"</span><span class="op">)</span></code></pre></div>
<p>Suppose you have a tree with taxa labels which correspond to some broad “categories” and you want to compare it to other tree(s) whose taxa also correspond to those categories. If the tip labels of the trees do not match exactly then the other metrics supplied in <code>treespace</code> cannot be applied. The function <code>relatedTreeDist</code> is a version of <code>treeDist</code> (the Kendall Colijn metric) which compares tip labels at their category levels, and <code>treeConcordance</code> is a measure of how “concordant” a tree is to a reference tree linking the categories, as we shall explain below.</p>
<p>Some examples of instances where we may wish to compare trees with such labels:</p>
<table class="table">
<thead><tr class="header">
<th align="center">Categories</th>
<th align="center">Individuals</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Bacterial sub-types e.g. serogroups</td>
<td align="center">Bacterial isolates</td>
</tr>
<tr class="even">
<td align="center">Species</td>
<td align="center">Orthologous genes</td>
</tr>
<tr class="odd">
<td align="center">Host</td>
<td align="center">Deep sequencing reads of pathogen</td>
</tr>
<tr class="even">
<td align="center">Protein families</td>
<td align="center">Proteins</td>
</tr>
<tr class="odd">
<td align="center">Population groups</td>
<td align="center">Individual organisms</td>
</tr>
<tr class="even">
<td align="center">Disjoint features or phenotypes</td>
<td align="center">Individual organisms</td>
</tr>
<tr class="odd">
<td align="center">Broad taxonomy</td>
<td align="center">Individual organisms</td>
</tr>
</tbody>
</table>
<div id="related-tree-distance" class="section level2">
<h2 class="hasAnchor">
<a href="#related-tree-distance" class="anchor"></a>Related tree distance</h2>
<p>We begin by demonstrating the measure between trees with related tip sets, <code>relatedTreeDist</code>. As an example, suppose we have trees created from deep-sequencing reads from patients A, B and C as follows:</p>
<p><img src="tipCategories_files/figure-html/plot_patient_trees-1.png" width="672"></p>
<p>We can think of “collapsing” these trees down to one tip per monophyletic clade of tips from the same category, and renaming the new tips with just the category labels. For example, the trees above would collapse into these, respectively:</p>
<p><img src="tipCategories_files/figure-html/plot_collapsed_trees-1.png" width="672"></p>
<p>We calculate the distance between the original trees using <code>relatedTreeDist</code> as follows. The function requires a data frame telling it which individuals belong to which categories:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Patient A"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Patient B"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"Patient C"</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,
            <span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">tr1</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span>
<span class="va">df</span></code></pre></div>
<pre><code>##       [,1]        [,2]              
##  [1,] "Patient A" "Patient A read 1"
##  [2,] "Patient A" "Patient A read 2"
##  [3,] "Patient A" "Patient A read 3"
##  [4,] "Patient B" "Patient B read 1"
##  [5,] "Patient B" "Patient B read 2"
##  [6,] "Patient B" "Patient B read 3"
##  [7,] "Patient C" "Patient C read 1"
##  [8,] "Patient C" "Patient C read 2"
##  [9,] "Patient C" "Patient C read 3"
## [10,] "Patient C" "Patient C read 4"</code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/relatedTreeDist.html">relatedTreeDist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">tr1</span>,<span class="va">tr2</span><span class="op">)</span>,<span class="va">df</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<pre><code>## [1] 0.7071</code></pre>
<p>The function <code>relatedTreeDist</code> can take a list of many trees as input, and it produces a distance matrix giving the distances between each pair of trees. Since we only supplied two trees, we just returned the first (only) element of this matrix.</p>
<p>We now explain how this value is calculated. We find the <em>mean</em> height of the most recent common ancestor (MRCA) of each pair of categories in the <strong>collapsed</strong> trees. That is, we effectively find all the pairwise depths of MRCAs:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tipsMRCAdepths.html">tipsMRCAdepths</a></span><span class="op">(</span><span class="va">tr1Collapsed</span><span class="op">)</span></code></pre></div>
<pre><code>##      tip1        tip2        rootdist
## [1,] "Patient A" "Patient B" "1"     
## [2,] "Patient A" "Patient C" "0"     
## [3,] "Patient B" "Patient C" "0"</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/tipsMRCAdepths.html">tipsMRCAdepths</a></span><span class="op">(</span><span class="va">tr2Collapsed</span><span class="op">)</span></code></pre></div>
<pre><code>##      tip1        tip2        rootdist
## [1,] "Patient A" "Patient B" "0"     
## [2,] "Patient A" "Patient B" "1"     
## [3,] "Patient A" "Patient C" "0"     
## [4,] "Patient B" "Patient B" "0"     
## [5,] "Patient B" "Patient C" "1"     
## [6,] "Patient B" "Patient C" "0"</code></pre>
<p>then reduce these down to an average depth per pair of (different category) tips, per tree:</p>
<pre><code>##      tip1        tip2        Tree 1 Tree 2
## [1,] "Patient A" "Patient B" "1"    "0.5" 
## [2,] "Patient A" "Patient C" "0"    "0"   
## [3,] "Patient B" "Patient C" "0"    "0.5"</code></pre>
<p>and then we take the Euclidean distances between the final two columns:</p>
<p><span class="math display">\[
d(T_1,T_2) = \sqrt{ (1-0.5)^2 + (0-0)^2 + (0-0.5)^2 } = 0.7071068
\]</span></p>
<p>We now give a larger example with more trees. Along the way we use the function <code>simulateIndTree</code> which takes a “category-level” tree and randomly adds individuals to make an example individuals tree.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/warning.html">suppressWarnings</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">RNGversion</a></span><span class="op">(</span><span class="st">"3.5.0"</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">948</span><span class="op">)</span>
<span class="co"># set colour scheme</span>
<span class="va">pal2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/RColorBrewer/man/ColorBrewer.html">brewer.pal</a></span><span class="op">(</span><span class="fl">8</span>,<span class="st">"Dark2"</span><span class="op">)</span>

<span class="co"># create a "base" (category-level) tree</span>
<span class="va">baseTree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fl">8</span><span class="op">)</span>
<span class="va">baseTree</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="va">letters</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span>

<span class="va">tree1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">3</span>, permuteTips<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tree2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">4</span>, permuteTips<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tree2</span><span class="op">$</span><span class="va">tip.label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"h_"</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"g_"</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"f_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">7</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span>,
                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"e_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"d_"</span>,<span class="fl">3</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"c_"</span>,<span class="fl">5</span><span class="op">:</span><span class="fl">8</span><span class="op">)</span>,
                     <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"b_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">5</span>,<span class="fl">6</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"a_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">8</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">4</span>, tipPercent <span class="op">=</span> <span class="fl">20</span><span class="op">)</span>
<span class="va">tree3NotForPlotting</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">4</span>, permuteTips<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="co"># just for setting colours later </span>
<span class="va">tree4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">6</span><span class="op">)</span>
<span class="va">tree4NotForPlotting</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree</span>, itips<span class="op">=</span><span class="fl">6</span>, permuteTips<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>

<span class="co"># create another base tree</span>
<span class="va">baseTree2</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="fl">8</span>, tip.label<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">8</span><span class="op">:</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>
<span class="va">tree5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree2</span>, itips<span class="op">=</span><span class="fl">6</span>, permuteTips<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="va">tree6</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">baseTree2</span>, itips<span class="op">=</span><span class="fl">6</span>, tipPercent<span class="op">=</span><span class="fl">30</span><span class="op">)</span>

<span class="co"># set up colour palettes</span>
<span class="va">tipcolors3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="va">tipcolors4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># colours for 4 tips</span>
<span class="va">tipcolors6</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">6</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal2</span><span class="op">[[</span><span class="fl">8</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span> <span class="co"># colours for 6 tips</span>

<span class="co"># prepare tip colours for plotting</span>
<span class="va">tree3TipOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tree3</span><span class="op">$</span><span class="va">tip.label</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tree3NotForPlotting</span><span class="op">$</span><span class="va">tip.label</span><span class="op">==</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree4TipOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tree4</span><span class="op">$</span><span class="va">tip.label</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tree4NotForPlotting</span><span class="op">$</span><span class="va">tip.label</span><span class="op">==</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree5TipOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tree5</span><span class="op">$</span><span class="va">tip.label</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tree4NotForPlotting</span><span class="op">$</span><span class="va">tip.label</span><span class="op">==</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>
<span class="va">tree6TipOrder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">tree6</span><span class="op">$</span><span class="va">tip.label</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html">which</a></span><span class="op">(</span><span class="va">tree4NotForPlotting</span><span class="op">$</span><span class="va">tip.label</span><span class="op">==</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">4</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">6</span><span class="op">)</span>, <span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree1</span>, tip.color<span class="op">=</span><span class="va">tipcolors3</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree2</span>, tip.color<span class="op">=</span><span class="va">tipcolors4</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree3</span>, tip.color<span class="op">=</span><span class="va">tipcolors4</span><span class="op">[</span><span class="va">tree3TipOrder</span><span class="op">]</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.8</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree4</span>, tip.color<span class="op">=</span><span class="va">tipcolors6</span><span class="op">[</span><span class="va">tree4TipOrder</span><span class="op">]</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree5</span>, tip.color<span class="op">=</span><span class="va">tipcolors6</span><span class="op">[</span><span class="va">tree5TipOrder</span><span class="op">]</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">tree6</span>, tip.color<span class="op">=</span><span class="va">tipcolors6</span><span class="op">[</span><span class="va">tree6TipOrder</span><span class="op">]</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, use.edge.length <span class="op">=</span> <span class="cn">FALSE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">1.2</span><span class="op">)</span></code></pre></div>
<p><img src="tipCategories_files/figure-html/six_comparable_trees-1.png" width="672"></p>
<p>We have created a variety of trees. Trees 1 and 2 have differing numbers of tips, and differing tip labels, but their collapsed forms would be identical. Tree 3 is similar to Trees 1 and 2 but with a few tips permuted, so that the categories are no longer monophyletic. Tree 4 is similar but with more tips permuted. Trees 5 and 6 were created from a different “base” tree so the relationships between the categories are quite different when we compare, for example, Tree 1 and Tree 5.</p>
<p>The function <code>relatedTreeDist</code> gives a quantitative description of these similarities and differences. First we just put the trees into a list and create a data frame linking individuals to categories:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">trees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">tree1</span>,<span class="va">tree2</span>,<span class="va">tree3</span>,<span class="va">tree4</span>,<span class="va">tree5</span>,<span class="va">tree6</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,<span class="fl">9</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span>,<span class="st">"_"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span>,<span class="fl">8</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>

<span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/relatedTreeDist.html">relatedTreeDist</a></span><span class="op">(</span><span class="va">trees</span>,<span class="va">df</span><span class="op">)</span>
<span class="va">dists</span></code></pre></div>
<pre><code>##       1     2     3     4     5
## 2 0.000                        
## 3 2.131 2.131                  
## 4 5.322 5.322 5.210            
## 5 7.141 7.141 6.886 6.615      
## 6 6.195 6.195 5.939 4.700 2.437</code></pre>
<p>We can visualise these distances with a heatmap:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">dists</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">dists</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span><span class="op">(</span><span class="va">dists</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Tree 1"</span>, <span class="st">"Tree 2"</span>, <span class="st">"Tree 3"</span>, <span class="st">"Tree 4"</span>,
                                        <span class="st">"Tree 5"</span>, <span class="st">"Tree 6"</span><span class="op">)</span>

<span class="va">melted_dists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/reshape2/man/melt.html">melt</a></span><span class="op">(</span><span class="va">dists</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>

<span class="va">ggheatmap</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">melted_dists</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Var2</span>, <span class="va">Var1</span>, fill <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"darkgrey"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradient2</a></span><span class="op">(</span>low <span class="op">=</span> <span class="st">"white"</span>, high <span class="op">=</span> <span class="st">"firebrick2"</span>,
                       name<span class="op">=</span><span class="st">"Tree distance"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_fixed</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">ggheatmap</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_text.html">geom_text</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span><span class="va">Var2</span>, <span class="va">Var1</span>, label <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html">signif</a></span><span class="op">(</span><span class="va">value</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"black"</span>, size <span class="op">=</span> <span class="fl">8</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>
    axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.grid.major <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.border <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    panel.background <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">12</span><span class="op">)</span>,
    axis.ticks <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,
    legend.position <span class="op">=</span> <span class="st">"none"</span> <span class="op">)</span></code></pre></div>
<p><img src="tipCategories_files/figure-html/six_heatmap-1.png" width="672"></p>
</div>
<div id="concordance" class="section level2">
<h2 class="hasAnchor">
<a href="#concordance" class="anchor"></a>Concordance</h2>
<p>The concordance measure takes a reference tree R whose tips are a set of categories (with no repeats), and a comparable tree T whose tips are individuals from those categories. The measure counts the proportion of tip pairs whose MRCA in T appears at the same place as the MRCA of their categories in R. It takes a value in (0,1]. Full concordance, where the collapsed version of T is identical to R, gives a value of 1.</p>
<p>For example,</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">catTree</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span>text<span class="op">=</span><span class="st">"(C,(B,A));"</span><span class="op">)</span>
<span class="va">indTree1</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span>text<span class="op">=</span><span class="st">"(((c4,c3),(c2,c1)),((b1,b2),((a3,a2),a1)));"</span><span class="op">)</span>
<span class="va">indTree2</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span>text<span class="op">=</span><span class="st">"(((c4,c3),(c2,c1)),((b1,a2),((a3,b2),a1)));"</span><span class="op">)</span>
<span class="va">indTree3</span> <span class="op">&lt;-</span> <span class="fu">read.tree</span><span class="op">(</span>text<span class="op">=</span><span class="st">"((a3,(a2,a1)),((b1,c2),((c3,b2),(c1,c4))));"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">catTree</span>, tip.color<span class="op">=</span><span class="va">pal</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, type<span class="op">=</span><span class="st">"cladogram"</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>,
     edge.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="st">"black"</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tipCategories_files/figure-html/concordance_basic-1.png" width="672"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/layout_.html">layout</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">indTree1</span>, tip.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">2</span>,
     edge.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="st">"black"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">indTree2</span>, tip.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">2</span>,
     edge.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">6</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/adegraphics/man/plot.html">plot</a></span><span class="op">(</span><span class="va">indTree3</span>, tip.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>,
     edge.width <span class="op">=</span> <span class="fl">4</span>, type<span class="op">=</span><span class="st">"cladogram"</span>, no.margin<span class="op">=</span><span class="cn">TRUE</span>,
     label.offset<span class="op">=</span> <span class="fl">0.5</span>, font<span class="op">=</span><span class="fl">4</span>, cex<span class="op">=</span><span class="fl">2</span>,
     edge.color<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>,<span class="fl">4</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,
                  <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"black"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="va">pal</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">pal</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tipCategories_files/figure-html/concordance_basic-2.png" width="672"></p>
<p>The first tree has monophyly per category, and the relative positions of those categories are identical to the reference tree. Correspondingly, the concordance is 1:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"A"</span>,<span class="fl">3</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"B"</span>,<span class="fl">2</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="st">"C"</span>,<span class="fl">4</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">indTree1</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="../reference/treeConcordance.html">treeConcordance</a></span><span class="op">(</span><span class="va">catTree</span>,<span class="va">indTree1</span>,<span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<p>The second tree is fairly similar to the reference, with category C monophyletic and basal to the rest. However, the paraphyly of categories A and B gives a concordance less than 1:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/treeConcordance.html">treeConcordance</a></span><span class="op">(</span><span class="va">catTree</span>,<span class="va">indTree2</span>,<span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.8846</code></pre>
<p>Finally, the third tree has much less in common with the reference and accordingly has lower concordance:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/treeConcordance.html">treeConcordance</a></span><span class="op">(</span><span class="va">catTree</span>,<span class="va">indTree3</span>,<span class="va">df</span><span class="op">)</span></code></pre></div>
<pre><code>## [1] 0.4615</code></pre>
<p>To give a broader feel for how the concordance measure behaves, we now perform an experiment where we create random trees and compare them to a reference. We permute the tips in the individuals trees by a given percent, and watch the concordance decrease as the permutations increase and the category-level relationships weaken. In the paper we report our findings for <code>n=10</code> and <code>reps=100</code>, that is, the reference tree has 10 tips, individuals trees have <code>n*n=100</code> tips, and we performed 100 repetitions for each level of permutation. To keep the calculations quick we only use <code>n=5</code> and <code>reps=10</code> here.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5</span>
<span class="va">reps</span> <span class="op">&lt;-</span> <span class="fl">10</span>
<span class="va">reftree</span> <span class="op">&lt;-</span> <span class="fu">rtree</span><span class="op">(</span><span class="va">n</span>, tip.label<span class="op">=</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span><span class="op">)</span>
<span class="va">indTrees</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">20</span><span class="op">)</span>,<span class="va">reps</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>
  <span class="fu"><a href="../reference/simulateIndTree.html">simulateIndTree</a></span><span class="op">(</span><span class="va">reftree</span>,itips<span class="op">=</span><span class="va">n</span>,permuteTips<span class="op">=</span><span class="cn">TRUE</span>,tipPercent<span class="op">=</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>

<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="va">letters</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>,<span class="va">n</span><span class="op">)</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span><span class="op">(</span><span class="va">indTrees</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">tip.label</span><span class="op">)</span><span class="op">)</span>

<span class="va">concordances</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="va">indTrees</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="../reference/treeConcordance.html">treeConcordance</a></span><span class="op">(</span><span class="va">reftree</span>,<span class="va">x</span>,<span class="va">df</span><span class="op">)</span><span class="op">)</span>

<span class="va">resultsTab</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">20</span><span class="op">)</span>,<span class="va">reps</span><span class="op">)</span>,<span class="va">concordances</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">resultsTab</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Percentage"</span>,<span class="st">"Concordance"</span><span class="op">)</span>
<span class="va">resultsTab</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">resultsTab</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">100</span>,<span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">resultsTab</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">Percentage</span>, y<span class="op">=</span><span class="va">Concordance</span><span class="op">)</span><span class="op">)</span>

<span class="va">plot</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="va">Percentage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>colour<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Percentage of tips permuted"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/lims.html">ylim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span><span class="op">)</span>,
        axis.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">18</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="tipCategories_files/figure-html/concordance_permuations-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Thibaut Jombart, Michelle Kendall, Jacob Almagro-Garcia, Caroline Colijn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
