<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Geometric median tree function — medTree • treespace</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Geometric median tree function — medTree" />
<meta property="og:description" content="Finds the geometric median of a set of trees according to the Kendall Colijn metric." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">treespace</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.4.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/DengueVignette.html">treespace worked example: Dengue trees</a>
    </li>
    <li>
      <a href="../articles/TransmissionTreesVignette.html">treespace worked example: Transmission trees</a>
    </li>
    <li>
      <a href="../articles/introduction.html">Exploration of landscapes of phylogenetic trees</a>
    </li>
    <li>
      <a href="../articles/tipCategories.html">Comparing trees by tip label categories</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/thibautjombart/treespace/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Geometric median tree function</h1>
    <small class="dont-index">Source: <a href='https://github.com/thibautjombart/treespace/blob/master/R/medTree.R'><code>R/medTree.R</code></a></small>
    <div class="hidden name"><code>medTree.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Finds the geometric median of a set of trees according to the Kendall Colijn metric.</p>
    </div>

    <pre class="usage"><span class='fu'>medTree</span><span class='op'>(</span>
  <span class='va'>x</span>,
  groups <span class='op'>=</span> <span class='cn'>NULL</span>,
  lambda <span class='op'>=</span> <span class='fl'>0</span>,
  weights <span class='op'>=</span> <span class='cn'>NULL</span>,
  emphasise.tips <span class='op'>=</span> <span class='cn'>NULL</span>,
  emphasise.weight <span class='op'>=</span> <span class='fl'>2</span>,
  return.lambda.function <span class='op'>=</span> <span class='cn'>FALSE</span>,
  save.memory <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A list of trees of the class multiPhylo, for which the median tree will be computed, <br />
OR a matrix of tree vectors as given by <code>treespace$vectors</code>.</p></td>
    </tr>
    <tr>
      <th>groups</th>
      <td><p>an optional factor defining groups of trees; if provided, one median tree will be found for each group.</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>a number in [0,1] which specifies the extent to which topology (default, with lambda=0)  or branch lengths (lambda=1) are emphasised. This argument is ignored if <code>return.lambda.function=TRUE</code> or if the vectors are already supplied as the object <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>weights</th>
      <td><p>A vector of weights for the trees. Defaults to a vector of 1's so that all trees are equally weighted, but can be used to encode likelihood, posterior probabilities or other characteristics.</p></td>
    </tr>
    <tr>
      <th>emphasise.tips</th>
      <td><p>an optional list of tips whose entries in the tree vectors should be emphasised. Defaults to <code>NULL</code>.</p></td>
    </tr>
    <tr>
      <th>emphasise.weight</th>
      <td><p>applicable only if a list is supplied to <code>emphasise.tips</code>, this value (default 2) is the number by which vector entries corresponding to those tips are emphasised.</p></td>
    </tr>
    <tr>
      <th>return.lambda.function</th>
      <td><p>If true, a function that can be invoked with different lambda values is returned.
This function returns the vector of metric values for the given lambda. Ignored if the tree vectors are already supplied as the object <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>save.memory</th>
      <td><p>A flag that saves a lot of memory but increases the execution time (not compatible with return.lambda.function=TRUE). Ignored if the tree vectors are already supplied as the object <code>x</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of five objects:</p><ul>
<li><p>$centre is the "central vector", that is, the (weighted) mean of the tree vectors (which typically does not correspond to a tree itself);</p></li>
<li><p>$distances gives the distance of each tree from the central vector;</p></li>
<li><p>$mindist is the minimum of these distances;</p></li>
<li><p>$treenumbers gives the numbers (and, if supplied, names) of the "median tree(s)", that is, the tree(s) which achieve this minimum distance to the centre;</p></li>
<li><p>$trees if trees were supplied then this returns the median trees as a multiPhylo object.</p></li>
</ul><p>If groups are provided, then one list is returned for each group.
If <code>return.lambda.function=TRUE</code> then a function is returned that produces this list for a given value of lambda.</p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Jacob Almagro-Garcia <a href='mailto:nativecoder@gmail.com'>nativecoder@gmail.com</a></p>
<p>Michelle Kendall <a href='mailto:michelle.louise.kendall@gmail.com'>michelle.louise.kendall@gmail.com</a></p>
<p>Thibaut Jombart <a href='mailto:thibautjombart@gmail.com'>thibautjombart@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## EXAMPLE WITH WOODMICE DATA</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>woodmiceTrees</span><span class='op'>)</span>

<span class='co'>## LOOKING FOR A SINGLE MEDIAN</span>
<span class='co'>## get median tree(s)</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>medTree</span><span class='op'>(</span><span class='va'>woodmiceTrees</span><span class='op'>)</span>
<span class='va'>res</span>
</div><div class='output co'>#&gt; $centre
#&gt;          [,1]     [,2]     [,3]    [,4]     [,5]     [,6]    [,7]      [,8]
#&gt; [1,] 4.034826 2.129353 5.522388 2.21393 3.820896 2.129353 2.20398 0.2338308
#&gt;          [,9]    [,10]    [,11]    [,12] [,13]    [,14]    [,15]    [,16]
#&gt; [1,] 5.338308 4.422886 2.129353 3.343284     0 3.447761 2.199005 3.885572
#&gt;         [,17]    [,18]    [,19]    [,20]     [,21]    [,22]    [,23]    [,24]
#&gt; [1,] 2.303483 3.343284 2.199005 2.288557 0.1840796 3.855721 4.751244 2.199005
#&gt;         [,25] [,26]    [,27]    [,28]    [,29]  [,30]    [,31]    [,32]
#&gt; [1,] 3.114428     0 3.358209 2.124378 2.825871 1.9801 4.079602 2.766169
#&gt;          [,33]    [,34]    [,35]    [,36]    [,37] [,38]    [,39]    [,40]
#&gt; [1,] 0.1442786 2.124378 2.174129 4.621891 1.860697     0 1.965174 2.208955
#&gt;       [,41]    [,42]    [,43]     [,44]    [,45]    [,46]    [,47]   [,48]
#&gt; [1,] 4.0199 2.124378 2.199005 0.2338308 6.373134 4.238806 2.124378 3.40796
#&gt;      [,49]    [,50]    [,51]    [,52]    [,53]      [,54]    [,55]    [,56]
#&gt; [1,]     0 3.492537 2.059701 2.825871 3.930348 0.04975124 2.208955 2.268657
#&gt;         [,57]    [,58] [,59]    [,60]  [,61]    [,62]     [,63]    [,64]
#&gt; [1,] 2.825871 1.945274     0 2.044776 1.9801 2.049751 0.3432836 3.970149
#&gt;         [,65]  [,66]    [,67] [,68]    [,69]    [,70]     [,71]    [,72]
#&gt; [1,] 3.318408 1.9801 4.731343     0 4.323383 2.766169 0.1442786 2.124378
#&gt;         [,73]    [,74]    [,75] [,76]    [,77]    [,78]    [,79]    [,80]
#&gt; [1,] 2.174129 4.447761 1.860697     0 1.965174 0.039801 2.199005 2.258706
#&gt;         [,81]    [,82] [,83]    [,84]     [,85]     [,86]     [,87]     [,88]
#&gt; [1,] 2.766169 1.935323     0 2.034826 0.2338308 0.1840796 0.1442786 0.3681592
#&gt;      [,89]     [,90]   [,91]    [,92]    [,93] [,94]    [,95]    [,96]    [,97]
#&gt; [1,]     0 0.3333333 4.18408 2.124378 3.378109     0 3.462687 2.174129 3.089552
#&gt;      [,98]    [,99]   [,100] [,101]   [,102] [,103]   [,104] [,105] [,106]
#&gt; [1,]     0 3.268657 1.860697      0 1.965174      0 4.412935      0      1
#&gt;      [,107] [,108] [,109] [,110] [,111] [,112] [,113] [,114] [,115] [,116]
#&gt; [1,]      1      1      1      1      1      1      1      1      1      1
#&gt;      [,117] [,118] [,119] [,120]
#&gt; [1,]      1      1      1      1
#&gt; 
#&gt; $distances
#&gt;   [1]  2.773836  3.267149  6.944172 14.673991  7.133596  7.836808 18.676418
#&gt;   [8]  3.222686  2.773836  3.222686  3.168193 13.048994 16.296007  3.346883
#&gt;  [15]  7.905388  8.030888  6.355367  8.130321 15.600505  3.911666  7.922676
#&gt;  [22] 15.927311  7.341197  4.443973  4.127042  8.430142 13.493416  4.127042
#&gt;  [29] 16.533025 14.685853  8.787295  5.989845  7.348648 17.342830 15.618513
#&gt;  [36]  5.495148 16.802411  5.764675  5.219809  7.458851  3.065234  7.391513
#&gt;  [43]  6.969203 10.828268  4.868176  7.643007 15.797306  7.367580 11.821964
#&gt;  [50]  4.056521 13.132037  6.944172 16.827709  3.168193 17.153177  6.964918
#&gt;  [57]  5.313330  2.773836  7.954012 15.042647 16.435389  3.967861 15.693191
#&gt;  [64]  6.615047  5.192574 11.586904 17.860227  9.123129  7.391850  4.223558
#&gt;  [71]  6.654041 11.494218  2.773836 16.305163  4.301757 10.385008  5.970711
#&gt;  [78]  4.328850  7.348309 13.786309  5.811092  4.938692  9.103476  5.917563
#&gt;  [85] 17.524330  2.773836  8.430142 16.348281  4.903308  5.463368  3.346883
#&gt;  [92]  6.723586  4.127042 16.533326  3.772463 17.924597  4.277982  6.042769
#&gt;  [99]  6.606768  5.228380 16.982655 13.589491 17.607739  7.964326 13.087636
#&gt; [106]  7.855197  9.698317  5.625779  5.142994  8.505347  5.989845 13.196850
#&gt; [113]  8.268964  7.297695 13.414281  7.371968  6.399443  2.773836  3.065234
#&gt; [120]  7.665756  4.469091  4.441173  3.121525  8.360511  4.301757  6.018846
#&gt; [127]  3.168193  5.362263  7.417382 17.581017  8.473702 13.285148 12.331759
#&gt; [134]  2.946055  3.977253  7.490135  2.773836  4.759660  2.835917  6.754960
#&gt; [141]  3.168193 15.034873  4.903308  9.580642  4.455712  3.517920  7.926757
#&gt; [148]  3.772463  8.462245 10.901533  4.903308  9.417230  8.330704  5.142994
#&gt; [155]  7.904759  4.185694  4.261670  7.984602  2.835917  3.465198  3.414578
#&gt; [162]  7.463519  6.553085  3.124711 16.092631  7.514671  4.420963  7.901611
#&gt; [169]  4.056521 17.366911  6.553085  4.020796 13.087636  3.955931  7.653090
#&gt; [176] 10.056440  5.989845 11.800271  8.430142 11.586904  5.989845  2.946055
#&gt; [183] 16.103448  4.684327 18.967048  5.625779 16.678482  4.872773  8.573512
#&gt; [190]  3.267149  3.334970  4.047312  6.018846  3.168193  6.061676  8.339658
#&gt; [197] 15.080634 16.982655 19.075854  7.348309 10.691403
#&gt; 
#&gt; $mindist
#&gt; [1] 2.773836
#&gt; 
#&gt; $treenumbers
#&gt; [1]   1   9  58  73  86 118 137
#&gt; 
#&gt; $trees
#&gt; 7 phylogenetic trees
#&gt; </div><div class='input'>
<span class='co'>## plot first tree</span>
<span class='va'>med.tree</span> <span class='op'>&lt;-</span> <span class='va'>res</span><span class='op'>$</span><span class='va'>trees</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>
<span class='fu'><a href='https://rdrr.io/pkg/adegraphics/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>med.tree</span><span class='op'>)</span>
</div><div class='img'><img src='medTree-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## LOOKING FOR MEDIANS IN SEVERAL CLUSTERS</span>
<span class='co'>## identify 6 clusters</span>
<span class='va'>groves</span> <span class='op'>&lt;-</span> <span class='fu'><a href='findGroves.html'>findGroves</a></span><span class='op'>(</span><span class='va'>woodmiceTrees</span>, nf<span class='op'>=</span><span class='fl'>3</span>, nclust<span class='op'>=</span><span class='fl'>6</span><span class='op'>)</span>

<span class='co'>## find median trees</span>
<span class='va'>res.with.grp</span> <span class='op'>&lt;-</span> <span class='fu'>medTree</span><span class='op'>(</span><span class='va'>woodmiceTrees</span>, <span class='va'>groves</span><span class='op'>$</span><span class='va'>groups</span><span class='op'>)</span>

<span class='co'>## there is one output per cluster</span>
<span class='fu'><a href='https://rdrr.io/r/base/names.html'>names</a></span><span class='op'>(</span><span class='va'>res.with.grp</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] "1" "2" "3" "4" "5" "6"</div><div class='input'>
<span class='co'>## get the first median of each</span>
<span class='va'>med.trees</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>res.with.grp</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>e</span><span class='op'>)</span> <span class='fu'>ladderize</span><span class='op'>(</span><span class='va'>e</span><span class='op'>$</span><span class='va'>trees</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>

<span class='co'>## plot trees</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span><span class='op'>(</span>mfrow<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='fl'>2</span>,<span class='fl'>3</span><span class='op'>)</span><span class='op'>)</span>
<span class='kw'>for</span><span class='op'>(</span><span class='va'>i</span> <span class='kw'>in</span> <span class='fl'>1</span><span class='op'>:</span><span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span><span class='op'>(</span><span class='va'>med.trees</span><span class='op'>)</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/pkg/adegraphics/man/plot.html'>plot</a></span><span class='op'>(</span><span class='va'>med.trees</span><span class='op'>[[</span><span class='va'>i</span><span class='op'>]</span><span class='op'>]</span>, main<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/paste.html'>paste</a></span><span class='op'>(</span><span class='st'>"cluster"</span>,<span class='va'>i</span><span class='op'>)</span><span class='op'>)</span>
</div><div class='img'><img src='medTree-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'>## highlight the differences between a pair of median trees</span>
<span class='fu'><a href='plotTreeDiff.html'>plotTreeDiff</a></span><span class='op'>(</span><span class='va'>med.trees</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span>,<span class='va'>med.trees</span><span class='op'>[[</span><span class='fl'>5</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='img'><img src='medTree-3.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Thibaut Jombart, Michelle Kendall, Jacob Almagro-Garcia, Caroline Colijn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


